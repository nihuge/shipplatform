/*! 
* WeX5 v3 (http://www.justep.com) 
* Copyright 2015 Justep, Inc.
* Licensed under Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0) 
*/

/*! 
 * WeX5 v3 (http://www.justep.com) 
 * Copyright 2015 Justep, Inc.
 * Licensed under Apache License, Version 2.0 (http://www.apache.org/licenses/LICENSE-2.0) 
 */

/**
 * @preserve FastClick: polyfill to remove click delays on browsers with touch UIs.
 *
 * @version 1.0.2
 * @codingstandard ftlabs-jsv2
 * @copyright The Financial Times Limited [All Rights Reserved]
 * @license MIT License (see LICENSE.txt)
 */

/*!
 * iScroll v4.2.5 ~ Copyright (c) 2012 Matteo Spinelli, http://cubiq.org
 * Released under MIT license, http://cubiq.org/license
 */

/*!
 * Bootstrap v3.3.2 (http://getbootstrap.com)
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

/* ========================================================================
 * Bootstrap: transition.js v3.3.2
 * http://getbootstrap.com/javascript/#transitions
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: alert.js v3.3.2
 * http://getbootstrap.com/javascript/#alerts
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: button.js v3.3.2
 * http://getbootstrap.com/javascript/#buttons
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: carousel.js v3.3.2
 * http://getbootstrap.com/javascript/#carousel
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: collapse.js v3.3.2
 * http://getbootstrap.com/javascript/#collapse
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: dropdown.js v3.3.2
 * http://getbootstrap.com/javascript/#dropdowns
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: modal.js v3.3.2
 * http://getbootstrap.com/javascript/#modals
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tooltip.js v3.3.2
 * http://getbootstrap.com/javascript/#tooltip
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: popover.js v3.3.2
 * http://getbootstrap.com/javascript/#popovers
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: scrollspy.js v3.3.2
 * http://getbootstrap.com/javascript/#scrollspy
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: tab.js v3.3.2
 * http://getbootstrap.com/javascript/#tabs
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/* ========================================================================
 * Bootstrap: affix.js v3.3.2
 * http://getbootstrap.com/javascript/#affix
 * ========================================================================
 * Copyright 2011-2015 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 * ======================================================================== */

/*!
* Modified from jQuery MobiScroll v1.0.2
* http://mobiscroll.com
*
* Copyright 2010-2011, Acid Media
* Licensed under the MIT license.
*
*/

/*! 
* BeX5 v3 (http://www.justep.com) 
* Copyright 2015 Justep, Inc.
*/

function FastClick(e,t){function r(e,t){return function(){return e.apply(t,arguments)}}var n;t=t||{},this.trackingClick=!1,this.trackingClickStart=0,this.targetElement=null,this.touchStartX=0,this.touchStartY=0,this.lastTouchIdentifier=0,this.touchBoundary=t.touchBoundary||10,this.layer=e,this.tapDelay=t.tapDelay||200;if(FastClick.notNeeded(e)){window.fastClickNeeded=!1;return}window.fastClickNeeded=!0;var i=["onMouse","onClick","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel"],s=this;for(var o=0,u=i.length;o<u;o++)s[i[o]]=r(s[i[o]],s);deviceIsAndroid&&(e.addEventListener("mouseover",this.onMouse,!0),e.addEventListener("mousedown",this.onMouse,!0),e.addEventListener("mouseup",this.onMouse,!0)),e.addEventListener("click",this.onClick,!0),e.addEventListener("touchstart",this.onTouchStart,!1),e.addEventListener("touchmove",this.onTouchMove,!1),e.addEventListener("touchend",this.onTouchEnd,!1),e.addEventListener("touchcancel",this.onTouchCancel,!1),Event.prototype.stopImmediatePropagation||(e.removeEventListener=function(t,n,r){var i=Node.prototype.removeEventListener;t==="click"?i.call(e,t,n.hijacked||n,r):i.call(e,t,n,r)},e.addEventListener=function(t,n,r){var i=Node.prototype.addEventListener;t==="click"?i.call(e,t,n.hijacked||(n.hijacked=function(e){e.propagationStopped||n(e)}),r):i.call(e,t,n,r)}),typeof e.onclick=="function"&&(n=e.onclick,e.addEventListener("click",function(e){n(e)},!1),e.onclick=null)}define("$model/UI2/system/components/justep/common/res",["require","$UI/system/lib/justep","css!../../bootstrap/lib/css/bootstrap","css!../../bootstrap/lib/css/bootstrap-theme","css!./css/forms","css!./css/forms.pc","css!./css/IE/input.ie","css!./css/IE/radio.ie8","css!./css/IE/button.ie9","css!./css/IE/labelEdit.ie9","css!./css/ios"],function(e){var t=e("$UI/system/lib/justep");e("css!../../bootstrap/lib/css/bootstrap").load(),e("css!../../bootstrap/lib/css/bootstrap-theme").load(),e("css!./css/forms").load(),t.Browser.isPC&&e("css!./css/forms.pc").load(),t.Browser.IE&&e("css!./css/IE/input.ie").load(),t.Browser.IE8&&e("css!./css/IE/radio.ie8").load();if(t.Browser.IE8||t.Browser.IE9)e("css!./css/IE/button.ie9").load(),e("css!./css/IE/labelEdit.ie9").load();(t.Browser.isIphone||t.Browser.isIpad)&&e("css!./css/ios").load()}),define("$model/UI2/system/components/justep/windowContainer/windowContainer.config",["require"],function(e){return{properties:{src:"string",process:"string",activity:"string"},events:["onLoad","onLoadError","onViewLoad"],binds:{}}}),define("$model/UI2/system/components/justep/windowContainer/windowContainer",["require","jquery","$UI/system/lib/justep","$UI/system/lib/base/composition","./windowContainer.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/lib/base/composition"),i=e.normalizeName("./windowContainer"),s=e("./windowContainer.config"),o="__inner-model__",u=n.ViewComponent.extend({constructor:function(e){this.__windowContainerInited=!1,this.callParent(e),this.src="",this.process="",this.activity=""},controlsDescendantBindings:function(){return!0},dispose:function(){this.callParent()},getConfig:function(){return s},buildTemplate:function(e){var n=t("<div component='"+i+"' __component-context__='block' />");return e&&(this.src=e.src,this.process=e.process,this.activity=e.activity,e.xid&&n.attr("xid",e.xid)),n},init:function(e,t){this.__windowContainerInited=!0,this.callParent(e,t),this.refresh()},setSrc:function(e){this.set({src:e})},setProcess:function(e){this.set({process:e})},setActivity:function(e){this.set({activity:e})},refresh:function(){if(this.__windowContainerInited){var e=this.get("src");for(var i=this.domNode.childNodes.length-1;i>=0;i--)n.Bind.removeNode(this.domNode.childNodes[i]);if(e){e=this._prepareSrc(e);var s={activate:!0};s.model=e,s.preserveContext=!0;var o=this;s.loadError=function(e){var t={source:o,err:e,cancel:!1};return o.fireEvent(u.LOAD_ERROR_EVENT,t),t.cancel},s.viewLoad=function(){var e=t.Deferred(),n={source:o,cancel:!1,dtd:e,async:!1};return o.fireEvent(u.VIEW_LOAD_EVENT,n),n.async||e.resolve(),e.promise()},r.compose(this.domNode,s)}}},_prepareSrc:function(e){if(e){var t=this.getModel().getContext();if(e.indexOf("process=")==-1&&e.indexOf("activity=")==-1){var n=this.get("process"),r=this.get("activity");(!n||!r)&&t.getProcess&&t.getActivity&&(n=t.getProcess(),r=t.getActivity()),n&&r&&(e+=e.indexOf("?")==-1?"?":"&",e+="process="+n+"&activity="+r)}if(t.getExecutor&&e.indexOf("executor=")==-1){var i=t.getExecutor();i&&(e+=e.indexOf("?")==-1?"?":"&",e+="executor="+i)}if(t.getExecuteContext&&e.indexOf("executeContext=")==-1){var s=t.getExecuteContext();s&&(e+=e.indexOf("?")==-1?"?":"&",e+="executeContext="+s)}}return e},getInnerModel:function(){try{return n.Bind.utils.domData.get(this.domNode,o)}catch(e){var t=new n.Message(n.Message.JUSTEP230112);throw n.Error.create(t)}},beforeLoaded:function(){this.fireEvent(u.BEFORE_LOAD_EVENT,{source:this})},loaded:function(){this.fireEvent(u.LOAD_EVENT,{source:this}),this._prepareRouteStateChannel()},_prepareRouteStateChannel:function(){var e=this;this.getInnerModel().off("onRouteStatePublish");var t=function(t){e.fireEvent("onRouteStatePublish",t),e._prepareRouteStateChannel._lastHashbang=t.hashbang};this.getInnerModel().on("onRouteStatePublish",function(e){t(e)},this),t({isReplace:!0,hashbang:this.getInnerModel().$routeState.toHashbang()})}});return u.BEFORE_LOAD_EVENT="onBeforeLoad",u.LOAD_EVENT="onLoad",u.LOAD_ERROR_EVENT="onLoadError",u.VIEW_LOAD_EVENT="onViewLoad",n.Component.register(i,u),u}),define("$model/UI2/system/components/justep/common/utils",["require","jquery","$UI/system/components/justep/windowContainer/windowContainer"],function(e){var t=e("jquery"),n=e("$UI/system/components/justep/windowContainer/windowContainer");return{loadContent:function(e,t,r,i){var s=e.getContent(t);s||(s=e.add({xid:t}));var o=s.$domNode.get(0),u=new n({parentNode:o,src:r,onLoad:function(){i&&i(),s.on("onActive",function(){u.getInnerModel()&&u.getInnerModel().fireEvent("onActive")})},onLoadError:function(e){i&&i(e)}});return s.innerContainer=u,s},attachDoubleClickExitApp:function(e){var n=t.Deferred();return this.attached===!0?n.reject():(this.attached=!0,document.addEventListener("deviceready",function(){var r=0,i=function(){if(e())if(r===0){r++;var i=t('<span style="display: none;border-radius: 50px;padding: 7px;left: 50%;margin-left: -80px;background-color: #383838;color: #F0F0F0;z-index:9999;position:fixed;bottom:25px;">再按一次退出应用</span>').appendTo("body");i.fadeIn(400).delay(2e3).fadeOut(400,function(){r=0,i.remove()})}else r==1&&(n.resolve(),navigator.app.exitApp());else history.back()};document.addEventListener("backbutton",i,!1),t(window).on("beforeunload",function(){document.removeEventListener("backbutton",i,!1)})},!1)),n.promise()}}});var deviceIsAndroid=navigator.userAgent.indexOf("Android")>0,deviceIsIOS=/iP(ad|hone|od)/.test(navigator.userAgent),deviceIsIOS4=deviceIsIOS&&/OS 4_\d(_\d)?/.test(navigator.userAgent),deviceIsIOSWithBadTarget=deviceIsIOS&&/OS ([6-9]|\d{2})_\d/.test(navigator.userAgent);FastClick.prototype.needsClick=function(e){switch(e.nodeName.toLowerCase()){case"button":case"select":case"textarea":if(e.disabled)return!0;break;case"input":if(deviceIsIOS&&e.type==="file"||deviceIsIOS&&e.type==="range"||e.disabled)return!0;break;case"label":case"video":return!0}return/\bneedsclick\b/.test(e.className)},FastClick.prototype.needsFocus=function(e){switch(e.nodeName.toLowerCase()){case"textarea":return!0;case"select":return!deviceIsAndroid;case"input":switch(e.type){case"button":case"checkbox":case"file":case"image":case"radio":case"submit":return!1}return!e.disabled&&!e.readOnly;default:return/\bneedsfocus\b/.test(e.className)}},FastClick.prototype.sendClick=function(e,t){var n,r;document.activeElement&&document.activeElement!==e&&document.activeElement.blur(),r=t.changedTouches[0],n=document.createEvent("MouseEvents"),n.initMouseEvent(this.determineEventType(e),!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),n.forwardedTouchEvent=!0,e.dispatchEvent(n)},FastClick.prototype.determineEventType=function(e){return deviceIsAndroid&&e.tagName.toLowerCase()==="select"?"mousedown":"click"},FastClick.prototype.focus=function(e){var t;deviceIsIOS&&e.setSelectionRange&&e.type.indexOf("date")!==0&&e.type!=="time"&&e.type!=="month"?(t=e.value.length,e.setSelectionRange(t,t)):e.focus()},FastClick.prototype.updateScrollParent=function(e){var t,n;t=e.fastClickScrollParent;if(!t||!t.contains(e)){n=e;do{if(n.scrollHeight>n.offsetHeight){t=n,e.fastClickScrollParent=n;break}n=n.parentElement}while(n)}t&&(t.fastClickLastScrollTop=t.scrollTop)},FastClick.prototype.getTargetElementFromEventTarget=function(e){return e.nodeType===Node.TEXT_NODE?e.parentNode:e},FastClick.prototype.onTouchStart=function(e){var t,n,r;if(e.targetTouches.length>1)return!0;t=this.getTargetElementFromEventTarget(e.target),n=e.targetTouches[0];if(deviceIsIOS){r=window.getSelection();if(r.rangeCount&&!r.isCollapsed)return!0;if(!deviceIsIOS4){if(n.identifier&&n.identifier===this.lastTouchIdentifier)return e.preventDefault(),!1;this.lastTouchIdentifier=n.identifier,this.updateScrollParent(t)}}return this.trackingClick=!0,this.trackingClickStart=e.timeStamp,this.targetElement=t,this.touchStartX=n.pageX,this.touchStartY=n.pageY,e.timeStamp-this.lastClickTime<this.tapDelay&&e.preventDefault(),!0},FastClick.prototype.touchHasMoved=function(e){var t=e.changedTouches[0],n=this.touchBoundary;return Math.abs(t.pageX-this.touchStartX)>n||Math.abs(t.pageY-this.touchStartY)>n?!0:!1},FastClick.prototype.onTouchMove=function(e){if(!this.trackingClick)return!0;if(this.targetElement!==this.getTargetElementFromEventTarget(e.target)||this.touchHasMoved(e))this.trackingClick=!1,this.targetElement=null;return!0},FastClick.prototype.findControl=function(e){return e.control!==undefined?e.control:e.htmlFor?document.getElementById(e.htmlFor):e.querySelector("button, input:not([type=hidden]), keygen, meter, output, progress, select, textarea")},FastClick.prototype.onTouchEnd=function(e){var t,n,r,i,s,o=this.targetElement;if(!this.trackingClick)return!0;if(e.timeStamp-this.lastClickTime<this.tapDelay)return this.cancelNextClick=!0,!0;this.cancelNextClick=!1,this.lastClickTime=e.timeStamp,n=this.trackingClickStart,this.trackingClick=!1,this.trackingClickStart=0,deviceIsIOSWithBadTarget&&(s=e.changedTouches[0],o=document.elementFromPoint(s.pageX-window.pageXOffset,s.pageY-window.pageYOffset)||o,o.fastClickScrollParent=this.targetElement.fastClickScrollParent),r=o.tagName.toLowerCase();if(r==="label"){t=this.findControl(o);if(t){this.focus(o);if(deviceIsAndroid)return!1;o=t}}else if(this.needsFocus(o)){if(e.timeStamp-n>100||deviceIsIOS&&window.top!==window&&r==="input")return this.targetElement=null,!1;this.focus(o),this.sendClick(o,e);if(!deviceIsIOS||r!=="select")this.targetElement=null,e.preventDefault();return!1}if(deviceIsIOS&&!deviceIsIOS4){i=o.fastClickScrollParent;if(i&&i.fastClickLastScrollTop!==i.scrollTop)return!0}return this.needsClick(o)||(e.preventDefault(),this.sendClick(o,e)),!1},FastClick.prototype.onTouchCancel=function(){this.trackingClick=!1,this.targetElement=null},FastClick.prototype.onMouse=function(e){return this.targetElement?e.forwardedTouchEvent?!0:e.cancelable?!this.needsClick(this.targetElement)||this.cancelNextClick?(e.stopImmediatePropagation?e.stopImmediatePropagation():e.propagationStopped=!0,e.stopPropagation(),e.preventDefault(),!1):!0:!0:!0},FastClick.prototype.onClick=function(e){var t;return this.trackingClick?(this.targetElement=null,this.trackingClick=!1,!0):e.target.type==="submit"&&e.detail===0?!0:(t=this.onMouse(e),t||(this.targetElement=null),t)},FastClick.prototype.destroy=function(){var e=this.layer;deviceIsAndroid&&(e.removeEventListener("mouseover",this.onMouse,!0),e.removeEventListener("mousedown",this.onMouse,!0),e.removeEventListener("mouseup",this.onMouse,!0)),e.removeEventListener("click",this.onClick,!0),e.removeEventListener("touchstart",this.onTouchStart,!1),e.removeEventListener("touchmove",this.onTouchMove,!1),e.removeEventListener("touchend",this.onTouchEnd,!1),e.removeEventListener("touchcancel",this.onTouchCancel,!1)},FastClick.notNeeded=function(e){var t,n;if(typeof window.ontouchstart=="undefined")return!0;n=+(/Chrome\/([0-9]+)/.exec(navigator.userAgent)||[,0])[1];if(n){if(!deviceIsAndroid)return!0;t=document.querySelector("meta[name=viewport]");if(t){if(t.content.indexOf("user-scalable=no")!==-1)return!0;if(n>31&&document.documentElement.scrollWidth<=window.outerWidth)return!0}}return e.style.msTouchAction==="none"?!0:!1},FastClick.attach=function(e,t){return new FastClick(e,t)},typeof define=="function"&&typeof define.amd=="object"&&define.amd?define("$model/UI2/system/components/justep/lib/fastclick",[],function(){return FastClick}):typeof module!="undefined"&&module.exports?(module.exports=FastClick.attach,module.exports.FastClick=FastClick):window.FastClick=FastClick,define("$model/UI2/system/components/justep/scrollView/lib/iscroll",["require","exports","module"],function(e,t,n){(function(e,n){function _(e){return s===""?e:(e=e.charAt(0).toUpperCase()+e.substr(1),s+e)}var r=Math,i=n.createElement("div").style,s=function(){var e="t,webkitT,MozT,msT,OT".split(","),t,n=0,r=e.length;for(;n<r;n++){t=e[n]+"ransform";if(t in i)return e[n].substr(0,e[n].length-1)}return!1}(),o=s?"-"+s.toLowerCase()+"-":"",u=_("transform"),a=_("transitionProperty"),f=_("transitionDuration"),l=_("transformOrigin"),c=_("transitionTimingFunction"),h=_("transitionDelay"),p=/android/gi.test(navigator.appVersion),d=/iphone|ipad/gi.test(navigator.appVersion),v=/hp-tablet/gi.test(navigator.appVersion),m=_("perspective")in i,g="ontouchstart"in e&&!v,y=s!==!1,b=_("transition")in i,w="onorientationchange"in e?"orientationchange":"resize",E=g?"touchstart":"mousedown",S=g?"touchmove":"mousemove",x=g?"touchend":"mouseup",T=g?"touchcancel":"mouseup",N=function(){if(s===!1)return!1;var e={"":"transitionend",webkit:"webkitTransitionEnd",Moz:"transitionend",O:"otransitionend",ms:"MSTransitionEnd"};return e[s]}(),C=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(e){return setTimeout(e,1)}}(),k=function(){return e.cancelRequestAnimationFrame||e.webkitCancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout}(),L=m?" translateZ(0)":"",A=/Android /.test(e.navigator.appVersion)&&!/Chrome\/\d/.test(e.navigator.appVersion),O=function(e,t){for(var n in t)if(t[n].test(e[n]))return!0;return!1},M=function(t,r){var i=this,s;i.wrapper=typeof t=="object"?t:n.getElementById(t),i.wrapper.style.overflow="hidden",i.scroller=i.wrapper.children[0],i.options={hScroll:!0,vScroll:!0,x:0,y:0,bounce:!0,bounceLock:!1,momentum:!0,lockDirection:!0,useTransform:!0,useTransition:!1,topOffset:0,checkDOMChanges:!1,handleClick:!0,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},hScrollbar:!0,vScrollbar:!0,fixedScrollbar:p,hideScrollbar:d,fadeScrollbar:d&&m,scrollbarClass:"",zoom:!1,zoomMin:1,zoomMax:4,doubleTapZoom:2,wheelAction:"scroll",snap:!1,snapThreshold:1,onRefresh:null,onBeforeScrollStart:function(e){!A&&!O(e.target,this.options.preventDefaultException)&&e.preventDefault()},onScrollStart:null,onBeforeScrollMove:null,onScrollMove:null,onBeforeScrollEnd:null,onScrollEnd:null,onTouchEnd:null,onDestroy:null,onZoomStart:null,onZoom:null,onZoomEnd:null};for(s in r)i.options[s]=r[s];i.x=i.options.x,i.y=i.options.y,i.options.useTransform=y&&i.options.useTransform,i.options.hScrollbar=i.options.hScroll&&i.options.hScrollbar,i.options.vScrollbar=i.options.vScroll&&i.options.vScrollbar,i.options.zoom=i.options.useTransform&&i.options.zoom,i.options.useTransition=b&&i.options.useTransition,i.options.zoom&&p&&(L=""),i.scroller.style[a]=i.options.useTransform?o+"transform":"top left",i.scroller.style[f]="0",i.scroller.style[l]="0 0",i.options.useTransition&&(i.scroller.style[c]="cubic-bezier(0.33,0.66,0.66,1)"),i.options.useTransform?i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px)"+L:i.scroller.style.cssText+=";position:absolute;top:"+i.y+"px;left:"+i.x+"px",i.options.useTransition&&(i.options.fixedScrollbar=!0),i.refresh(),i._bind(w,e),i._bind(E),g||i.options.wheelAction!="none"&&(i._bind("DOMMouseScroll"),i._bind("mousewheel")),i.options.checkDOMChanges&&(i.checkDOMTime=setInterval(function(){i._checkDOMChanges()},500))};M.prototype={enabled:!0,x:0,y:0,steps:[],scale:1,currPageX:0,currPageY:0,pagesX:[],pagesY:[],aniTime:null,wheelZoomCount:0,handleEvent:function(e){var t=this;switch(e.type){case E:if(!g&&e.button!==0)return;t._start(e);break;case S:t._move(e);break;case x:case T:t._end(e);break;case w:t._resize();break;case"DOMMouseScroll":case"mousewheel":t._wheel(e);break;case N:t._transitionEnd(e)}},_checkDOMChanges:function(){if(this.moved||this.zoomed||this.animating||this.scrollerW==this.scroller.offsetWidth*this.scale&&this.scrollerH==this.scroller.offsetHeight*this.scale)return;this.refresh()},_scrollbar:function(e){var t=this,i;if(!t[e+"Scrollbar"]){t[e+"ScrollbarWrapper"]&&(y&&(t[e+"ScrollbarIndicator"].style[u]=""),t[e+"ScrollbarWrapper"].parentNode.removeChild(t[e+"ScrollbarWrapper"]),t[e+"ScrollbarWrapper"]=null,t[e+"ScrollbarIndicator"]=null);return}t[e+"ScrollbarWrapper"]||(i=n.createElement("div"),t.options.scrollbarClass?i.className=t.options.scrollbarClass+e.toUpperCase():i.style.cssText="position:absolute;z-index:100;"+(e=="h"?"height:4px;bottom:1px;left:2px;right:"+(t.vScrollbar?"4":"2")+"px":"width:4px;bottom:"+(t.hScrollbar?"4":"2")+"px;top:2px;right:1px"),i.style.cssText+=";pointer-events:none;"+o+"transition-property:opacity;"+o+"transition-duration:"+(t.options.fadeScrollbar?"350ms":"0")+";overflow:hidden;opacity:"+(t.options.hideScrollbar?"0":"1"),t.wrapper.appendChild(i),t[e+"ScrollbarWrapper"]=i,i=n.createElement("div"),t.options.scrollbarClass||(i.style.cssText="position:absolute;z-index:100;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);"+o+"background-clip:padding-box;"+o+"box-sizing:border-box;"+(e=="h"?"height:100%":"width:100%")+";"+o+"border-radius:3px;border-radius:3px"),i.style.cssText+=";pointer-events:none;"+o+"transition-property:"+o+"transform;"+o+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1);"+o+"transition-duration:0;"+o+"transform: translate(0,0)"+L,t.options.useTransition&&(i.style.cssText+=";"+o+"transition-timing-function:cubic-bezier(0.33,0.66,0.66,1)"),t[e+"ScrollbarWrapper"].appendChild(i),t[e+"ScrollbarIndicator"]=i),e=="h"?(t.hScrollbarSize=t.hScrollbarWrapper.clientWidth,t.hScrollbarIndicatorSize=r.max(r.round(t.hScrollbarSize*t.hScrollbarSize/t.scrollerW),8),t.hScrollbarIndicator.style.width=t.hScrollbarIndicatorSize+"px",t.hScrollbarMaxScroll=t.hScrollbarSize-t.hScrollbarIndicatorSize,t.hScrollbarProp=t.hScrollbarMaxScroll/t.maxScrollX):(t.vScrollbarSize=t.vScrollbarWrapper.clientHeight,t.vScrollbarIndicatorSize=r.max(r.round(t.vScrollbarSize*t.vScrollbarSize/t.scrollerH),8),t.vScrollbarIndicator.style.height=t.vScrollbarIndicatorSize+"px",t.vScrollbarMaxScroll=t.vScrollbarSize-t.vScrollbarIndicatorSize,t.vScrollbarProp=t.vScrollbarMaxScroll/t.maxScrollY),t._scrollbarPos(e,!0)},_resize:function(){var e=this;setTimeout(function(){e.refresh()},p?200:0)},_pos:function(e,t){if(this.zoomed)return;e=this.hScroll?e:0,t=this.vScroll?t:0,this.options.useTransform?this.scroller.style[u]="translate("+e+"px,"+t+"px) scale("+this.scale+")"+L:(e=r.round(e),t=r.round(t),this.scroller.style.left=e+"px",this.scroller.style.top=t+"px"),this.x=e,this.y=t,this._scrollbarPos("h"),this._scrollbarPos("v")},_scrollbarPos:function(e,t){var n=this,i=e=="h"?n.x:n.y,s;if(!n[e+"Scrollbar"])return;i=n[e+"ScrollbarProp"]*i,i<0?(n.options.fixedScrollbar||(s=n[e+"ScrollbarIndicatorSize"]+r.round(i*3),s<8&&(s=8),n[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px"),i=0):i>n[e+"ScrollbarMaxScroll"]&&(n.options.fixedScrollbar?i=n[e+"ScrollbarMaxScroll"]:(s=n[e+"ScrollbarIndicatorSize"]-r.round((i-n[e+"ScrollbarMaxScroll"])*3),s<8&&(s=8),n[e+"ScrollbarIndicator"].style[e=="h"?"width":"height"]=s+"px",i=n[e+"ScrollbarMaxScroll"]+(n[e+"ScrollbarIndicatorSize"]-s))),n[e+"ScrollbarWrapper"].style[h]="0",n[e+"ScrollbarWrapper"].style.opacity=t&&n.options.hideScrollbar?"0":"1",n[e+"ScrollbarIndicator"].style[u]="translate("+(e=="h"?i+"px,0)":"0,"+i+"px)")+L},_start:function(t){var n=this,i=g?t.touches[0]:t,s,o,a,f,l;if(!n.enabled)return;n.options.onBeforeScrollStart&&n.options.onBeforeScrollStart.call(n,t),(n.options.useTransition||n.options.zoom)&&n._transitionTime(0),n.moved=!1,n.animating=!1,n.zoomed=!1,n.distX=0,n.distY=0,n.absDistX=0,n.absDistY=0,n.dirX=0,n.dirY=0,n.options.zoom&&g&&t.touches.length>1&&(f=r.abs(t.touches[0].pageX-t.touches[1].pageX),l=r.abs(t.touches[0].pageY-t.touches[1].pageY),n.touchesDistStart=r.sqrt(f*f+l*l),n.originX=r.abs(t.touches[0].pageX+t.touches[1].pageX-n.wrapperOffsetLeft*2)/2-n.x,n.originY=r.abs(t.touches[0].pageY+t.touches[1].pageY-n.wrapperOffsetTop*2)/2-n.y,n.options.onZoomStart&&n.options.onZoomStart.call(n,t));if(n.options.momentum){n.options.useTransform?(s=getComputedStyle(n.scroller,null)[u].replace(/[^0-9\-.,]/g,"").split(","),o=+(s[12]||s[4]),a=+(s[13]||s[5])):(o=+getComputedStyle(n.scroller,null).left.replace(/[^0-9-]/g,""),a=+getComputedStyle(n.scroller,null).top.replace(/[^0-9-]/g,""));if(o!=n.x||a!=n.y)n.options.useTransition?n._unbind(N):k(n.aniTime),n.steps=[],n._pos(o,a),n.options.onScrollEnd&&n.options.onScrollEnd.call(n)}n.absStartX=n.x,n.absStartY=n.y,n.startX=n.x,n.startY=n.y,n.pointX=i.pageX,n.pointY=i.pageY,n.startTime=t.timeStamp||Date.now(),n.options.onScrollStart&&n.options.onScrollStart.call(n,t),n._bind(S,e),n._bind(x,e),n._bind(T,e)},_move:function(e){var t=this,n=g?e.touches[0]:e,i=n.pageX-t.pointX,s=n.pageY-t.pointY,o=t.x+i,a=t.y+s,f,l,c,h=e.timeStamp||Date.now();O(e.target,this.options.preventDefaultException)||e.preventDefault(),t.options.onBeforeScrollMove&&t.options.onBeforeScrollMove.call(t,e);if(t.options.zoom&&g&&e.touches.length>1){f=r.abs(e.touches[0].pageX-e.touches[1].pageX),l=r.abs(e.touches[0].pageY-e.touches[1].pageY),t.touchesDist=r.sqrt(f*f+l*l),t.zoomed=!0,c=1/t.touchesDistStart*t.touchesDist*this.scale,c<t.options.zoomMin?c=.5*t.options.zoomMin*Math.pow(2,c/t.options.zoomMin):c>t.options.zoomMax&&(c=2*t.options.zoomMax*Math.pow(.5,t.options.zoomMax/c)),t.lastScale=c/this.scale,o=this.originX-this.originX*t.lastScale+this.x,a=this.originY-this.originY*t.lastScale+this.y,this.scroller.style[u]="translate("+o+"px,"+a+"px) scale("+c+")"+L,t.options.onZoom&&t.options.onZoom.call(t,e);return}t.pointX=n.pageX,t.pointY=n.pageY;if(o>0||o<t.maxScrollX)o=t.options.bounce?t.x+i/2:o>=0||t.maxScrollX>=0?0:t.maxScrollX;if(a>t.minScrollY||a<t.maxScrollY)a=t.options.bounce?t.y+s/2:a>=t.minScrollY||t.maxScrollY>=0?t.minScrollY:t.maxScrollY;t.distX+=i,t.distY+=s,t.absDistX=r.abs(t.distX),t.absDistY=r.abs(t.distY);if(t.absDistX<6&&t.absDistY<6)return;t.options.lockDirection&&(t.absDistX>t.absDistY+5?(a=t.y,s=0):t.absDistY>t.absDistX+5&&(o=t.x,i=0)),t.moved=!0,t._pos(o,a),t.dirX=i>0?-1:i<0?1:0,t.dirY=s>0?-1:s<0?1:0,h-t.startTime>300&&(t.startTime=h,t.startX=t.x,t.startY=t.y),t.options.onScrollMove&&t.options.onScrollMove.call(t,e)},_end:function(t){if(g&&t.touches.length!==0)return;var i=this,s=g?t.changedTouches[0]:t,o,a,l={dist:0,time:0},c={dist:0,time:0},h=(t.timeStamp||Date.now())-i.startTime,p=i.x,d=i.y,v,m,y,b,w;i._unbind(S,e),i._unbind(x,e),i._unbind(T,e),O(t.target,this.options.preventDefaultException)||t.preventDefault(),i.options.onBeforeScrollEnd&&i.options.onBeforeScrollEnd.call(i,t);if(i.zoomed){w=i.scale*i.lastScale,w=Math.max(i.options.zoomMin,w),w=Math.min(i.options.zoomMax,w),i.lastScale=w/i.scale,i.scale=w,i.x=i.originX-i.originX*i.lastScale+i.x,i.y=i.originY-i.originY*i.lastScale+i.y,i.scroller.style[f]="200ms",i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px) scale("+i.scale+")"+L,i.zoomed=!1,i.refresh(),i.options.onZoomEnd&&i.options.onZoomEnd.call(i,t);return}if(!i.moved){g&&(console.log("this.options.handleClick:"+this.options.handleClick),i.doubleTapTimer&&i.options.zoom?(clearTimeout(i.doubleTapTimer),i.doubleTapTimer=null,i.options.onZoomStart&&i.options.onZoomStart.call(i,t),i.zoom(i.pointX,i.pointY,i.scale==1?i.options.doubleTapZoom:1),i.options.onZoomEnd&&setTimeout(function(){i.options.onZoomEnd.call(i,t)},200)):this.options.handleClick&&(e.fastClickNeeded||(i.doubleTapTimer=setTimeout(function(){i.doubleTapTimer=null,o=s.target;while(o.nodeType!=1)o=o.parentNode;o.tagName!="SELECT"&&o.tagName!="INPUT"&&o.tagName!="TEXTAREA"&&(console.log("iscroll click fake emit"),a=n.createEvent("MouseEvents"),a.initMouseEvent("click",!0,!0,t.view,1,s.screenX,s.screenY,s.clientX,s.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,0,null),a._fake=!0,o.dispatchEvent(a))},i.options.zoom?250:0)))),i._resetPos(400),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t);return}if(h<300&&i.options.momentum){l=p?i._momentum(p-i.startX,h,-i.x,i.scrollerW-i.wrapperW+i.x,i.options.bounce?i.wrapperW:0):l,c=d?i._momentum(d-i.startY,h,-i.y,i.maxScrollY<0?i.scrollerH-i.wrapperH+i.y-i.minScrollY:0,i.options.bounce?i.wrapperH:0):c,p=i.x+l.dist,d=i.y+c.dist;if(i.x>0&&p>0||i.x<i.maxScrollX&&p<i.maxScrollX)l={dist:0,time:0};if(i.y>i.minScrollY&&d>i.minScrollY||i.y<i.maxScrollY&&d<i.maxScrollY)c={dist:0,time:0}}if(l.dist||c.dist){y=r.max(r.max(l.time,c.time),10),i.options.snap&&(v=p-i.absStartX,m=d-i.absStartY,r.abs(v)<i.options.snapThreshold&&r.abs(m)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(p,d),p=b.x,d=b.y,y=r.max(b.time,y))),d<i.maxScrollY&&d<0&&(d=Math.max(d,i.maxScrollY-50)),i.scrollTo(r.round(p),r.round(d),y),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t);return}if(i.options.snap){v=p-i.absStartX,m=d-i.absStartY,r.abs(v)<i.options.snapThreshold&&r.abs(m)<i.options.snapThreshold?i.scrollTo(i.absStartX,i.absStartY,200):(b=i._snap(i.x,i.y),(b.x!=i.x||b.y!=i.y)&&i.scrollTo(b.x,b.y,b.time)),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t);return}i._resetPos(200),i.options.onTouchEnd&&i.options.onTouchEnd.call(i,t)},_resetPos:function(e){var t=this,n=t.x>=0?0:t.x<t.maxScrollX?t.maxScrollX:t.x,r=t.y>=t.minScrollY||t.maxScrollY>0?t.minScrollY:t.y<t.maxScrollY?t.maxScrollY:t.y;if(n==t.x&&r==t.y){t.moved&&(t.moved=!1,t.options.onScrollEnd&&t.options.onScrollEnd.call(t)),t.hScrollbar&&t.options.hideScrollbar&&(s=="webkit"&&(t.hScrollbarWrapper.style[h]="300ms"),t.hScrollbarWrapper.style.opacity="0"),t.vScrollbar&&t.options.hideScrollbar&&(s=="webkit"&&(t.vScrollbarWrapper.style[h]="300ms"),t.vScrollbarWrapper.style.opacity="0");return}t.scrollTo(n,r,e||0)},_wheel:function(e){var t=this,n,r,i,s,o;if("wheelDeltaX"in e)n=e.wheelDeltaX/12,r=e.wheelDeltaY/12;else if("wheelDelta"in e)n=r=e.wheelDelta/12;else{if(!("detail"in e))return;n=r=-e.detail*3}if(t.options.wheelAction=="zoom"){o=t.scale*Math.pow(2,1/3*(r?r/Math.abs(r):0)),o<t.options.zoomMin&&(o=t.options.zoomMin),o>t.options.zoomMax&&(o=t.options.zoomMax),o!=t.scale&&(!t.wheelZoomCount&&t.options.onZoomStart&&t.options.onZoomStart.call(t,e),t.wheelZoomCount++,t.zoom(e.pageX,e.pageY,o,400),setTimeout(function(){t.wheelZoomCount--,!t.wheelZoomCount&&t.options.onZoomEnd&&t.options.onZoomEnd.call(t,e)},400));return}i=t.x+n,s=t.y+r,i>0?i=0:i<t.maxScrollX&&(i=t.maxScrollX),s>t.minScrollY?s=t.minScrollY:s<t.maxScrollY&&(s=t.maxScrollY),t.maxScrollY<0&&t.scrollTo(i,s,0)},_transitionEnd:function(e){var t=this;if(e.target!=t.scroller)return;t._unbind(N),t._startAni()},_startAni:function(){var e=this,t=e.x,n=e.y,i=Date.now(),s,o,u;if(e.animating)return;if(!e.steps.length){e._resetPos(400);return}s=e.steps.shift(),s.x==t&&s.y==n&&(s.time=0),e.animating=!0,e.moved=!0;if(e.options.useTransition){e._transitionTime(s.time),e._pos(s.x,s.y),e.animating=!1,s.time?e._bind(N):e._resetPos(0);return}u=function(){var a=Date.now(),f,l;if(a>=i+s.time){e._pos(s.x,s.y),e.animating=!1,e.options.onAnimationEnd&&e.options.onAnimationEnd.call(e),e._startAni();return}a=(a-i)/s.time-1,o=r.sqrt(1-a*a),f=(s.x-t)*o+t,l=(s.y-n)*o+n,e._pos(f,l),e.animating&&(e.aniTime=C(u))},u()},_transitionTime:function(e){e+="ms",this.scroller.style[f]=e,!e&&A&&(this.scroller.style[f]="0.001s"),this.hScrollbar&&(this.hScrollbarIndicator.style[f]=e),this.vScrollbar&&(this.vScrollbarIndicator.style[f]=e)},_momentum:function(e,t,n,i,s){var o=6e-4,u=r.abs(e)/t,a=u*u/(2*o),f=0,l=0;return e>0&&a>n?(l=s/(6/(a/u*o)),n+=l,u=u*n/a,a=n):e<0&&a>i&&(l=s/(6/(a/u*o)),i+=l,u=u*i/a,a=i),a*=e<0?-1:1,f=u/o,{dist:a,time:r.round(f)}},_offset:function(e){var t=-e.offsetLeft,n=-e.offsetTop;while(e=e.offsetParent)t-=e.offsetLeft,n-=e.offsetTop;return e!=this.wrapper&&(t*=this.scale,n*=this.scale),{left:t,top:n}},_snap:function(e,t){var n=this,i,s,o,u,a,f;o=n.pagesX.length-1;for(i=0,s=n.pagesX.length;i<s;i++)if(e>=n.pagesX[i]){o=i;break}o==n.currPageX&&o>0&&n.dirX<0&&o--,e=n.pagesX[o],a=r.abs(e-n.pagesX[n.currPageX]),a=a?r.abs(n.x-e)/a*500:0,n.currPageX=o,o=n.pagesY.length-1;for(i=0;i<o;i++)if(t>=n.pagesY[i]){o=i;break}return o==n.currPageY&&o>0&&n.dirY<0&&o--,t=n.pagesY[o],f=r.abs(t-n.pagesY[n.currPageY]),f=f?r.abs(n.y-t)/f*500:0,n.currPageY=o,u=r.round(r.max(a,f))||200,{x:e,y:t,time:u}},_bind:function(e,t,n){(t||this.scroller).addEventListener(e,this,!!n)},_unbind:function(e,t,n){(t||this.scroller).removeEventListener(e,this,!!n)},destroy:function(){var t=this;t.scroller.style[u]="",t.hScrollbar=!1,t.vScrollbar=!1,t._scrollbar("h"),t._scrollbar("v"),t._unbind(w,e),t._unbind(E),t._unbind(S,e),t._unbind(x,e),t._unbind(T,e),t.options.hasTouch||(t._unbind("DOMMouseScroll"),t._unbind("mousewheel")),t.options.useTransition&&t._unbind(N),t.options.checkDOMChanges&&clearInterval(t.checkDOMTime),t.options.onDestroy&&t.options.onDestroy.call(t)},refresh:function(){var e=this,t,n,i,s,o=0,u=0;e.scale<e.options.zoomMin&&(e.scale=e.options.zoomMin),e.wrapperW=e.wrapper.clientWidth||1,e.wrapperH=e.wrapper.clientHeight||1,e.minScrollY=-e.options.topOffset||0,e.scrollerW=r.round(e.scroller.offsetWidth*e.scale),e.scrollerH=r.round((e.scroller.offsetHeight+e.minScrollY)*e.scale),e.maxScrollX=e.wrapperW-e.scrollerW,e.maxScrollY=e.wrapperH-e.scrollerH+e.minScrollY,e.dirX=0,e.dirY=0,e.options.onRefresh&&e.options.onRefresh.call(e),e.hScroll=e.options.hScroll&&e.maxScrollX<0,e.vScroll=e.options.vScroll&&(!e.options.bounceLock&&!e.hScroll||e.scrollerH>e.wrapperH),e.hScrollbar=e.hScroll&&e.options.hScrollbar,e.vScrollbar=e.vScroll&&e.options.vScrollbar&&e.scrollerH>e.wrapperH,t=e._offset(e.wrapper),e.wrapperOffsetLeft=-t.left,e.wrapperOffsetTop=-t.top;if(typeof e.options.snap=="string"){e.pagesX=[],e.pagesY=[],s=e.scroller.querySelectorAll(e.options.snap);for(n=0,i=s.length;n<i;n++)o=e._offset(s[n]),o.left+=e.wrapperOffsetLeft,o.top+=e.wrapperOffsetTop,e.pagesX[n]=o.left<e.maxScrollX?e.maxScrollX:o.left*e.scale,e.pagesY[n]=o.top<e.maxScrollY?e.maxScrollY:o.top*e.scale}else if(e.options.snap){e.pagesX=[];while(o>=e.maxScrollX)e.pagesX[u]=o,o-=e.wrapperW,u++;e.maxScrollX%e.wrapperW&&(e.pagesX[e.pagesX.length]=e.maxScrollX-e.pagesX[e.pagesX.length-1]+e.pagesX[e.pagesX.length-1]),o=0,u=0,e.pagesY=[];while(o>=e.maxScrollY)e.pagesY[u]=o,o-=e.wrapperH,u++;e.maxScrollY%e.wrapperH&&(e.pagesY[e.pagesY.length]=e.maxScrollY-e.pagesY[e.pagesY.length-1]+e.pagesY[e.pagesY.length-1])}e._scrollbar("h"),e._scrollbar("v"),e.zoomed||(e.scroller.style[f]="0",e._resetPos(400))},scrollTo:function(e,t,n,r){var i=this,s=e,o,u;i.stop(),s.length||(s=[{x:e,y:t,time:n,relative:r}]);for(o=0,u=s.length;o<u;o++)s[o].relative&&(s[o].x=i.x-s[o].x,s[o].y=i.y-s[o].y),i.steps.push({x:s[o].x,y:s[o].y,time:s[o].time||0});i._startAni()},scrollToElement:function(e,t){var n=this,i;e=e.nodeType?e:n.scroller.querySelector(e);if(!e)return;i=n._offset(e),i.left+=n.wrapperOffsetLeft,i.top+=n.wrapperOffsetTop,i.left=i.left>0?0:i.left<n.maxScrollX?n.maxScrollX:i.left,i.top=i.top>n.minScrollY?n.minScrollY:i.top<n.maxScrollY?n.maxScrollY:i.top,t=t===undefined?r.max(r.abs(i.left)*2,r.abs(i.top)*2):t,n.scrollTo(i.left,i.top,t)},scrollToPage:function(e,t,n){var r=this,i,s;n=n===undefined?400:n,r.options.onScrollStart&&r.options.onScrollStart.call(r),r.options.snap?(e=e=="next"?r.currPageX+1:e=="prev"?r.currPageX-1:e,t=t=="next"?r.currPageY+1:t=="prev"?r.currPageY-1:t,e=e<0?0:e>r.pagesX.length-1?r.pagesX.length-1:e,t=t<0?0:t>r.pagesY.length-1?r.pagesY.length-1:t,r.currPageX=e,r.currPageY=t,i=r.pagesX[e],s=r.pagesY[t]):(i=-r.wrapperW*e,s=-r.wrapperH*t,i<r.maxScrollX&&(i=r.maxScrollX),s<r.maxScrollY&&(s=r.maxScrollY)),r.scrollTo(i,s,n)},disable:function(){this.stop(),this._resetPos(0),this.enabled=!1,this._unbind(S,e),this._unbind(x,e),this._unbind(T,e)},enable:function(){this.enabled=!0},stop:function(){this.options.useTransition?this._unbind(N):k(this.aniTime),this.steps=[],this.moved=!1,this.animating=!1},zoom:function(e,t,n,r){var i=this,s=n/i.scale;if(!i.options.useTransform)return;i.zoomed=!0,r=r===undefined?200:r,e=e-i.wrapperOffsetLeft-i.x,t=t-i.wrapperOffsetTop-i.y,i.x=e-e*s+i.x,i.y=t-t*s+i.y,i.scale=n,i.refresh(),i.x=i.x>0?0:i.x<i.maxScrollX?i.maxScrollX:i.x,i.y=i.y>i.minScrollY?i.minScrollY:i.y<i.maxScrollY?i.maxScrollY:i.y,i.scroller.style[f]=r+"ms",i.scroller.style[u]="translate("+i.x+"px,"+i.y+"px) scale("+n+")"+L,i.zoomed=!1},isReady:function(){return!this.moved&&!this.zoomed&&!this.animating}},i=null,typeof t!="undefined"?t.iScroll=M:e.iScroll=M})(window,document)}),define("$model/UI2/system/components/bootstrap/lib/js/bootstrap",["require"],function(e){if(typeof jQuery=="undefined")throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||t[0]==1&&t[1]==9&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(e){function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(e.style[n]!==undefined)return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one("bsTransitionEnd",function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t();if(!e.support.transition)return;e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}}})}(jQuery),+function(e){function r(t){return this.each(function(){var r=e(this),i=r.data("bs.alert");i||r.data("bs.alert",i=new n(this)),typeof t=="string"&&i[t].call(r)})}var t='[data-dismiss="alert"]',n=function(n){e(n).on("click",t,this.close)};n.VERSION="3.3.2",n.TRANSITION_DURATION=150,n.prototype.close=function(t){function o(){s.detach().trigger("closed.bs.alert").remove()}var r=e(this),i=r.attr("data-target");i||(i=r.attr("href"),i=i&&i.replace(/.*(?=#[^\s]*$)/,""));var s=e(i);t&&t.preventDefault(),s.length||(s=r.closest(".alert")),s.trigger(t=e.Event("close.bs.alert"));if(t.isDefaultPrevented())return;s.removeClass("in"),e.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o()};var i=e.fn.alert;e.fn.alert=r,e.fn.alert.Constructor=n,e.fn.alert.noConflict=function(){return e.fn.alert=i,this},e(document).on("click.bs.alert.data-api",t,n.prototype.close)}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.button"),s=typeof n=="object"&&n;i||r.data("bs.button",i=new t(this,s)),n=="toggle"?i.toggle():n&&i.setState(n)})}var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.isLoading=!1};t.VERSION="3.3.2",t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(t){var n="disabled",r=this.$element,i=r.is("input")?"val":"html",s=r.data();t+="Text",s.resetText==null&&r.data("resetText",r[i]()),setTimeout(e.proxy(function(){r[i](s[t]==null?this.options[t]:s[t]),t=="loadingText"?(this.isLoading=!0,r.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,r.removeClass(n).removeAttr(n))},this),0)},t.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");n.prop("type")=="radio"&&(n.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));e&&this.$element.toggleClass("active")};var r=e.fn.button;e.fn.button=n,e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=r,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(t){var r=e(t.target);r.hasClass("btn")||(r=r.closest(".btn")),n.call(r,"toggle"),t.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(t.type))})}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.carousel"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n),o=typeof n=="string"?n:s.slide;i||r.data("bs.carousel",i=new t(this,s)),typeof n=="number"?i.to(n):o?i[o]():s.interval&&i.pause().cycle()})}var t=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),this.options.pause=="hover"&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};t.VERSION="3.3.2",t.TRANSITION_DURATION=600,t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},t.prototype.keydown=function(e){if(/input|textarea/i.test(e.target.tagName))return;switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},t.prototype.getItemForDirection=function(e,t){var n=this.getItemIndex(t),r=e=="prev"&&n===0||e=="next"&&n==this.$items.length-1;if(r&&!this.options.wrap)return t;var i=e=="prev"?-1:1,s=(n+i)%this.$items.length;return this.$items.eq(s)},t.prototype.to=function(e){var t=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));if(e>this.$items.length-1||e<0)return;return this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",this.$items.eq(e))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(this.sliding)return;return this.slide("next")},t.prototype.prev=function(){if(this.sliding)return;return this.slide("prev")},t.prototype.slide=function(n,r){var i=this.$element.find(".item.active"),s=r||this.getItemForDirection(n,i),o=this.interval,u=n=="next"?"left":"right",a=this;if(s.hasClass("active"))return this.sliding=!1;var f=s[0],l=e.Event("slide.bs.carousel",{relatedTarget:f,direction:u});this.$element.trigger(l);if(l.isDefaultPrevented())return;this.sliding=!0,o&&this.pause();if(this.$indicators.length){this.$indicators.find(".active").removeClass("active");var c=e(this.$indicators.children()[this.getItemIndex(s)]);c&&c.addClass("active")}var h=e.Event("slid.bs.carousel",{relatedTarget:f,direction:u});return e.support.transition&&this.$element.hasClass("slide")?(s.addClass(n),s[0].offsetWidth,i.addClass(u),s.addClass(u),i.one("bsTransitionEnd",function(){s.removeClass([n,u].join(" ")).addClass("active"),i.removeClass(["active",u].join(" ")),a.sliding=!1,setTimeout(function(){a.$element.trigger(h)},0)}).emulateTransitionEnd(t.TRANSITION_DURATION)):(i.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(h)),o&&this.cycle(),this};var r=e.fn.carousel;e.fn.carousel=n,e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=r,this};var i=function(t){var r,i=e(this),s=e(i.attr("data-target")||(r=i.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""));if(!s.hasClass("carousel"))return;var o=e.extend({},s.data(),i.data()),u=i.attr("data-slide-to");u&&(o.interval=!1),n.call(s,o),u&&s.data("bs.carousel").to(u),t.preventDefault()};e(document).on("click.bs.carousel.data-api","[data-slide]",i).on("click.bs.carousel.data-api","[data-slide-to]",i),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){function n(t){var n,r=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(r)}function r(n){return this.each(function(){var r=e(this),i=r.data("bs.collapse"),s=e.extend({},t.DEFAULTS,r.data(),typeof n=="object"&&n);!i&&s.toggle&&n=="show"&&(s.toggle=!1),i||r.data("bs.collapse",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(n,r){this.$element=e(n),this.options=e.extend({},t.DEFAULTS,r),this.$trigger=e(this.options.trigger).filter('[href="#'+n.id+'"], [data-target="#'+n.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};t.VERSION="3.3.2",t.TRANSITION_DURATION=350,t.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},t.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},t.prototype.show=function(){if(this.transitioning||this.$element.hasClass("in"))return;var n,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(i&&i.length){n=i.data("bs.collapse");if(n&&n.transitioning)return}var s=e.Event("show.bs.collapse");this.$element.trigger(s);if(s.isDefaultPrevented())return;i&&i.length&&(r.call(i,"hide"),n||i.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var u=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return u.call(this);var a=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(u,this)).emulateTransitionEnd(t.TRANSITION_DURATION)[o](this.$element[0][a])},t.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass("in"))return;var n=e.Event("hide.bs.collapse");this.$element.trigger(n);if(n.isDefaultPrevented())return;var r=this.dimension();this.$element[r](this.$element[r]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};if(!e.support.transition)return i.call(this);this.$element[r](0).one("bsTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(t.TRANSITION_DURATION)},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},t.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(t,r){var i=e(r);this.addAriaAndCollapsedClass(n(i),i)},this)).end()},t.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var i=e.fn.collapse;e.fn.collapse=r,e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(t){var i=e(this);i.attr("data-target")||t.preventDefault();var s=n(i),o=s.data("bs.collapse"),u=o?"toggle":e.extend({},i.data(),{trigger:this});r.call(s,u)})}(jQuery),+function(e){function i(r){if(r&&r.which===3)return;e(t).remove(),e(n).each(function(){var t=e(this),n=s(t),i={relatedTarget:this};if(!n.hasClass("open"))return;n.trigger(r=e.Event("hide.bs.dropdown",i));if(r.isDefaultPrevented())return;t.attr("aria-expanded","false"),n.removeClass("open").trigger("hidden.bs.dropdown",i)})}function s(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}function o(t){return this.each(function(){var n=e(this),i=n.data("bs.dropdown");i||n.data("bs.dropdown",i=new r(this)),typeof t=="string"&&i[t].call(n)})}var t=".dropdown-backdrop",n='[data-toggle="dropdown"]',r=function(t){e(t).on("click.bs.dropdown",this.toggle)};r.VERSION="3.3.2",r.prototype.toggle=function(t){var n=e(this);if(n.is(".disabled, :disabled"))return;var r=s(n),o=r.hasClass("open");i();if(!o){"ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",i);var u={relatedTarget:this};r.trigger(t=e.Event("show.bs.dropdown",u));if(t.isDefaultPrevented())return;n.trigger("focus").attr("aria-expanded","true"),r.toggleClass("open").trigger("shown.bs.dropdown",u)}return!1},r.prototype.keydown=function(t){if(!/(38|40|27|32)/.test(t.which)||/input|textarea/i.test(t.target.tagName))return;var r=e(this);t.preventDefault(),t.stopPropagation();if(r.is(".disabled, :disabled"))return;var i=s(r),o=i.hasClass("open");if(!o&&t.which!=27||o&&t.which==27)return t.which==27&&i.find(n).trigger("focus"),r.trigger("click");var u=" li:not(.divider):visible a",a=i.find('[role="menu"]'+u+', [role="listbox"]'+u);if(!a.length)return;var f=a.index(t.target);t.which==38&&f>0&&f--,t.which==40&&f<a.length-1&&f++,~f||(f=0),a.eq(f).trigger("focus")};var u=e.fn.dropdown;e.fn.dropdown=o,e.fn.dropdown.Constructor=r,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=u,this},e(document).on("click.bs.dropdown.data-api",i).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",n,r.prototype.toggle).on("keydown.bs.dropdown.data-api",n,r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',r.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',r.prototype.keydown)}(jQuery),+function(e){function n(n,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},t.DEFAULTS,i.data(),typeof n=="object"&&n);s||i.data("bs.modal",s=new t(this,o)),typeof n=="string"?s[n](r):o.show&&s.show(r)})}var t=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};t.VERSION="3.3.2",t.TRANSITION_DURATION=300,t.BACKDROP_TRANSITION_DURATION=150,t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},t.prototype.show=function(n){var r=this,i=e.Event("show.bs.modal",{relatedTarget:n});this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented())return;this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.options.backdrop&&r.adjustBackdrop(),r.adjustDialog(),i&&r.$element[0].offsetWidth,r.$element.addClass("in").attr("aria-hidden",!1),r.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:n});i?r.$element.find(".modal-dialog").one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(t.TRANSITION_DURATION):r.$element.trigger("focus").trigger(s)})},t.prototype.hide=function(n){n&&n.preventDefault(),n=e.Event("hide.bs.modal"),this.$element.trigger(n);if(!this.isShown||n.isDefaultPrevented())return;this.isShown=!1,this.escape(),this.resize(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(t.TRANSITION_DURATION):this.hideModal()},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]!==e.target&&!this.$element.has(e.target).length&&this.$element.trigger("focus")},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){e.which==27&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},t.prototype.resize=function(){this.isShown?e(window).on("resize.bs.modal",e.proxy(this.handleUpdate,this)):e(window).off("resize.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetAdjustments(),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(n){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&i;this.$backdrop=e('<div class="modal-backdrop '+i+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",e.proxy(function(e){if(e.target!==e.currentTarget)return;this.options.backdrop=="static"?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in");if(!n)return;s?this.$backdrop.one("bsTransitionEnd",n).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):n()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){r.removeBackdrop(),n&&n()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(t.BACKDROP_TRANSITION_DURATION):o()}else n&&n()},t.prototype.handleUpdate=function(){this.options.backdrop&&this.adjustBackdrop(),this.adjustDialog()},t.prototype.adjustBackdrop=function(){this.$backdrop.css("height",0).css("height",this.$element[0].scrollHeight)},t.prototype.adjustDialog=function(){var e=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&e?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!e?this.scrollbarWidth:""})},t.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},t.prototype.checkScrollbar=function(){this.bodyIsOverflowing=document.body.scrollHeight>document.documentElement.clientHeight,this.scrollbarWidth=this.measureScrollbar()},t.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.bodyIsOverflowing&&this.$body.css("padding-right",e+this.scrollbarWidth)},t.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},t.prototype.measureScrollbar=function(){var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var r=e.fn.modal;e.fn.modal=n,e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=r,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(t){var r=e(this),i=r.attr("href"),s=e(r.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},s.data(),r.data());r.is("a")&&t.preventDefault(),s.one("show.bs.modal",function(e){if(e.isDefaultPrevented())return;s.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),n.call(s,o,this)})}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.tooltip",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},t.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);var i=this.options.trigger.split(" ");for(var s=i.length;s--;){var o=i[s];if(o=="click")this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if(o!="manual"){var u=o=="hover"?"mouseenter":"focusin",a=o=="hover"?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&typeof t.delay=="number"&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},t.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(n&&n.$tip&&n.$tip.is(":visible")){n.hoverState="in";return}n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in";if(!n.options.delay||!n.options.delay.show)return n.show();n.timeout=setTimeout(function(){n.hoverState=="in"&&n.show()},n.options.delay.show)},t.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out";if(!n.options.delay||!n.options.delay.hide)return n.hide();n.timeout=setTimeout(function(){n.hoverState=="out"&&n.hide()},n.options.delay.hide)},t.prototype.show=function(){var n=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(n);var r=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(n.isDefaultPrevented()||!r)return;var i=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var u=typeof this.options.placement=="function"?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,a=/\s?auto?\s?/i,f=a.test(u);f&&(u=u.replace(a,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(u).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var l=this.getPosition(),c=s[0].offsetWidth,h=s[0].offsetHeight;if(f){var p=u,d=this.options.container?e(this.options.container):this.$element.parent(),v=this.getPosition(d);u=u=="bottom"&&l.bottom+h>v.bottom?"top":u=="top"&&l.top-h<v.top?"bottom":u=="right"&&l.right+c>v.width?"left":u=="left"&&l.left-c<v.left?"right":u,s.removeClass(p).addClass(u)}var m=this.getCalculatedOffset(u,l,c,h);this.applyPlacement(m,u);var g=function(){var e=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,e=="out"&&i.leave(i)};e.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",g).emulateTransitionEnd(t.TRANSITION_DURATION):g()}},t.prototype.applyPlacement=function(t,n){var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),t.top=t.top+o,t.left=t.left+u,e.offset.setOffset(r[0],e.extend({using:function(e){r.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),r.addClass("in");var a=r[0].offsetWidth,f=r[0].offsetHeight;n=="top"&&f!=s&&(t.top=t.top+s-f);var l=this.getViewportAdjustedDelta(n,t,a,f);l.left?t.left+=l.left:t.top+=l.top;var c=/top|bottom/.test(n),h=c?l.left*2-i+a:l.top*2-s+f,p=c?"offsetWidth":"offsetHeight";r.offset(t),this.replaceArrow(h,r[0][p],c)},t.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(n){function o(){r.hoverState!="in"&&i.detach(),r.$element.removeAttr("aria-describedby").trigger("hidden.bs."+r.type),n&&n()}var r=this,i=this.tip(),s=e.Event("hide.bs."+this.type);this.$element.trigger(s);if(s.isDefaultPrevented())return;return i.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?i.one("bsTransitionEnd",o).emulateTransitionEnd(t.TRANSITION_DURATION):o(),this.hoverState=null,this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||typeof e.attr("data-original-title")!="string")&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],r=n.tagName=="BODY",i=n.getBoundingClientRect();i.width==null&&(i=e.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var s=r?{top:0,left:0}:t.offset(),o={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},u=r?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},i,o,u,s)},t.prototype.getCalculatedOffset=function(e,t,n,r){return e=="bottom"?{top:t.top+t.height,left:t.left+t.width/2-n/2}:e=="top"?{top:t.top-r,left:t.left+t.width/2-n/2}:e=="left"?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},t.prototype.getViewportAdjustedDelta=function(e,t,n,r){var i={top:0,left:0};if(!this.$viewport)return i;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var u=t.top-s-o.scroll,a=t.top+s-o.scroll+r;u<o.top?i.top=o.top-u:a>o.top+o.height&&(i.top=o.top+o.height-a)}else{var f=t.left-s,l=t.left+s+n;f<o.left?i.left=o.left-f:l>o.width&&(i.left=o.left+o.width-l)}return i},t.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||(typeof n.title=="function"?n.title.call(t[0]):n.title),e},t.prototype.getUID=function(e){do e+=~~(Math.random()*1e6);while(document.getElementById(e));return e},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},t.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type)})};var r=e.fn.tooltip;e.fn.tooltip=n,e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=r,this}}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s=typeof n=="object"&&n;if(!i&&n=="destroy")return;i||r.data("bs.popover",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.VERSION="3.3.2",t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),t.prototype.constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?typeof n=="string"?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||(typeof t.content=="function"?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var r=e.fn.popover;e.fn.popover=n,e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=r,this}}(jQuery),+function(e){function t(n,r){var i=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(n).is("body")?e(window):e(n),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",i),this.refresh(),this.process()}function n(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s=typeof n=="object"&&n;i||r.data("bs.scrollspy",i=new t(this,s)),typeof n=="string"&&i[n]()})}t.VERSION="3.3.2",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",n=0;e.isWindow(this.$scrollElement[0])||(t="position",n=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var r=this;this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#./.test(i)&&e(i);return s&&s.length&&s.is(":visible")&&[[s[t]().top+n,i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){r.offsets.push(this[0]),r.targets.push(this[1])})},t.prototype.process=function(){var e=this.$scrollElement.scrollTop()+this.options.offset,t=this.getScrollHeight(),n=this.options.offset+t-this.$scrollElement.height(),r=this.offsets,i=this.targets,s=this.activeTarget,o;this.scrollHeight!=t&&this.refresh();if(e>=n)return s!=(o=i[i.length-1])&&this.activate(o);if(s&&e<r[0])return this.activeTarget=null,this.clear();for(o=r.length;o--;)s!=i[o]&&e>=r[o]&&(!r[o+1]||e<=r[o+1])&&this.activate(i[o])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=r,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new t(this)),typeof n=="string"&&i[n]()})}var t=function(t){this.element=e(t)};t.VERSION="3.3.2",t.TRANSITION_DURATION=150,t.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.data("target");r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,""));if(t.parent("li").hasClass("active"))return;var i=n.find(".active:last a"),s=e.Event("hide.bs.tab",{relatedTarget:t[0]}),o=e.Event("show.bs.tab",{relatedTarget:i[0]});i.trigger(s),t.trigger(o);if(o.isDefaultPrevented()||s.isDefaultPrevented())return;var u=e(r);this.activate(t.closest("li"),n),this.activate(u,u.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})},t.prototype.activate=function(n,r,i){function u(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),n.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),o?(n[0].offsetWidth,n.addClass("in")):n.removeClass("fade"),n.parent(".dropdown-menu")&&n.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=r.find("> .active"),o=i&&e.support.transition&&(s.length&&s.hasClass("fade")||!!r.find("> .fade").length);s.length&&o?s.one("bsTransitionEnd",u).emulateTransitionEnd(t.TRANSITION_DURATION):u(),s.removeClass("in")};var r=e.fn.tab;e.fn.tab=n,e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=r,this};var i=function(t){t.preventDefault(),n.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),+function(e){function n(n){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s=typeof n=="object"&&n;i||r.data("bs.affix",i=new t(this,s)),typeof n=="string"&&i[n]()})}var t=function(n,r){this.options=e.extend({},t.DEFAULTS,r),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(n),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};t.VERSION="3.3.2",t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0,target:window},t.prototype.getState=function(e,t,n,r){var i=this.$target.scrollTop(),s=this.$element.offset(),o=this.$target.height();if(n!=null&&this.affixed=="top")return i<n?"top":!1;if(this.affixed=="bottom")return n!=null?i+this.unpin<=s.top?!1:"bottom":i+o<=e-r?!1:"bottom";var u=this.affixed==null,a=u?i:s.top,f=u?o:t;return n!=null&&i<=n?"top":r!=null&&a+f>=e-r?"bottom":!1},t.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(t.RESET).addClass("affix");var e=this.$target.scrollTop(),n=this.$element.offset();return this.pinnedOffset=n.top-e},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(!this.$element.is(":visible"))return;var n=this.$element.height(),r=this.options.offset,i=r.top,s=r.bottom,o=e("body").height();typeof r!="object"&&(s=i=r),typeof i=="function"&&(i=r.top(this.$element)),typeof s=="function"&&(s=r.bottom(this.$element));var u=this.getState(o,n,i,s);if(this.affixed!=u){this.unpin!=null&&this.$element.css("top","");var a="affix"+(u?"-"+u:""),f=e.Event(a+".bs.affix");this.$element.trigger(f);if(f.isDefaultPrevented())return;this.affixed=u,this.unpin=u=="bottom"?this.getPinnedOffset():null,this.$element.removeClass(t.RESET).addClass(a).trigger(a.replace("affix","affixed")+".bs.affix")}u=="bottom"&&this.$element.offset({top:o-n-s})};var r=e.fn.affix;e.fn.affix=n,e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=r,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var t=e(this),r=t.data();r.offset=r.offset||{},r.offsetBottom!=null&&(r.offset.bottom=r.offsetBottom),r.offsetTop!=null&&(r.offset.top=r.offsetTop),n.call(t,r)})})}(jQuery)}),define("$model/UI2/system/components/justep/bar/bar.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/bar/bar",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./bar.config","css!./css/bar"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./bar"),s=e("./bar.config");e("css!./css/bar").load();var o=r.extend({getUrl:function(){return i},constructor:function(e){this.callParent(e)},buildTemplate:function(e){return n.format("<div class='x-bar' xid='{0}' componet='{1}'></div>",e.xid)},getConfig:function(){return s},init:function(){this.callParent()}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/toolBar/toolBar.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/toolBar/toolBar",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./toolBar.config","css!./css/toolBar"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./toolBar"),i=e("./toolBar.config");e("css!./css/toolBar").load();var s=n.ViewComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},buildTemplate:function(e){}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/button.config",["require"],function(e){return{properties:{label:"string",icon:"string",target:"string",disabled:"boolean"},events:["onClick"],binds:{}}}),define("$model/UI2/system/components/justep/button/button",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./button.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./button"),i=e("./button.config"),s=n.BindComponent.extend({constructor:function(e){this.callParent(e),this.opDisabled=!1,this.icon="",this.label="",this.target="",this.opIcon="",this.opLabel="",this.isImgIcon=!1,this.imgIcon=["",""],this.on(n.Component.OPERATION_CHANGED,function(e){this.getModel().componentPromise(this.domNode).done(function(t){t._doOperationChanged(e)})},this)},getConfig:function(){return i},dispose:function(){this.$domNode.off("touchstart"),this.$domNode.off("click",t.proxy(this._doClick,this)),this._unBindTargetEvent(this.target),this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="btn btn-default"),"<a class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' "+" ><i class='"+(this.isImgIcon?"":e.icon)+"'/>"+(this.isImgIcon?"<img src='"+this.imgIcon[this.disabled?1:0]+"'/>":"")+"<span>"+(e.label?e.label:"")+"</span></a>"},doInit:function(e,n){this.$domNode.on("click",t.proxy(this._doClick,this)),this.target&&this._bindTargetEvent(this.target)},_bindTargetEvent:function(e){var t=this.getModel(),n=this;t.componentPromise(e).done(function(e){e.on("onActive",n._doActiveTarget,n),e.on("onInactive",n._doInactiveTarget,n),typeof e["isActive"]=="function"&&e.isActive()&&n.addClass("active")}),this.on("onClick",this._doClickActiveTarget,this)},_unBindTargetEvent:function(e){if(e){var t=this.getModel(),n=this;t.componentPromise(e).done(function(e){e.off("onActive",n._doActiveTarget,n),e.off("onInactive",n._doInactiveTarget,n)}),this.off("onClick",this._doClickActiveTarget,this)}},_doActiveTarget:function(e){this.addClass("active")},_doInactiveTarget:function(e){this.removeClass("active")},_doClickActiveTarget:function(e){var t=this.getModel(),n=t.comp(this.target);n&&typeof n["active"]=="function"&&n.active()},_doOperationPropChanged:function(e){e.property=="label"?this.set({opLabel:e.value}):e.property=="icon"?this.set({opIcon:e.value}):e.property=="enable"&&this.set({opDisabled:!e.value})},_doOperationChanged:function(e){if("onClick"==e.eventName){var n,r=this;this.operation&&(n=this.operation,this.getModel().componentPromise(n.owner).done(function(e){e.unOpChange(n.name,r._doOperationPropChanged,r)}));var i=this.getEventOperation("onClick");t.isArray(i)&&(i=i.length>0?i[0]:null),i&&(n=this._getOperation(i.operation),n&&(this.operation=n,i.operation=n,this.getModel().componentPromise(n.owner).done(function(e){e.onOpChange(n.name,r._doOperationPropChanged,r);var t={};t.opIcon=e.getOperationIcon(n.name),t.opLabel=e.getOperationLabel(n.name),t.opDisabled=!e.getOperationEnable(n.name),r.set(t)})))}},_execEventOperation:function(e,t){if(this.isDisabled())return;this.callParent(e,t)},_getLabelNode:function(){return this.$domNode.children("span")},_getIconNode:function(){return this.$domNode.children("i")},_getImgNode:function(){return this.$domNode.children("img")},isDisabled:function(){return this.callParent()||this.opDisabled},disabledRender:function(){var e=this.isDisabled();this.isImgIcon&&this.$domNode&&this._getImgNode().attr("src",this.imgIcon[e?1:0]),e?this.$domNode.attr("disabled",!0):this.$domNode.removeAttr("disabled")},propertyChangedHandler:function(e,t,n){switch(e){case"label":case"opLabel":t!=n&&this.$domNode&&this._getLabelNode().text(this.label||this.opLabel);break;case"target":t!=n&&this._inited&&(this._unBindTargetEvent(t),this._bindTargetEvent(n));break;case"icon":case"opIcon":if(t!=n){this._setIcon(this.icon||this.opIcon);if(this.$domNode)if(!this.isImgIcon)t&&this._getIconNode().removeClass(t),n&&this._getIconNode().addClass(this.icon||this.opIcon),this._getImgNode().remove();else if(n){var r=this._getImgNode();r.size()<=0&&this._getLabelNode().before("<img/>"),this._getImgNode().attr("src",this.imgIcon[this.isDisabled()?1:0]),this._getIconNode().removeAttr("class")}}break;case"opDisabled":t!=n&&this.disabledRender();break;default:this.callParent(e,t,n)}},_setIcon:function(t){if(typeof t=="string"&&0===t.indexOf("img:")){this.isImgIcon=!0;var n=t.indexOf("|");n<0&&(n=t.length),this.imgIcon[0]=e.toUrl(t.slice(4,n)),this.imgIcon[1]=e.toUrl(t.slice(n+1,t.length))}else this.isImgIcon=!1},_doClick:function(e){if(this.isDisabled())return;this.fireEvent("onClick",{source:this})},render:function(){this.callParent()}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/buttonGroup.config",["require"],function(e){return{properties:{tabbed:"boolean",selected:"string",disabled:"boolean"},events:["onSelect"],binds:{}}}),define("$model/UI2/system/components/justep/button/buttonGroup",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./button","./buttonGroup.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("./button"),i=e.normalizeName("./buttonGroup"),s=e("./buttonGroup.config"),o=n.BindComponent.extend({constructor:function(e){this.callParent(e),this.tabbed=!1,this.selected=null},dispose:function(){this.$domNode.off("click",t.proxy(this._doClick,this)),this.callParent()},getConfig:function(){return s},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="btn-group"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+i+"' "+" ></div>"},doInit:function(e,n){this.$domNode.on("click",t.proxy(this._doClick,this))},propertyChangedHandler:function(e,t,n){switch(e){case"tabbed":if(t!=n&&this._inited){typeof n=="string"&&(n=n=="true");var r=n?"addClass":"removeClass";this.$domNode[r](e)}break;case"selected":t!=n&&this.select(n);break;default:this.callParent(e,t,n)}},_doClick:function(e){if(this.tabbed){var t=this._getBtn(e.target);this.select(t)}},_getBtn:function(e){if(e==this.domNode)return null;var t=n.Component.getComponent(e);return t instanceof r?t:this._getBtn(e.parentNode)},select:function(e){if("string"==typeof e){var t=this.getModel(),n=e;e=t.comp(n),e||t.componentPromise(n).done(function(e){e.addClass("active")})}if(e instanceof r){if(this.hasListener("onSelect")){var i={source:this,item:e,cancel:!1};this.fireEvent("onSelect",i);if(i.cancel)return}this.each(function(t){var n=t!==e?"removeClass":"addClass";t[n]("active")},this)}},each:function(e,t){typeof e=="function"&&this.$domNode.children("a.btn").each(function(){var i=n.Component.getComponent(this);i instanceof r&&e.call(t||window,i)})},render:function(){this.callParent();var e=["tabbed"];for(var t=0;t<e.length;t++){var n=this[e[t]]?"addClass":"removeClass";this.$domNode[n](e[t])}}});return n.Component.register(i,o),o}),define("$model/UI2/system/components/justep/button/radio.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref","bind-label":"label","bind-value":"value"}}}),define("$model/UI2/system/components/justep/button/radio",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./radio.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./radio"),i=e("./radio.config"),s=n.BindComponent.extend({_defaultClass:"x-radio",_type:"radio",getConfig:function(){return i},constructor:function(e){this.callParent(e),this.label=null,this.name=null,this.checkedValue=undefined,this.value=null,this.checked=!1,this.on(n.ViewComponent.DATA_CHANGED,function(e){if("ref"==e.name)return;var t={};t[e.name]=e.value,this.set(t)},this)},dispose:function(){this._getInput().off("change",t.proxy(this._doClick,this)),this.callParent()},val:function(){if(arguments.length===0)return this.value;this.value=arguments[0],this._getInput().prop("checked",this.checkedValue===undefined?!!this.value:this.checkedValue==this.value).val(this.value)},_buildInput:function(e){var n=t("<input"+(e.name?" name='"+e.name+"'":"")+(e.checked?" checked":"")+" type='"+this._type+"'/>");return undefined!==e.value&&n.attr("value",e.value),n},_buildLabel:function(e){var n=t("<label></label>");return e.label&&n.text(e.label),n},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]=this._defaultClass);var n=t("<span"+(e["class"]?" class='"+e["class"]+"'":"")+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"'>"+"</span>");return n.append(this._buildInput(e)),n.append(this._buildLabel(e)),n},doInit:function(e,r){var i=this._getLabel(),s=this._getInput(),o=s.attr("id");o||s.attr("id",n.UUID.createUUID()),i.attr("for",s.attr("id")),s.on("change",t.proxy(this._doClick,this));var u=this.$domNode.attr("name");u&&s.attr("name",u);if(e&&!e.hasOwnProperty("ref")){var a={};n.Bind.isObservable(e.value)&&(a.value=e.value.get()),n.Bind.isObservable(e.label)&&(a.label=e.label.get()),this.set(a)}},doUpdate:function(e,t){e&&(e.hasOwnProperty("ref")?(this.updateValue(e.ref),this.updateReadonly(e.ref)):this.updateReadonly(e.value))},_doClick:function(e){var t=this._getInput()[0].checked;this.value=this.checkedValue===undefined?t:t?this.checkedValue:null,this.fireEvent("onChange",{source:this,checked:t,value:this.value}),this.val2ref()},_getInput:function(){return this.$domNode.children("input")},_getLabel:function(){return this.$domNode.children("label")},get:function(e){return"checked"===e?this._getInput().prop("checked"):this.callParent(e)},disabledRender:function(){this.$domNode&&this._getInput().attr("disabled",this.isDisabled())},propertyChangedHandler:function(e,t,n){switch(e){case"label":t!=n&&this.$domNode&&this._getLabel().text(n);break;case"value":t!=n&&this.$domNode&&this.val(n);break;case"checked":t!=n&&this.$domNode&&this._getInput().prop("checked",n);break;default:this.callParent(e,t,n)}}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/checkbox.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref","bind-label":"label","bind-value":"value"}}}),define("$model/UI2/system/components/justep/button/checkbox",["require","$UI/system/lib/justep","./radio","./checkbox.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./radio"),r=e.normalizeName("./checkbox"),i=e("./checkbox.config"),s=n.extend({_defaultClass:"x-checkbox",_type:"checkbox",getConfig:function(){return i},getDisplayHtml:function(e){return s.getDisplayHtml(e)}}),o=function(e){var t=e.getParam("checkedValue");return t===undefined&&(t=1),t},u=function(e){var t=e.comp;return function(n){var r=n.target||n.srcElement,i=t.getDataRow(r),s=o(e);i&&i.val(e.colDef.name,$(r).prop("checked")?s:null)}};return s.getDisplayHtml=function(e){if(!e)return;var n="",r=e.row&&e.row.data,i=e.readonly||(r?r.getReadonly(e.colDef.name,e.row):!1);if((e.type=="grid"||e.type=="dataTables")&&!e.readonly){if(!e.comp.__checkbox_fn__){var s=e.comp.getModel(),a="_"+t.UUID.createUUID();e.comp.__checkbox_fn__=a,s[a]=u(e)}n="justep.callModelFn({domNode:event.target||event.srcElement,fn:'"+e.comp.__checkbox_fn__+"'},event)"}var f=o(e),l=e.row.val(e.colDef.name)==f,c="c"+t.UUID.createUUID(),h='<span class="x-checkbox"><input id="'+c+'" type="checkbox" '+(i?"disabled":"")+(n?' onchange="'+n+'"':"")+(l?" checked":"")+'/><label for="'+c+'"/></span>';return h},t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/button/toggle.config",["require"],function(e){return{properties:{},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/button/toggle",["require","$UI/system/lib/justep","./radio","jquery","./toggle.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./radio"),r=e("jquery"),i=e.normalizeName("./toggle"),s=e("./toggle.config"),o=n.extend({constructor:function(e){this.callParent(e),this.type="checkbox",this._defaultClass="x-toggle"},getConfig:function(){return s},_buildInput:function(e){var t=r("<input "+(e.name?" name='"+e.name+"'":"")+(e.checked?" checked='checked'":"")+" type='"+e.type+"' class='"+this._defaultClass+"'/>");return undefined!==e.value&&t.attr("value",e.value),t},_buildLabel:function(e){var t=r("<label></label>");return t.attr("data-on",e.label&&e.label.on?e.label.on:"ON"),t.attr("data-off",e.label&&e.label.off?e.label.off:"OFF"),t.append("<span/>"),t},propertyChangedHandler:function(e,t,n){switch(e){case"type":t!=n&&this._inited&&this._getInput().attr("type",n);break;case"label":this._inited&&(n||(n={}),n.on||(n.on="ON"),n.off||(n.off="OFF"),this._getLabel().attr("data-on",n.on).attr("data-off",n.off));break;default:this.callParent(e,t,n)}}});return t.Component.register(i,o),o}),define("$model/UI2/system/components/justep/contents/contents.config",["require"],function(e){return{properties:{active:"number",interval:"number",routable:"boolean",slidable:"boolean",swipe:"boolean",wrap:"boolean"},events:["onActiveChange","onActiveChanged"],binds:{}}}),define("$model/UI2/system/components/justep/contents/content.config",["require"],function(e){return{events:["onActive","onInactive"],binds:{}}}),define("$model/UI2/system/components/justep/contents/content",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./content.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e("jquery"),s=e.normalizeName("./content"),o=e("./content.config"),u=r.extend({constructor:function(e){this.xid="",this.callParent(e)},getConfig:function(){return o},buildTemplate:function(e){e.xid=e.xid||"",e.body=e.body||"";var t=n.format("<div component='$model/UI2/system/components/justep/contents/content' class='x-contents-content' xid='{0}'>{1}</div>",e.xid,e.body);return t=i(t),this.owner=e.owner,this.owner.$el.append(t),this.xid=e.xid,t},getIndex:function(){return this.$domNode.index()},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.owner.contents.push(this),this.xid=this.$domNode.attr("xid"),this.callParent(e,n)},get:function(e){if(this[e]!==undefined)return this[e];e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.getIndex())},set:function(e,t){this[e]=t;if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else e="set"+n.camelize(e),this.owner[e]&&this.owner[e](this.getIndex(),t)},onAfterSelect:function(){this.owner.to(this.getIndex())},active:function(){this.owner.to(this.xid)},dispose:function(){this.owner=null},doRoute:function(e,t,n){if(!this.owner.routable)return;n=="enter"&&this.active()}});return t.register(s,u),u}),define("$model/UI2/system/components/justep/contents/contents",["require","$UI/system/lib/jquery/transition","$UI/system/lib/base/component","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./content","./contents.config","$UI/system/components/justep/common/res","css!./css/contents"],function(e){e("$UI/system/lib/jquery/transition");var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/justep"),r=e("$UI/system/lib/base/string"),i=e("$UI/system/lib/base/viewComponent"),s=e("jquery"),o=e.normalizeName("./contents"),u=e("./content"),a=e("./contents.config");e("$UI/system/components/justep/common/res"),e("css!./css/contents").load();var f="x-contents",l=i.extend({getConfig:function(){return a},constructor:function(e){this.active=0,this.interval=0,this.contents=[],this.wrap=!0,this.swipe=Modernizr.touch,this.slidable=Modernizr.touch,this.routable=!0,this.callParent(e)},buildTemplate:function(e){e.slidable=e.slidable!==undefined?e.slidable:!0,e.wrap=e.wrap!==undefined?e.wrap:!0,e.swipe=e.swipe!==undefined?e.swipe:!0;var t="";return r.format("<div xid='{0}' class='{1}' component='{2}'>{3}</div>",e.xid,f,o,t)},init:function(e,t){this.callParent(e,t);var r=this;this.$el=s(this.domNode);var i=this.getModel(),o=[],u=[];s(">.x-contents-content",this.$el).each(function(){o.push(s(this).attr("xid"))}),n.Array.each(o,function(e){u.push(i.componentPromise(e))});var a=i.getLoadedDeferred();return s.when.apply(s,u).done(function(){r.to(r.active,function(){r.beginInterval(),a.resolve()}),r.inited()}),this.swipe&&this.supportContentsTouchMove(),(this.swipe||this.slidable)&&s(this.domNode).addClass("slidable"),{dependence:!0}},beginInterval:function(){if(this.interval){var e=this;this.intervaler=setInterval(function(){e.next()},this.interval)}},addRouteItem:function(e){if(!this.routable)return;var t=e.attr("xid"),n=this.getModel().$routeState;for(var r=0;r<this.contents.length;r++){var i=this.contents[r];n.removeState(i.xid,"")}n.addState(t,"",""),n.publishState()},canSwipe:function(e){var t=this.swipe;return t&&typeof this.swipe=="string"&&(t=this.swipe==e),t},supportContentsTouchMove:function(){var e=!1,t={},n,r,i,o,u,a,f,l,c,h=this,p=!0,d=0,v=!1,m,g,y;this.$el.on("touchstart",function(r){a=h.$el.width(),r instanceof s.Event&&(r=r.originalEvent),e=!1,n=!1,p=!0,t.x=r.type==="touchstart"?r.targetTouches[0].pageX:r.pageX,t.y=r.type==="touchstart"?r.targetTouches[0].pageY:r.pageY,u=(new Date).getTime(),f=h.$el.find(">.x-contents-content.active"),m=h.getActiveIndex(),g=m-1,y=m+1;var i=h.$el.find(">.x-contents-content");l=s(i[m-1]),c=s(i[m+1]),h.wrap&&i.length>1&&(l.length===0&&(l=i.last(),g=i.length-1),c.length===0&&(c=i.first(),y=0)),v=!1,v=t.x-h.$domNode.offset().left<d,v||(v=h.$domNode.width()-t.x<d)}),this.$el.on("touchmove",function(u){u instanceof s.Event&&(u=u.originalEvent),u.target&&"INPUT"==u.target.tagName&&u.target.getAttribute("type")=="range"&&(n=!0);if(n===!0||v===!0){n===!0&&(u.hasStopedPropagation=!0);return}if(u.hasStopedPropagation===!0)return;if(u.targetTouches.length>1)return;var h=u.type==="touchmove"?u.targetTouches[0].pageX:u.pageX,d=u.type==="touchmove"?u.targetTouches[0].pageY:u.pageY;r=Math.abs(h-t.x),i=Math.abs(d-t.y),o=h-t.x;if(p&&r>i){var m=f.find(".x-scroll-h");f.hasClass("x-scroll-h")&&(m=f);if(m.length===0)u.preventDefault(),u.hasStopedPropagation=!0,e=!0,n=!1;else{var g=m.get(0).offsetWidth,y=m.get(0).scrollWidth,b=m.get(0).scrollLeft;if(o>0){if(!(b===0&&g<y)){e=!1,n=!0;return}u.preventDefault(),u.hasStopedPropagation=!0,e=!0,n=!1}else{if(b+g!=y){u.hasStopedPropagation=!0,e=!1,n=!0;return}u.preventDefault(),u.hasStopedPropagation=!0,e=!0,n=!1}}}else{if(p){e=!1,n=!0;return}!p&&!n?(u.preventDefault(),u.hasStopedPropagation=!0):!p&&n&&r>i&&(u.hasStopedPropagation=!0)}var w=o/a,E=w*100+"%",S=(-1+w)*100+"%",x=(1+w)*100+"%";if(o>0&&l.length>0)f.transform("translate3d("+E+",0,0)"),f.css("opacity",1-.5*Math.abs(w)),l.addClass("x-content-on-left").removeClass("x-content-on-right"),l.transform("translate3d("+S+",0,0)"),l.css("opacity",.5+.5*Math.abs(w));else{if(!(o<0&&c.length>0)){u.hasStopedPropagation=!1;return}f.transform("translate3d("+E+",0,0)"),f.css("opacity",1-.5*Math.abs(w)),c.addClass("x-content-on-right").removeClass("x-content-on-left"),c.transform("translate3d("+x+",0,0)"),c.css("opacity",.5+.5*Math.abs(w))}}),this.$el.on("touchend",function(t){if(n||!e){e=!1,n=!1,f.transform("").css({opacity:"1"}),l.transform("").css({opacity:""}),c.transform("").css({opacity:""});return}e=!1,n=!1,t instanceof s.Event&&(t=t.originalEvent);var r=(new Date).getTime()-u;if(r<300&&Math.abs(o)>10||r>=300&&Math.abs(o)>a/2){var i=Math.abs(o/a*100);if(o>0&&l.length>0){f.transitionEnd(function(){f.transition(0),l.transition(0),f.addClass("x-content-on-right").removeClass("active"),l.addClass("active").removeClass("x-content-on-left"),f.transform(""),l.transform(""),h.addRouteItem(l),h.active=g,h.contents[g].fireEvent("onActive",{source:h,index:g}),h.getModel().fireEvent("onResize",{source:this}),h.fireEvent("onActiveChanged",{source:h,to:g,from:m,type:"next"}),h.getModel().fireEvent("reflow",l.get(0))}),h.fireEvent("onActiveChange",{source:h,to:g,from:m,type:"next"}),h.contents[m].fireEvent("onInactive",{source:h,index:m}),f.transition(i),l.transition(i),l.transform("translate3d(0,0,0)"),l.css("opacity","1"),f.transform("translate3d(100%,0,0)");return}if(o<0&&c.length>0){f.transitionEnd(function(){f.transition(0),c.transition(0),f.addClass("x-content-on-left").removeClass("active"),c.addClass("active").removeClass("x-content-on-right"),f.transform(""),c.transform(""),h.addRouteItem(c),h.active=y,h.contents[y].fireEvent("onActive",{source:h,index:y}),h.getModel().fireEvent("onResize",{source:this}),h.fireEvent("onActiveChanged",{source:h,to:y,from:m,type:"next"}),h.getModel().fireEvent("reflow",c.get(0))}),h.fireEvent("onActiveChange",{source:h,to:y,from:m,type:"next"}),h.contents[m].fireEvent("onInactive",{source:h,index:m}),f.transition(i),c.transition(i),c.transform("translate3d(0,0,0)"),c.css("opacity","1"),f.transform("translate3d(-100%,0,0)");return}}f.transform("").css({opacity:"1"}),l.transform("").css({opacity:""}),c.transform("").css({opacity:""})})},getActiveIndex:function(){return this.$active=this.$el.find(">.x-contents-content.active"),this.$active.length===0?-1:s(">.x-contents-content",this.$el).index(this.$active)},getIndexByXid:function(e){for(var t=0;t<this.contents.length;t++){var n=this.contents[t];if(n.xid==e)return t}return-1},has:function(e){return this.getIndexByXid(e)!=-1},getActiveXid:function(){return this.$active=this.$el.find(">.x-contents-content.active"),this.$active.attr("xid")},to:function(e,t){typeof e=="string"&&(e=this.getIndexByXid(e));var n=this.getActiveIndex();if(e>s(">.x-contents-content",this.$el).length-1||e<0){t&&t();return}if(this.sliding){t&&t();return}if(n==e){t&&t();if(!this._inited){var r=this.$el.find(">.x-contents-content.active");this.addRouteItem(r),this.contents[e]&&this.contents[e].fireEvent("onActive",{source:this,index:e}),this._inited=!0}return}return this.slide(e>n?"next":"prev",s(s(">.x-contents-content",this.$el)[e]),t)},next:function(e){if(this.sliding)return;return this.slide("next",null,e)},prev:function(e){if(this.sliding)return;return this.slide("prev",null,e)},slide:function(e,t,n){var r=this.$el.find(">.x-contents-content.active"),i=t||r[e](),o=e=="next"?"left":"right",u=e=="next"?"first":"last",a=this;if(!i.length){if(!this.wrap)return;i=this.$el.find(">.x-contents-content")[u]()}var f=i.parent().children().index(i),l=r.parent().children().index(r);this.sliding=!0;var c=s.Event("slide.container",{relatedTarget:i[0],direction:o});this.fireEvent("onActiveChange",{source:this,to:f,from:l,type:e}),l>=0&&this.contents[l]&&this.contents[l].fireEvent&&this.contents[l].fireEvent("onInactive",{source:this,index:l});if(i.hasClass("active"))return;if(l!=-1&&this._inited&&this.slidable&&s.support.transition){this.$el.trigger(c);if(c.isDefaultPrevented())return;o=="right"?(r.animationEnd(function(){i.addClass("active").removeClass("x-left-to-center"),r.addClass("x-content-on-right").removeClass("active x-center-to-right"),a.sliding=!1,a.active=f,a.getModel().fireEvent("reflow",i.get(0)),setTimeout(function(){a.$el.trigger("slide.container"),a.getModel().fireEvent("onResize",{source:this}),a.addRouteItem(i),a.fireEvent("onActiveChanged",{source:this,to:f,from:l,type:e}),n&&n(),a.contents[f]&&a.contents[f].fireEvent&&a.contents[f].fireEvent("onActive",{source:a,index:f})},0)}),i.addClass("x-left-to-center").removeClass("x-content-on-right x-content-on-left"),r.addClass("x-center-to-right")):(r.animationEnd(function(){i.addClass("active").removeClass("x-right-to-center"),r.addClass("x-content-on-left").removeClass("active x-center-to-left"),a.sliding=!1,a.active=f,a.getModel().fireEvent("reflow",i.get(0)),setTimeout(function(){a.$el.trigger("slide.container"),a.getModel().fireEvent("onResize",{source:this}),a.addRouteItem(i),a.fireEvent("onActiveChanged",{source:this,to:f,from:l,type:e}),n&&n(),a.contents[f]&&a.contents[f].fireEvent&&a.contents[f].fireEvent("onActive",{source:a,index:f})},0)}),i.addClass("x-right-to-center").removeClass("x-content-on-right x-content-on-left"),r.addClass("x-center-to-left"))}else{this.$el.trigger(c);if(c.isDefaultPrevented())return;o=="right"?r.addClass("x-content-on-right").removeClass("active"):r.addClass("x-content-on-left").removeClass("active"),i.removeClass("x-content-on-left x-content-on-right").addClass("active"),this.sliding=!1,a.active=f,this.$el.trigger("slide.container"),this.getModel().fireEvent("onResize",{source:this}),a.addRouteItem(i),this.fireEvent("onActiveChanged",{source:this,to:f,from:l,type:e}),n&&n(),a.contents[f]&&a.contents[f].fireEvent&&a.contents[f].fireEvent("onActive",{source:a,index:f}),this._inited=!0,this.getModel().fireEvent("reflow",i.get(0))}return this},add:function(e){return e||(e={}),e.owner=this,e.parentNode=this.$el.get(0),new u(e)},remove:function(e,r){e===undefined&&(e=this.active),typeof e=="string"&&(e=this.getIndexByXid(e)),typeof r=="string"&&(r=this.getIndexByXid(r));var i=this.getLength();if(i>0){var s=this;this.to(r||0,function(){var r=s.contents[e];n.Array.remove(s.contents,r),t.removeComponent(r)})}else{var o=this.contents[e];n.Array.remove(this.contents,o),t.removeComponent(o),delete this.active}},removeOther:function(){var e=this.contents[this.active];for(var n=0;n<this.contents.length;n++){if(n==this.active)continue;var r=this.contents[n];t.removeComponent(r)}this.contents=[e],this.active=0},removeAll:function(){for(var e=0;e<this.contents.length;e++){var n=this.contents[e];t.removeComponent(n)}this.contents=[],this.active=-1},getLength:function(){return s(">.x-contents-content",this.$el).length},propertyChangedHandler:function(e,t,n){switch(e){case"slidable":typeof n=="string"&&(n=n=="true"),this.slidable=!!n,this.slidable&&s(this.domNode).addClass("slidable")}},getContent:function(e){for(var t=0;t<this.contents.length;t++)if(this.contents[t].xid==e)return this.contents[t]},dispose:function(){this.intervaler&&clearInterval(this.intervaler);for(var e=this.contents.length-1;e>=0;e--)t.removeComponent(this.contents[e]);this.contents=null}});return n.Component.addOperations(l,{to:{label:"",argsDef:[{name:"xid",displayName:"切换的content xid"}],method:function(e){return this.owner.to(e.xid)}},next:{label:"",argsDef:[],method:function(){return this.owner.next()}},prev:{label:"",argsDef:[],method:function(){return this.owner.prev()}}}),t.register(o,l),l}),define("$model/UI2/system/components/justep/controlGroup/controlGroup.config",["require"],function(e){return{properties:{title:"string",collapsible:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/controlGroup/controlGroup",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./controlGroup.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./controlGroup"),r=e("./controlGroup.config"),i=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.title="",this.collapsible=!1,this._isCollapsed=!1,this.callParent(e)},dispose:function(){this.callParent()},doInit:function(e,t){this.callParent(e,t),this.title||this._getTitleNode().hide();var n=this;this._getTitleNode().on("click",function(e){n.collapsible&&(n._isCollapsed?n.expand():n.collapse())})},collapse:function(){this.$domNode.addClass("x-collapsed").children(":not(.x-control-group-title)").slideUp("fast"),this._isCollapsed=!0},expand:function(){this.$domNode.removeClass("x-collapsed").children(":not(.x-control-group-title)").slideDown("fast"),this._isCollapsed=!1},propertyChangedHandler:function(e,t,n){switch(e){case"title":if(t!==n){var r=n?"show":"hide",i=this._getTitleNode(),s=i.children("span");s.length>0?s.text(n):i.text(n),i[r]()}break;default:this.callParent(e,t,n)}},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-control-group"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+n+"' "+" >"+"<div class='x-control-group-title'><span>"+(e.title?e.title:"")+"</span></div>"+"</div>"},_getTitleNode:function(){return this.$domNode.find("div.x-control-group-title:first")}});return t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/dialog/dialog.config",["require"],function(e){return{properties:{showTitle:"boolean",title:"string",status:"string",width:"string",height:"string",top:"string",left:"string",routable:"boolean",resizable:"boolean"},events:["onOpen","onClose"],binds:{}}}),define("$model/UI2/system/components/justep/dialog/dialog",["require","$UI/system/components/justep/common/res","css!./css/dialog","jquery","$UI/system/lib/justep","./dialog.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/dialog").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./dialog"),i=e("./dialog.config"),s=n.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.showTitle=!1,this.title="",this.status="maximize",this.opened=!1,this.width="80%",this.height="80%",this.resizable=!1,this.top=null,this.left=null,this.routable=!1},dispose:function(){t(window).off("resize",this.__resizeHandle),this.callParent()},doInit:function(e,n){this._createResizeBar();var r=this;this.$domNode.on("mousewheel",function(e){r.opened&&e.stopPropagation()}),this._getTitleNode().mousedown(function(e){r._dragStart(e)}),this.__dragMoveHandle=t.proxy(this._dragMove,this),this.__dragEndHandle=t.proxy(this._dragEnd,this),this.__closeHandle=t.proxy(this.close,this),this.__resizeHandle=t.proxy(this.doResize,this),this.$domNode.mousemove(this.__dragMoveHandle).mouseup(this.__dragEndHandle).find(".x-dialog-title:first > button.close").on("click",this.__closeHandle),t(window).on("resize",this.__resizeHandle)},_createResizeBar:function(){var e=this._getDialogNode();e.append('<div class="x-resizeBar x-resizeBar-right"/><div class="x-resizeBar x-resizeBar-bottom"/>');var n=this;e.children(".x-resizeBar")[this.resizable?"removeClass":"addClass"]("hide").mousedown(function(e){n._resizeStart(e)}),this.__resizeMoveHandle=t.proxy(this._resizeMove,this),this.__resizeEndHandle=t.proxy(this._resizeEnd,this),this.$domNode.mousemove(this.__resizeMoveHandle).mouseup(this.__resizeEndHandle)},_resizeStart:function(e){var n=e.target,r=t(n);r.is(".x-resizeBar-right")?(this._resizing=!0,this.$domNode.addClass("x-dialog-resize-v"),this._createDragContext(e),this._dragContext.resizeType="right"):r.is(".x-resizeBar-bottom")&&(this._resizing=!0,this.$domNode.addClass("x-dialog-resize-h"),this._createDragContext(e),this._dragContext.resizeType="bottom")},_createDragContext:function(e){var t=this._getDialogNode();this._dragContext={onselectstart:document.onselectstart,x:e.clientX,y:e.clientY,dlg:t.offset(),height:t.innerHeight(),width:t.innerWidth()},document.onselectstart=function(){return!1}},_clsDragContext:function(){this._dragContext&&t.isFunction(this._dragContext.onselectstart)&&(document.onselectstart=this._dragContext.onselectstart),this._dragContext=null},_resizeMove:function(e){if(this._resizing&&this.resizable&&this._dragContext){var t,n;this._dragContext.resizeType=="bottom"?(t=e.clientY-this._dragContext.y+this._dragContext.height,n="height"):(t=e.clientX-this._dragContext.x+this._dragContext.width,n="width"),this._getDialogNode().css(n,t),this._resized=!0}},_resizeEnd:function(e){this.$domNode.removeClass("x-dialog-resize-h").removeClass("x-dialog-resize-v"),this._resizing=!1,this._clsDragContext()},_dragStart:function(e){var n=e.target;t(n).is("button.close")||(this.$domNode.addClass("x-dialog-drag"),this._moving=!0,this._createDragContext(e))},_dragMove:function(e){if(this._moving&&this._dragContext){var t=e.clientX-this._dragContext.x+this._dragContext.dlg.left,n=e.clientY-this._dragContext.y+this._dragContext.dlg.top;this._getDialogNode().offset({top:n,left:t}),this._moved=!0}},_dragEnd:function(e){this.$domNode.removeClass("x-dialog-drag"),this._moving=!1,this._clsDragContext()},doRoute:function(e,t,n){if(!this.routable)return;e===""&&(n=="enter"?this.open():n=="leave"&&this.close())},addRouteItem:function(e){if(!this.routable)return;var t=this.getModel().$routeState,n=this.$domNode.attr("xid");e=="open"?(t.addState(n,"",""),t.publishState()):e=="close"&&(t.removeState(n,"",""),t.publishState())},doResize:function(){this.opened&&this.render()},buildTemplate:function(e){e||(e={});var i=e.xid||n.UUID.createUUID();return this.set(e),t('<span xid="'+i+'" component="'+r+'">'+'<div class="x-dialog-overlay">'+"</div>"+'<div class="x-dialog" style="display:none;" showTitle="'+!!e.showTitle+'">'+'<div class="x-dialog-title">'+'<button type="button" class="close"><span>×</span></button>'+'<h4 class="x-dialog-title-text">'+(e.title?e.title:"")+"</h4>"+"</div>"+'<div class="x-dialog-body">'+(e.content?e.content:"")+"</div>"+"</div>"+"</span>")},propertyChangedHandler:function(e,t,n){switch(e){case"showTitle":this._inited&&this._getDialogNode()[n?"attr":"removeAttr"]("showTitle","true");break;case"title":t!=n&&this._inited&&this._getTitleTextNode().text(n);break;case"resizable":t!=n&&this._inited&&this._getDialogNode().children(".children")[n?"removeClass":"addClass"]("hide");break;case"status":case"width":case"height":t!=n&&(this.needRender=this._inited);break;default:this.callParent(e,t,n)}},_getDialogNode:function(){return this.$domNode.find("div.x-dialog:first")},_getOverlayNode:function(){return this.$domNode.find("div.x-dialog-overlay:first")},_getTitleTextNode:function(){return this.$domNode.find(".x-dialog-title-text:first")},_getTitleNode:function(){return this.$domNode.find(".x-dialog-title:first")},_getBodyNode:function(){return this.$domNode.find(".x-dialog-body:first")},close:function(){this._getDialogNode().removeClass("x-dialog-in").hide(),this._getOverlayNode().removeClass("x-dialog-overlay-visible"),t("body").removeClass("x-dialog-body-overflow-hidden"),this.opened=!1,this.fireEvent("onClose",{source:this}),this.addRouteItem("close")},setContent:function(e){this._getBodyNode().html(e)},render:function(){this.callParent();var e=t(window),n={height:e.height(),width:e.width()},r={height:this.height,width:this.width};this._getOverlayNode().css(n);if(!this._resized){var i=this._getDialogNode();this.status==="maximize"?i.css(n).removeClass("x-dialog-normal"):i.css(r).addClass("x-dialog-normal")}this.opened&&this._setDialogTopLeft()},_setDialogTopLeft:function(){if(this._moved)return;var e=t(window),n=this._getDialogNode(),r=n.outerHeight(),i=e.height(),s=n.outerWidth(),o=e.width(),u=this.top===null?r>=i?10:(i-r)/2:this.top,a=this.left===null?s>=o?0:(o-s)/2:this.left;this.status==="maximize"&&(u=0,a=0),n.css({top:u,left:a})},open:function(e){t("body").addClass("x-dialog-body-overflow-hidden");var n=this._getDialogNode();this._getOverlayNode().addClass("x-dialog-overlay-visible"),this.render(),n.show().addClass("x-dialog-in"),this._setDialogTopLeft(),this.addRouteItem("open",e),this.opened=!0,this.fireEvent("onOpen",{source:this})}});return n.Component.addOperations(s,{open:{label:"",method:function(e){return this.owner.open()}},close:{label:"",method:function(e){return this.owner.close()}}}),n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/input/js/datePicker",["require","jquery","$UI/system/lib/justep","$UI/system/resources/system.res","css!../css/datePicker"],function(e){function r(e,r,i){var f=this,l,c,h,p=!1;this.settings=i,this.values=null,this.val=null,this.temp=null,this.setDefaults=function(e){t.extend(S,e)},this.formatDate=function(e,t,r){return t?n.Date.toString(t,e):null},this.parseDate=function(e,t,r){var i=new Date;return!e||!t?i:n.Date.fromString(t,e)},this.setValue=function(n){n===undefined&&(n=!0);var r=this.formatResult();this.val=r,this.values=this.temp.slice(0),n&&t(e).is("input")&&t(e).val(r).change()},this.getDate=function(){var e=this.values,t=this.settings,n;if(t.preset=="date")return new Date(e[l],e[c],e[h]);if(t.preset=="time")return n=t.ampm&&e[t.seconds?3:2]=="PM"&&e[0]-0<12?e[0]-0+12:e[0],new Date(1970,0,1,n,e[1],t.seconds?e[2]:null);if(t.preset=="datetime")return n=t.ampm&&e[t.seconds?6:5]=="PM"&&e[3]-0<12?e[3]-0+12:e[3],new Date(e[l],e[c],e[h],n,e[4],t.seconds?e[5]:null)},this.setDate=function(e,t){var n=this.settings,r;n.preset.match(/date/i)&&(this.temp[l]=e.getFullYear(),this.temp[c]=e.getMonth(),this.temp[h]=e.getDate()),n.preset=="time"&&(r=e.getHours(),this.temp[0]=n.ampm?r>12?r-12:r===0?12:r:r,this.temp[1]=e.getMinutes(),n.seconds&&(this.temp[2]=e.getSeconds()),n.ampm&&(this.temp[n.seconds?3:2]=r>11?"PM":"AM")),n.preset=="datetime"&&(r=e.getHours(),this.temp[3]=n.ampm?r>12?r-12:r===0?12:r:r,this.temp[4]=e.getMinutes(),n.seconds&&(this.temp[2]=e.getSeconds()),n.ampm&&(this.temp[n.seconds?6:5]=r>11?"PM":"AM")),this.setValue(t)},this.parseValue=function(e){var t=this.settings;if(this.preset){var r=[],i,s;if(t.preset=="date"){try{i=this.parseDate(t.dateFormat,e,t)}catch(o){i=new Date}r[l]=i.getFullYear(),r[c]=i.getMonth(),r[h]=i.getDate()}else if(t.preset=="time"){try{i=this.parseDate(t.timeFormat,e,t)}catch(o){i=new Date}s=i.getHours(),r[0]=t.ampm?s>12?s-12:s===0?12:s:s,r[1]=i.getMinutes(),t.seconds&&(r[2]=i.getSeconds()),t.ampm&&(r[t.seconds?3:2]=s>11?"PM":"AM")}else if(t.preset=="datetime"){try{i=this.parseDate(n.Date.STANDART_FORMAT,e,t)}catch(o){i=new Date}s=i.getHours(),r[l]=i.getFullYear(),r[c]=i.getMonth(),r[h]=i.getDate(),r[3]=t.ampm?s>12?s-12:s===0?12:s:s,r[4]=i.getMinutes(),t.seconds&&(r[5]=i.getSeconds()),t.ampm&&(r[t.seconds?6:5]=s>11?"PM":"AM")}return r}return t.parseValue(e)},this.formatResult=function(){var e=this.settings,t=this.temp,n;if(this.preset){if(e.preset=="date")return this.formatDate(e.format,new Date(t[l],t[c],t[h]),e);if(e.preset=="datetime")return n=e.ampm?t[e.seconds?6:5]=="PM"&&t[3]-0<12?t[3]-0+12:t[e.seconds?6:5]=="AM"&&t[3]==12?0:t[3]:t[3],this.formatDate(e.format,new Date(t[l],t[c],t[h],n,t[4],e.seconds?t[5]:null),e);if(e.preset=="time")return n=e.ampm?t[e.seconds?3:2]=="PM"&&t[0]-0<12?t[0]-0+12:t[e.seconds?3:2]=="AM"&&t[0]==12?0:t[0]:t[0],this.formatDate(e.format,new Date(1970,0,1,n,t[1],e.seconds?t[2]:null),e)}return e.formatResult(t)},this.formatDisplayResult=function(){var e=this.settings,t=this.temp,n;if(this.preset){if(e.preset=="date")return this.formatDate(e.dispalyFormat,new Date(t[l],t[c],t[h]),e);if(e.preset=="datetime")return n=e.ampm?t[e.seconds?6:5]=="PM"&&t[3]-0<12?t[3]-0+12:t[e.seconds?6:5]=="AM"&&t[3]==12?0:t[3]:t[3],this.formatDate(e.dispalyFormat,new Date(t[l],t[c],t[h],n,t[4],e.seconds?t[5]:null),e);if(e.preset=="time")return n=e.ampm?t[e.seconds?3:2]=="PM"&&t[0]-0<12?t[0]-0+12:t[e.seconds?3:2]=="AM"&&t[0]==12?0:t[0]:t[0],this.formatDate(e.dispalyFormat,new Date(1970,0,1,n,t[1],e.seconds?t[2]:null),e)}return e.formatResult(t)},this._validate=function(){var e=this.settings;if(e.startDate||e.endDate){var t=e.startDate?e.startDate.getFullYear():0,n=e.startDate?e.startDate.getMonth():0,i=e.startDate?e.startDate.getDate():1,s=e.endDate?e.endDate.getFullYear():0,o=e.endDate?e.endDate.getMonth():11,u=e.endDate?e.endDate.getDate():31;t==this.temp[l]||s==this.temp[l]?(this._caclRange(r,c,t==this.temp[l]?n:0,s==this.temp[l]?o:11,e.fx),n==this.temp[c]||o==this.temp[c]?this._caclRange(r,h,n==this.temp[c]?i:1,o==this.temp[c]?u:31,e.fx,!0):this._caclRange(r,h,1,31,e.fx,!0)):(this._caclRange(r,c,0,11,e.fx),this._caclRange(r,h,1,31,e.fx,!0))}},this._caclRange=function(e,n,r,i,s,o){var u=t("ul:eq("+n+")",e);t("li",u).show(),t("li:lt("+(r-(o?1:0))+")",u).hide(),t("li:gt("+(i-(o?1:0))+")",u).hide(),this.temp[n]<r?(this.temp[n]=r,this._caclPos(u,this.temp[n]-r,s)):r>=0&&this.temp[n]>=r&&this._caclPos(u,this.temp[n]-r,s),this.temp[n]>i?(this.temp[n]=i,this._caclPos(u,this.temp[n]-r,s)):this.temp[n]<=i&&this._caclPos(u,this.temp[n]-r,s)},this._caclPos=function(e,t,n){n?e.animate({top:o*(u-t-1)+"px"},"fast"):e.css({top:o*(u-t-1)})},this.validate=function(e){var n=this.settings;if(this.preset&&n.preset.match(/date/i)&&(e==l||e==c)){var i=32-(new Date(this.temp[l],this.temp[c],32)).getDate()-1,s=t("ul:eq("+h+")",r);t("li",s).show(),t("li:gt("+i+")",s).hide(),this.temp[h]>i&&(this._caclPos(s,i,n.fx),this.temp[h]=t("li:visible:eq("+i+")",s).data("val"))}else x.validate(e);this._validate()},this.hide=function(){n.Util.enableTouchMove(document.body),this.settings.onClose(this.val,this),t(e).blur(),r.hide(),s.hide(),p=!1,this.preset&&(this.settings.wheels=null),t(window).unbind("resize.dw")},this.show=function(){n.Util.disableTouchMove(document.body);var i,d=this.settings;d.beforeShow(e,this),o=d.height,u=Math.round(d.rows/2),a=this,this.init();if(this.values!==null)this.temp=this.values.slice(0);else{var v=n.Component.getComponent(e),m=v.val?v.val():"",g=n.Date.fromString(m,n.Date.STANDART_FORMAT_SHOT);d.startDate&&d.startDate>g&&(m=n.Date.toString(d.startDate,n.Date.STANDART_FORMAT_SHOT)),d.endDate&&d.endDate<g&&(m=n.Date.toString(d.endDate,n.Date.STANDART_FORMAT_SHOT)),this.temp=this.parseValue(m),this.setValue(!1)}var y=parseInt(this.temp[0],10);d.startYear=y-20,d.startDate&&d.startDate.getFullYear()>d.startYear&&(d.startYear=d.startDate.getFullYear()),d.endYear=y+20,d.endDate&&d.endDate.getFullYear()<d.endYear&&(d.endYear=d.endDate.getFullYear());if(this.preset){d.wheels=[];var b={};if(d.preset.match(/date/i)){for(var w=0;w<3;w++)if(w==l){b[d.yearText]={};for(i=d.startYear;i<=d.endYear;i++)b[d.yearText][i]=d.dateOrder.search(/yy/i)<0?i.toString().substr(2,2):i.toString()}else if(w==c){b[d.monthText]={};for(i=0;i<12;i++)b[d.monthText][i]=d.dateOrder.search(/MM/)<0?d.dateOrder.search(/M/)<0?d.dateOrder.search(/mm/)<0?i+1:i<9?"0"+(i+1):i+1:d.monthNamesShort[i]:d.monthNames[i]}else if(w==h){b[d.dayText]={};for(i=1;i<32;i++)b[d.dayText][i]=d.dateOrder.search(/dd/i)<0?i:i<10?"0"+i:i}d.wheels.push(b)}if(d.preset.match(/time/i)){d.stepHour=d.stepHour<1?1:parseInt(d.stepHour,10),d.stepMinute=d.stepMinute<1?1:parseInt(d.stepMinute,10),d.stepSecond=d.stepSecond<1?1:parseInt(d.stepSecond,10),b={},b[d.hourText]={};for(i=0;i<(d.ampm?13:24);i+=d.stepHour)b[d.hourText][i]=i<10?"0"+i:i;b[d.minuteText]={};for(i=0;i<60;i+=d.stepMinute)b[d.minuteText][i]=i<10?"0"+i:i;if(d.seconds){b[d.secText]={};for(i=0;i<60;i+=d.stepSecond)b[d.secText][i]=i<10?"0"+i:i}d.ampm&&(b[d.ampmText]={},b[d.ampmText].AM="AM",b[d.ampmText].PM="PM"),d.wheels.push(b)}}t(".dwc",r).remove();for(i=0;i<d.wheels.length;i++){var S=t('<div class="dwc '+(d.showLabel?"showl":"")+'"><div class="dwwc"><div class="clear" style="clear:both;"></div></div>').insertBefore(t(".dwbc",r));for(var x in d.wheels[i]){var T=t(".dwwc .clear",S),N=t('<div class="dwwl">'+(d.showLabel?'<div class="dwl">'+x+"</div>":"")+'<div class="dww"><ul></ul><div class="dwwo"></div></div><div class="dwwol"></div></div>').insertBefore(T);for(var C in d.wheels[i][x])t('<li class="val_'+C+'">'+d.wheels[i][x][C]+"</li>").data("val",C).appendTo(t("ul",N))}}t(".dww ul",r).each(function(e){var n=t("li",this).index(t("li.val_"+f.temp[e],this));while(n<0&&--f.temp[e]>=0)n=t("li",this).index(t("li.val_"+f.temp[e],this));var r=o*(u-(n<0?0:n)-1);t(this).css("top",r)}),t(".dwv",r).html(this.formatDisplayResult()),t("#dw_set",r).addClass(d.btnClass+" btn-default").text(d.setText).unbind().bind("click",function(e){return f.setValue(),d.onSelect(f.val,a),f.hide(),E=!0,setTimeout(function(){E=!1},300),!1}),t("#dw_cls",r).addClass(d.btnClass+" btn-default").text(d.clsText).unbind().bind("click",function(n){return t(e).val("").change(),f.values=null,d.onSelect(f.val,a),f.hide(),E=!0,setTimeout(function(){E=!1},300),!1}),t("#dw_cancel",r).addClass(d.btnClass+" btn-default").text(d.cancelText).unbind().bind("click",function(e){return f.hide(),E=!0,setTimeout(function(){E=!1},300),!1}),this._validate(),s.show(),r.attr("class","dw "+d.theme).show(),p=!0,t(".dww, .dwwl",r).height(d.rows*o),t(".dww",r).each(function(){t(this).width(t(this).parent().width()<d.width?d.width:t(this).parent().width())}),t(".dww li",r).css({height:o,lineHeight:o+"px"}),t(".dwwc",r).each(function(){var e=0;t(".dwwl",this).each(function(){e+=t(this).outerWidth(!0)}),t(this).width(e)}),t(".dwc",r).each(function(){t(this).width(t(".dwwc",this).outerWidth(!0))}),this.pos(),t(window).bind("resize.dw",function(){f.pos()})},this.pos=function(){var e=0,n=0,i=t(window).width(),o=t(window).height(),u=t(window).scrollTop(),a,f;t(".dwc",r).each(function(){a=t(this).outerWidth(!0),e+=a,n=a>n?a:n}),a=e>i?n:e,r.width(a),a=r.outerWidth(),f=r.outerHeight(),r.css({left:(i-a)/2,top:u+(o-f)/2}),s.height(0),s.height(t(document).height())},this.init=function(){var e=this.settings,t=e.dateOrder.search(/y/i),n=e.dateOrder.search(/m/i),r=e.dateOrder.search(/d/i);l=t<n?t<r?0:1:t<r?1:2,c=n<t?n<r?0:1:n<r?1:2,h=r<t?r<n?0:1:r<n?1:2,this.preset=e.wheels===null},this.init(),t(e).is("input")?t(e).attr("readonly","readonly").data("readonly",t(e).attr("readonly")):!1,t(e).addClass("scroller").off("click.dw").bind("click.dw",function(n){if(E)return t(e).blur(),setTimeout(function(){t(e).removeClass("ui-focus")},50),!1;!f.settings.disabled&&f.settings.showOnFocus&&!p&&f.show()})}var t=e("jquery"),n=e("$UI/system/lib/justep");e("$UI/system/resources/system.res"),e("css!../css/datePicker").load();var i,s,o,u,a,f={},l=new Date,c=l.getTime(),h=!1,p=null,d,v,m,g="ontouchstart"in window,y=g?"touchstart":"mousedown",b=g?"touchmove":"mousemove",w=g?"touchend":"mouseup",E=!1,S={width:80,height:40,rows:3,fx:!1,disabled:!1,showOnFocus:!0,showOnTap:!0,wheels:null,theme:"",preset:"date",dateFormat:"yyyy-MM-dd",dateOrder:"yyyymmdd",ampm:!0,seconds:!1,timeFormat:"hh:mm:ss",startDate:null,endDate:null,startYear:l.getFullYear()-10,endYear:l.getFullYear()+10,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],shortYearCutoff:"+10",showLabel:!1,monthText:(new n.Message(n.Message.JUSTEP231502)).getMessage(),dayText:(new n.Message(n.Message.JUSTEP231503)).getMessage(),yearText:(new n.Message(n.Message.JUSTEP231504)).getMessage(),hourText:(new n.Message(n.Message.JUSTEP231505)).getMessage(),minuteText:(new n.Message(n.Message.JUSTEP231506)).getMessage(),secText:(new n.Message(n.Message.JUSTEP231507)).getMessage(),ampmText:"&nbsp;",setText:(new n.Message(n.Message.JUSTEP231500)).getMessage(),clsText:(new n.Message(n.Message.JUSTEP231508)).getMessage(),cancelText:(new n.Message(n.Message.JUSTEP231501)).getMessage(),btnClass:"btn btn-sm",stepHour:1,stepMinute:1,stepSecond:1,beforeShow:function(){},onClose:function(){},onSelect:function(){},formatResult:function(e){var t="";for(var n=0;n<e.length;n++)t+=(n>0?" ":"")+e[n];return t},parseValue:function(e){return e.split(" ")}},x={init:function(e){var n=t.extend({},S,e);if(t(".dwo").length)s=t(".dwo"),i=t(".dw");else{s=t('<div class="dwo"></div>').hide().appendTo("body"),i=t('<div class="dw"><div class="dwv">&nbsp;</div><div class="dwbc" style="clear:both;"><a id="dw_set" href="#"></a><a id="dw_cls" href="#"></a><a id="dw_cancel" href="#"></a></div></div>'),i.hide().appendTo("body"),t(document).bind(b,function(e){if(h)return v=g?e.originalEvent.changedTouches[0].pageY:e.pageY,p.css("top",m+v-d+"px"),e.preventDefault(),e.stopPropagation(),!1});var l=function(e,n,r){n=n>(u-1)*o?(u-1)*o:n,n=n<u*o-t("li:visible",e).length*o?u*o-t("li:visible",e).length*o:n;var s=t("ul",i).index(e);a.temp[s]=t("li:visible:eq("+(u-1-n/o)+")",e).data("val"),a.validate(s),t(".dwv",i).html(a.formatDisplayResult());if(0===s){var f,l=a.settings,c=parseInt(a.temp[s],10),h=l.wheels[0];if(r&&l.endYear-c<=5){var p=l.endYear;l.endYear=c+15,l.endDate&&l.endDate.getFullYear()<l.endYear&&(l.endYear=l.endDate.getFullYear());for(f=p+1;f<=l.endYear;f++)h[l.yearText][f]=l.dateOrder.search(/yy/i)<0?f.toString().substr(2,2):f.toString(),t('<li class="val_'+f+'">'+h[l.yearText][f]+"</li>").data("val",f).appendTo(t(e))}else if(!r&&c-l.startYear<=5){var d=l.startYear;l.startYear=c-15,l.startDate&&l.startDate.getFullYear()>l.startYear&&(l.startYear=l.startDate.getFullYear());for(f=d+1;f>=l.startYear;f--)h[l.yearText][f]=l.dateOrder.search(/yy/i)<0?f.toString().substr(2,2):f.toString(),t('<li class="val_'+f+'">'+h[l.yearText][f]+"</li>").data("val",f).prependTo(t(e)),n-=o}}a.settings.fx?e.stop(!0,!0).animate({top:n+"px"},"fast"):e.css("top",n)};t(document).bind(w,function(e){if(h){var n=Math.round((m+v-d)/o)*o;n=n>(u-1)*o?(u-1)*o:n,n=n<u*o-t("li:visible",p).length*o?u*o-t("li:visible",p).length*o:n,l(p,n,v-d<0),h=!1,p=null,e.preventDefault(),e.stopPropagation()}}),t(document).on(y,".dwwl",function(e){h||(h=!0,p=t("ul",this),m=p.css("top").replace(/px/i,"")-0,d=g?e.originalEvent.changedTouches[0].pageY:e.pageY,v=d,e.preventDefault(),e.stopPropagation())})}return this.each(function(){this.id||(c+=1,this.id="scoller"+c),f[this.id]=new r(this,i,n)})},validate:function(){},enable:function(){return this.each(function(){f[this.id]&&(f[this.id].settings.disabled=!1)})},disable:function(){return this.each(function(){f[this.id]&&(f[this.id].settings.disabled=!0)})},isDisabled:function(){if(f[this[0].id])return f[this[0].id].settings.disabled},option:function(e,n){return this.each(function(){f[this.id]&&(typeof e=="object"?t.extend(f[this.id].settings,e):f[this.id].settings[e]=n,f[this.id].init())})},setValue:function(e,t){return t===undefined&&(t=!1),this.each(function(){f[this.id]&&(f[this.id].temp=e,f[this.id].setValue(e,t))})},getValue:function(){if(f[this[0].id])return f[this[0].id].values},setDate:function(e,t){return t===undefined&&(t=!1),this.each(function(){f[this.id]&&f[this.id].setDate(e,t)})},getDate:function(){if(f[this[0].id])return f[this[0].id].getDate()},show:function(){if(f[this[0].id])return f[this[0].id].show()},hide:function(){return this.each(function(){f[this.id]&&f[this.id].hide()})},destroy:function(){return this.each(function(){f[this.id]&&(t(this).unbind("focus.dw").removeClass("scroller"),t(this).is("input")?t(this).attr("readonly",t(this).data("readonly")):!1,delete f[this.id])})}};t.fn.datePicker=function(e){if(x[e])return x[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return x.init.apply(this,arguments);t.error("Unknown method")},t.datePicker=new r(null,null,S)}),define("$model/UI2/system/components/justep/input/js/decimalFormat",["require"],function(e){var t=function(e){this.applyPattern(e)};return t.SPECIAL_CHARS=["0",".","-",",","E","%","¤","‰"],t.prototype.applyPattern=function(e){function n(e,t){for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1}e===undefined&&(e="");for(var r=0;r<e.length;r++)if(!n(t.SPECIAL_CHARS,e.charAt(r)))return;this.pattern=e},t.prototype.format=function(e){if(isNaN(e))return e;var t=this.pattern;if(!t)return e;var n=""+e,r=parseFloat(e),i=!1;r<0&&(i=!0),i&&(n=n.substring(1,n.length),r=-r);var s=t.indexOf("%"),o=t.indexOf(",");if(s!=-1||o!=-1&&s!=-1)return e;var u,a,f,l;if(s!=-1){if(s!=t.length-1)return e;t=t.substring(0,t.length-1),r=parseFloat(e)*100,n=""+r,i&&(n=n.substring(1,n.length),r=-r)}u=t.indexOf("."),a=n.indexOf(".");var c="";u!=-1?(a==-1&&(a=n.length-1),f=t.length-u,l=parseFloat(n).toFixed(f-1),i?c="-"+l:c=l):(a==-1&&(a=n.length-1),l=parseFloat(n).toFixed(),i?c="-"+l:c=l),s!=-1&&(c+="%");var h="",p=0;if(o!=-1&&c.length){u=c.indexOf(".");for(var d=c.length-1;d>=0;d--){var v=c.charAt(d);u!=-1&&d>=u?h=v+h:(p==3&&v!="-"?(p=1,h=","+h):p++,h=v+h)}c=h}return c},t}),define("$model/UI2/system/components/justep/input/input.config",["require"],function(e){return{properties:{dataType:"string",placeHolder:"string",pattern:"string",format:"string",min:"string",max:"string",maxLength:"integer",autoFocus:"boolean",autoComplete:"boolean",disabled:"boolean",readonly:"boolean"},events:["onChange","onRender"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/input/input",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./js/datePicker","./js/decimalFormat","./input.config"],function(require){require("$UI/system/components/justep/common/res");var $=require("jquery"),justep=require("$UI/system/lib/justep");require("./js/datePicker");var DecimalFormat=require("./js/decimalFormat"),url=require.normalizeName("./input"),ComponentConfig=require("./input.config"),TypeRegExp={Integer:/(^-?$)|(^-?[0-9]*$)/,Long:/(^-?$)|(^-?[0-9]*$)/,Decimal:/(^-?$)|(^-?[0-9]*([.]?[0-9]*)?$)/,Float:/(^-?$)|(^-?[0-9]*([.]?[0-9]*)?$)/,Double:/(^-?$)|(^-?[0-9]*([.]?[0-9]*)?$)/},getAfterPressText=function(e,t){var n=e,r,i,s,o;if(justep.Browser.IE&&!justep.Browser.IE11){var u=document.selection.createRange();i=u.text,s=n.createTextRange(),r=s.text,u.setEndPoint("StartToStart",s),o=u.text}else i=window.getSelection().toString(),"number"!=$(n).attr("type")?s=n.selectionEnd:s=n.value.length,r=n.value,o=n.value.substring(0,s);var a=t,f=r.substr(o.length),l=o.substr(0,o.length-i.length)+a+f;return l},Input=justep.BindComponent.extend({getConfig:function(){return ComponentConfig},constructor:function(e){this.callParent(e),this.readonly=!1,this.placeHolder="",this.value="",this.format="",this.pattern="",this.autoFocus=!1,this.autoComplete=!1,this.min=null,this.max=null,this.minLength=1,this.maxLength=null,this.dataType="String"},dispose:function(){this.$domNode.off("change focus blur keypress paste"),this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+url+"' "+" ></input>"},_doDataTypeChange:function(){if(justep.Bind.isObservable(this.ref)&&this.ref.define){var e=this.ref.define.defCol,t=e.type,n=e.size,r={},i=!1;t!==this.dataType&&(r.dataType=t,i=!0),n&&(r.maxLength=n,i=!0),i&&this.set(r)}},_bindDataType:function(){if(this.dataType=="DateTime"||this.dataType=="Date"||this.dataType=="Time"){this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss"));var e=this,t=this.dataType.toLowerCase(),n=justep.Date.STANDART_FORMAT;t=="date"?n=justep.Date.STANDART_FORMAT_SHOT:t=="time"&&(n="hh:mm:ss"),this.$domNode.addClass(t).attr("readonly",!0);if(justep.Browser.isMobile)this.$domNode.datePicker({preset:t,seconds:!0,ampm:!1,format:n,dispalyFormat:this.format,beforeShow:function(t,n){e.min&&(n.settings.startDate=e._doCalcDateExpr(e.min)),e.max&&(n.settings.endDate=e._doCalcDateExpr(e.max))}});else{var r=this;this.$domNode.on("click",function(){require(["./js/datePickerPC"],function(e){(r.dataType=="DateTime"||r.dataType=="Date"||r.dataType=="Time")&&e.show(r,t==="date"?0:t==="time"?4:3,!0)})})}}else this.dataType&&this.$domNode.addClass(this.dataType.toLowerCase())},_updateType:function(){var e=this.$domNode.attr("type");e!="email"&&e!="url"&&e!="password"&&e!="range"&&e!="search"&&e!="color"&&(this.dataType=="Integer"||this.dataType=="Long"||this.dataType=="Decimal"||this.dataType=="Float"||this.dataType=="Double"?this.$domNode.attr("type",justep.Browser.isMobile?"number":"tel"):this.$domNode.attr("type","text"))},_restoreType:function(){var e=this.$domNode.attr("type");(e=="number"||e=="tel")&&this.$domNode.attr("type","text")},_unbindDataType:function(e){this.$domNode&&(this.$domNode.removeClass((""+e).toLowerCase()),(e=="DateTime"||e=="Date"||e=="Time")&&this.$domNode.attr("readonly",this.readonly).datePicker("destroy"))},_doCalcDateExpr:function(e){var t=this._doCalcExpr(e);justep.Bind.isObservable(t)&&(t=t.get());if(t instanceof Date)return t;if("string"==typeof t)return justep.Date.fromString(t,justep.Date.STANDART_FORMAT_SHOT);var n=new justep.Message(justep.Message.JUSTEP231090);throw justep.Error.create(n)},_doCalcExpr:function(e){this._expr=this._expr||{},this._expr[e]||(this._expr[e]=new justep.Express(e));var t=justep.Bind.contextFor(this.domNode);return justep.Express.eval(this._expr[e],t.$object,t)},doInit:function(e,t){var n=this;this.$domNode.on("change",$.proxy(this.doChange,this)).on("focus",function(){n._focusin=!0,n._updateType(),!n.$domNode.prop("readonly")&&n.value!=n.$domNode.val()&&n.$domNode.val(n.value),!n._refocus&&justep.Browser.isIOS&&!justep.Browser.isX5App&&window.setTimeout(function(){n._refocus=!0,n.$domNode.blur().focus()},1),n._refocus=!1}).on("blur",function(){n._focusin=!1,n._refocus||n._restoreType(),n.render()}).on("keypress paste",function(e){return n._doKeypress(e)}),this._bindDataType()},isDisabled:function(){return this.readonly||this.callParent()},_doKeypress:function(evt){if(13===evt.keyCode){justep.Browser.IE>=9&&this.doChange(evt);return}var regExp=TypeRegExp[this.dataType],ok,keyCode,afterPressText;if(justep.Browser.FF&&(evt.key!=="MozPrintableKey"||evt.key==="MozPrintableKey"&&evt.ctrlKey))return;var cbd=window.clipboardData||evt.clipboardData||evt.originalEvent.clipboardData;evt.type==="paste"&&cbd?keyCode=cbd.getData("text"):keyCode=String.fromCharCode(justep.Browser.FF?evt.which:evt.keyCode);if(regExp||this.pattern)afterPressText=getAfterPressText(this.domNode,keyCode);regExp&&(ok=regExp.test(afterPressText));if((ok||ok===undefined)&&this.pattern)try{regExp=eval("/"+this.pattern+"/"),regExp&&(ok=regExp.test(afterPressText))}catch(e){}return evt.returnValue=ok,!justep.Browser.FF&&!evt.returnValue&&(evt.keyCode=0),evt.returnValue},doUpdate:function(e,t,n){this._doDataTypeChange(),this.callParent(e,t,n)},propertyChangedHandler:function(e,t,n){switch(e){case"format":this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss")),t!=n&&(this.needRender=this._inited);break;case"value":t!=n&&this._inited&&(this.fireEvent("onChange",{source:this,originalValue:t,value:n}),this.val2ref()),this.needRender=this._inited&&!this._focusin;break;case"dataType":t!=n&&(this.needRender=this._inited,this._dataTypeChanged=!0,this._unbindDataType(t));break;default:this.callParent(e,t,n)}},render:function(){this.callParent(),this._dataTypeChanged&&(this._bindDataType(),this._dataTypeChanged=!1);var e=this.value,t;e&&("DateTime"==this.dataType?(t=e instanceof Date?e:justep.Date.fromString(e,justep.Date.STANDART_FORMAT),e=justep.Date.toString(t,this.format)):"Date"==this.dataType?(t=e instanceof Date?e:justep.Date.fromString(e,justep.Date.STANDART_FORMAT_SHOT),e=justep.Date.toString(t,this.format)):"Time"==this.dataType?(t=e instanceof Date?e:justep.Date.fromString(e,"hh:mm:ss"),e=justep.Date.toString(t,this.format)):this.format&&("Integer"==this.dataType||"Long"==this.dataType||"Float"==this.dataType||"Double"==this.dataType||"Decimal"==this.dataType)&&(e=(new DecimalFormat(this.format)).format(e)));if(e===undefined||e===null)e="";var n={source:this,value:this.value,text:e};this.fireEvent("onRender",n),this.$domNode.val(n.text)},val:function(e){if(arguments.length===0)return this.value;this.set({value:e})},doChange:function(e){this.set({value:this.$domNode.val()})},clear:function(){this.set({value:null})}});return justep.Component.register(url,Input),Input}),define("$model/UI2/system/components/justep/input/password.config",["require"],function(e){return{properties:{data:"string",relation:"string",placeHolder:"string",disabled:"boolean"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/input/password",["require","$UI/system/lib/justep","./input","./password.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./input"),r=e.normalizeName("./password"),i=e("./password.config"),s=n.extend({getConfig:function(){return i},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' type='password'"+" ></input>"}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/input/range.config",["require"],function(e){return{properties:{data:"string",relation:"string",min:"number",max:"number",disabled:"boolean"},events:["onChange","onRender"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/input/range",["require","$UI/system/lib/justep","./input","./range.config"],function(e){var t=e("$UI/system/lib/justep"),n=e("./input"),r=e.normalizeName("./range"),i=e("./range.config"),s=n.extend({constructor:function(e){this.callParent(e),this.min=0,this.max=100},getConfig:function(){return i},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]=""),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' type='range'"+" ></input>"}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/input/js/datePickerPC",["require","jquery","$UI/system/lib/justep","$UI/system/resources/system.res","css!../css/datePickerPC"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep");e("$UI/system/resources/system.res"),e("css!../css/datePickerPC").load();var r=n.Object.extend({constructor:function(e,r,i,s,o,u,a,f){var l=this;this.element=t("body").append("<ul/>").children().last().addClass(r).get(0),this.move=0,this.input=i,n.Browser.hasTouch&&(this.input.readOnly=!0),this.min=s,this.max=o,this.minlength=u||1,t(i).bind("keypress",function(e){l.hide();if(e.keyCode<48||e.keyCode>57){e.returnValue=!1;return}}).bind("paste",function(e){e.returnValue=!1}).bind("click",function(e){l.show(),i.select()}).bind("change",function(e){var n=parseInt(t(i).val());n<l.min&&t(i).val(l.min),n>l.max&&t(i).val(l.max)}),this.setParam(s,o,u,a,f)},setParam:function(e,n,r,i,s){t(this.element).empty();var o=this;this.min=e,this.max=n,i=i||7,this.canShowAll=this.max-this.min+1<=i,this.canShowAll||this.createChild("-",function(){o.isFocus=!0,o.start(-1)},function(){o.isFocus=!1,o.stop(),t(o.input).focus()}),this.showItem=i,this.canShowAll&&(this.showItem=this.max-this.min+1);var u=function(e){o.isFocus=!0},a=function(e){var n=t(e.target).text(),r=t(o.input).val(n);o.input.readOnly||r.focus(),o.isFocus=!1,o.hide(),t(o.input).change(),s&&s(n)};for(var f=0;f<this.showItem;f++)this.createChild(" ",u,a);this.canShowAll||this.createChild("+",function(){o.isFocus=!0,o.start(1)},function(){o.isFocus=!1,o.stop(),t(o.input).focus()}),this.hide()},hideEvent:function(e){var t=e.target||e.srcElement,n=r.activeObj;n&&t.parentElement!=n.element&&n.hide()},show:function(){var e=this.input;this.current=parseInt(e.value||this.min),this.refresh();var n=t(e),i=t(this.element);i.css({top:-3e3,left:-3e3}).show();var s=n.offset(),o=s.top-i.outerHeight(!0),u=t(document).height()<s.top+n.outerHeight(!0)+i.outerHeight(!0)&&o>0;i.css({top:u?s.top-i.outerHeight(!0):s.top+n.outerHeight(!0),left:s.left}),r.activeObj=this,t("body").bind("mousedown touchstart",this.hideEvent)},hide:function(){t("body").unbind("mousedown touchstart",this.hideEvent),r.activeObj=null,t(this.element).hide()},createChild:function(e,n,i){var s=t(this.element).append("<li/>").children().last().get(0);t(s).text(e),r.initHover(s),i?(t(s).bind("mousedown",n),t(s).bind("mouseup",i)):t(s).bind("click",n)},refresh:function(){var e=t(this.element).children(),n,r,i;if(this.canShowAll){n=this.min;var s=function(e,t){this.element.scrollTop=e.outerHeight()*(t-3)};for(r=0;r<=this.max-this.min;r++){t(e.get(r)).removeClass("hover"),i=n++ +"";for(;i.length<this.minlength;i="0"+i);t(e.get(r)).text(i);if(n==this.current&&r>3){var o=t(e.get(r)),u=r;window.setTimeout(s.bind(this,o,u),10)}}}else{var a=parseInt(this.showItem/2),f=this.current;f>=this.max-a?f=this.max-a:f<=this.min+a&&(f=this.min+a),n=f-a-1;for(r=1;r<this.showItem+1;r++){t(e.get(r)).removeClass("hover"),i=n+r+"";for(;i.length<this.minlength;i="0"+i);t(e.get(r)).text(i)}}},start:function(e){this.move=e,r.current=this,this.run()},stop:function(){this.move=0},run:function(){if(this.move>0&&this.current+3<this.max||this.move<0&&this.current-3>this.min)this.current+=this.move,this.refresh(),setTimeout(function(){r.current.run()},60)}});r.current=null,r.initHover=function(e){t(e).hover(function(e){t(e.srcElement||e.target).addClass("hover")},function(e){t(e.srcElement||e.target).removeClass("hover")})};var i=n.Object.extend({constructor:function(){var e=document.getElementsByTagName("body")[0];this.element=t("table[name='_calendar_']").size()<=0?t(e).append(i.HTML()).children().last().get(0):t("table[name='_calendar_']").get(0),this.modalCover=t("div[name='_modal_cover_']").size()<=0?t(e).append("<div name='_modal_cover_' class='modalCover'/>").children().last().get(0):t("div[name='_modal_cover_']").get(0),t(e).bind("mousedown touchstart",function(e){var t=i.get(),n=t.element;if(n.style.display!="none"){var r=e.srcElement||e.target;if(r.parentElement==t.monthList.element||r.parentElement==t.yearList.element||r.parentElement==t.hourList.element||r.parentElement==t.minList.element||r.parentElement==t.secList.element)return;for(;r&&r!=n;r=r.parentNode);r||i.get().hide()}});var s=function(){var e=i.get(),r=e.inputYear.value,s=e.inputMonth.value-1,o=e.day;r<1900&&(r=1900),r>2099&&(r=2099),s<0&&(s=0),s>11&&(s=11);var u=new Date;u.setDate(1),u.setYear(r),u.setMonth(s),u.setDate(o),e.input.focus&&e.input.focus();if(e.isTimestamp){var a=e.inputHour.value,f=e.inputMin.value,l=e.inputSec.value;a>23&&(a=23),f>59&&(f=59),l>59&&(l=59),u.setMinutes(f),u.setHours(a),u.setSeconds(l);var c=e.isTime?n.Date.toString(u,n.Date.STANDART_TIME_FORMAT):n.Date.toString(u,n.Date.STANDART_FORMAT);"function"==typeof e.input.val?e.input.val(c):t(e.input).val(c)}else"function"==typeof e.input.val?e.input.val(n.Date.toString(u,n.Date.STANDART_FORMAT_SHOT)):t(e.input).val(n.Date.toString(u,n.Date.STANDART_FORMAT_SHOT));i.hide()};t(this.element).find("button[name='_calendar_prev_year_']").bind("click",function(){i.get().gotoYear(-1)}),t(this.element).find("button[name='_calendar_prev_month_']").bind("click",function(){i.get().gotoMonth(-1)}),this.inputYear=t(this.element).find("input[name='_calendar_year_']").bind("keyup",function(e){i.get().refresh(),e.keyCode==13&&s()}).bind("change",function(e){i.get().refresh()}).get(0),this.inputMonth=t(this.element).find("input[name='_calendar_month_']").bind("change",function(e){i.get().refresh()}).bind("keyup",function(e){i.get().refresh(),e.keyCode==13&&s()}).get(0),t(this.element).find("button[name='_calendar_next_year_']").bind("click",function(){i.get().gotoYear(1)}),t(this.element).find("button[name='_calendar_next_month_']").bind("click",function(){i.get().gotoMonth(1)});var o=function(e){var r=t(e.target).text(),s=i.get();if(r!==""){s.day=r;if(s.type!=i.ONLY_DATE)s.refresh();else{var o=s.inputYear.value,u=s.inputMonth.value-1,a=s.day,f=new Date;f.setDate(1),f.setYear(o),f.setMonth(u),f.setDate(a),s.input.focus&&s.input.focus();if(s.isTimestamp){f.setSeconds(s.inputSec.value),f.setMinutes(s.inputMin.value),f.setHours(s.inputHour.value);var l=s.isTime?n.Date.toString(f,n.Date.STANDART_TIME_FORMAT):n.Date.toString(f,n.Date.STANDART_FORMAT);"function"==typeof s.input.val?s.input.val(l):t(s.input).val(l)}else"function"==typeof s.input.val?s.input.val(n.Date.toString(f,n.Date.STANDART_FORMAT_SHOT)):t(s.input).val(n.Date.toString(f,n.Date.STANDART_FORMAT_SHOT));s.input.blur&&s.input.blur(),i.hide()}}};t(this.element).find(".day").each(function(){t(this).bind("click",o)}),this.inputHour=t(this.element).find("input[name='_calendar_hour_']").bind("keyup",function(e){e.keyCode==13&&s()}).get(0),this.inputMin=t(this.element).find("input[name='_calendar_min_']").bind("keyup",function(e){e.keyCode==13&&s()}).get(0),this.inputSec=t(this.element).find("input[name='_calendar_sec_']").bind("keyup",function(e){e.keyCode==13&&s()}).get(0),t(this.element).find("button[name='_calendar_ok_']").bind("click",function(){s()}),t(this.element).find("button[name='_calendar_cancel_']").bind("click",function(){i.hide()}),t(this.element).find("button[name='_calendar_clear_']").bind("click",function(){var e=i.get();"function"==typeof e.input.val?e.input.val(""):t(e.input).val(""),i.hide()});var u=n.Browser.hasTouch?"x-desktop-datePicker-list x-touch-datePicker-list":"x-desktop-datePicker-list";this.monthList=new r(t(this.inputYear).parent().get(0),u,this.inputMonth,1,12,1,12),this.yearList=new r(t(this.inputYear).parent().get(0),u,this.inputYear,1900,2099,1,n.Browser.hasTouch?200:null),this.hourList=new r(t(this.inputYear).parent().get(0),u,this.inputHour,0,23,2,n.Browser.hasTouch?24:null),this.minList=new r(t(this.inputYear).parent().get(0),u,this.inputMin,0,59,2,n.Browser.hasTouch?60:null),this.secList=new r(t(this.inputYear).parent().get(0),u,this.inputSec,0,59,2,n.Browser.hasTouch?60:null),this.hide()},today:function(){this.refreshControls(new Date)},refreshControls:function(e){this.day=e.getDate(),this.inputMonth.value=e.getMonth()+1,this.inputYear.value=e.getYear()<1e3?1900+e.getYear():e.getYear(),this.isTimestamp&&(this.inputHour.value=n.String.zeros(e.getHours(),2),this.inputMin.value=this.type>=i.MINUTES?n.String.zeros(e.getMinutes(),2):"00",this.inputSec.value=this.type>=i.SECONDS?n.String.zeros(e.getSeconds(),2):"00"),this.refresh()},hide:function(){this.monthList.hide(),this.yearList.hide(),this.hourList.hide(),this.minList.hide(),this.secList.hide(),t(this.element).hide(),t(this.modalCover).hide()},getFirstDay:function(){var e=this.inputYear.value,t=this.inputMonth.value-1;e<1900&&(e=1900),e>2099&&(e=2099),t<0&&(t=0),t>11&&(t=11);var n=new Date;return n.setDate(1),n.setMonth(t),n.setYear(e),n.getDay()},getDaysOfMonth:function(){var e=this.inputYear.value,t=this.inputMonth.value-1;return e<1900&&(e=1900),e>2099&&(e=2099),t<0&&(t=0),t>11&&(t=11),t!=1||0!==e%4||0===e%100&&0!==e%400?i.daysOfMoth[t]:29},refresh:function(){var e=new Date;this.currentDay=e.getDate(),this.currentMonth=e.getMonth(),this.currentYear=e.getFullYear();var n=this.getFirstDay(),i=this.getDaysOfMonth(),s=0,o=1,u=this.inputMonth.value-1==this.currentMonth&&this.inputYear.value==this.currentYear,a=this;t(this.element).children("tbody").children().each(function(){var e=this,f=!1;for(var l=0;l<7;l++,s++){var c=t(e.childNodes[l]);c.removeClass("hover"),u&&o==a.currentDay?c.addClass("today"):c.removeClass("today"),l===6||l===0?c.addClass("weekend"):c.removeClass("weekend");var h="";s>=n&&s<n+i?(f=!0,h=o++,r.initHover(c.get(0))):c.unbind("mouseout mouseover"),c.text(h+""),h==a.day&&!isNaN(parseInt(h))?c.addClass("selected"):c.removeClass("selected")}e.style.display=f?"":"none"})},gotoYear:function(e){var t=parseInt(this.inputYear.value)+e;t<1900&&(t=1900),t>2099&&(t=2099),this.inputYear.value=t,this.refresh()},gotoMonth:function(e){var t=parseInt(this.inputMonth.value)+e;if(t<1||t>12){var n=parseInt(this.inputYear.value)+e;n>=1900?(t=e<0?12:1,this.inputYear.value=n):t=e<0?1:12}this.inputMonth.value=t,this.refresh()}});return i.HTML=function(){return'<table name="_calendar_" class="x-desktop-datePicker '+(n.Browser.hasTouch?"x-datePicker-touch":"")+'" cellpadding="0" cellspacing="0">'+'<thead><tr valign="middle"><td class="title" colspan="7" align="center"><button name="_calendar_prev_year_" class="prev-year"/><button name="_calendar_prev_month_" class="prev-month"/><input name="_calendar_year_" class=" x-desktop-datePicker-input x-desktop-datePicker-year" maxlength="4" /><input class=" x-desktop-datePicker-input x-desktop-datePicker-" readonly="" value="-" /><input name="_calendar_month_" class=" x-desktop-datePicker-input x-desktop-datePicker-month" maxlength="2" /><button name="_calendar_next_month_" class="next-month"/><button name="_calendar_next_year_" class="next-year"/></td></tr><tr class="names"><td class="name">'+(new n.Message(n.Message.JUSTEP231509)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231510)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231511)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231512)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231513)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231514)).getMessage()+'</td><td class="name">'+(new n.Message(n.Message.JUSTEP231515)).getMessage()+"</td></tr></thead>"+'<tbody><tr><td class="day weekend"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day weekend">1</td></tr><tr><td class="day weekend">2</td><td class="day">3</td><td class="day">4</td><td class="day">5</td><td class="day">6</td><td class="day">7</td><td class="day weekend">8</td></tr><tr><td class="day weekend">9</td><td class="day">10</td><td class="day selected">11</td><td class="day">12</td><td class="day">13</td><td class="day">14</td><td class="day weekend">15</td></tr><tr><td class="day weekend">16</td><td class="day">17</td><td class="day today">18</td><td class="day">19</td><td class="day">20</td><td class="day">21</td><td class="day weekend">22</td></tr><tr><td class="day weekend">23</td><td class="day">24</td><td class="day">25</td><td class="day">26</td><td class="day">27</td><td class="day">28</td><td class="day weekend">29</td></tr><tr><td class="day weekend   ">30</td><td class="day">31</td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day"></td><td class="day weekend"></td></tr></tbody>'+'<tfoot><tr><td colspan="7"><input name="_calendar_hour_" maxlength="2" class=" x-desktop-datePicker-input"/>:<input name="_calendar_min_" class=" x-desktop-datePicker-input" maxlength="2"/>:<input name="_calendar_sec_" class=" x-desktop-datePicker-input" maxlength="2"/></td></tr><tr><td colspan="7"><button name="_calendar_ok_" class=" x-desktop-datePicker-button">'+(new n.Message(n.Message.JUSTEP231500)).getMessage()+'</button><button name="_calendar_cancel_" class=" x-desktop-datePicker-button">'+(new n.Message(n.Message.JUSTEP231501)).getMessage()+'</button><button name="_calendar_clear_" class=" x-desktop-datePicker-button">'+(new n.Message(n.Message.JUSTEP231508)).getMessage()+"</button></td></tr></tfoot>"+"</table>"},i.get=function(){return i.instance||(i.instance=new i),i.instance},i.daysOfMoth=[31,28,31,30,31,30,31,31,30,31,30,31],i.ONLY_DATE=0,i.HOURS=1,i.MINUTES=2,i.SECONDS=3,i.TIME=4,i.show=function(e,r,s){var o=i.get();r||(r=i.ONLY_DATE),s=!!s,o.yearList.element.onclick=o.monthList.element.onclick=o.hourList.element.onclick=o.minList.element.onclick=o.secList.element.onclick=o.element.onclick=function(e){(e||event).cancelBubble=s},o.input=e,o.type=r,o.isTime=r==i.TIME,o.isTimestamp=r!=i.ONLY_DATE,o.isTimestamp?t(o.element).find("tfoot tr:first-child").show():t(o.element).find("tfoot tr:first-child").hide();var u;try{var a="function"==typeof e.val?e.val():t(e).val();u=o.isTimestamp?n.Date.fromString(a,"yyyy-MM-ddThh:mm:ss"):n.Date.fromString(a,n.Date.STANDART_FORMAT_SHOT)}catch(f){u=new Date}u?o.refreshControls(u):o.today();var l=t(e.domNode?e.domNode:e),f=t(o.element);f.css({top:-3e3,left:-3e3}).show();var c=l.offset(),h=c.top-f.outerHeight(!0),p=t(document).height()<c.top+l.outerHeight(!0)+f.outerHeight(!0)&&h>0,d=p?h:c.top+l.outerHeight(!0);d<0&&(d=0);var v=l.offset().left;v<0&&(v=0);var m=t(document).width(),g=f.outerHeight(!0);m<v+g&&(v-=v+g-m),v<0&&(v=0),f.css({top:d,left:v})},i.hide=function(){i.get().hide()},i}),define("$model/UI2/system/components/justep/labelEdit/labelEdit.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/labelEdit/labelEdit",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./labelEdit.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./labelEdit"),r=e("./labelEdit.config"),i=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e)},dispose:function(){this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-label-edit"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+n+"' "+" ></div>"}});return t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/list/list.config",["require"],function(e){return{properties:{limit:"number",filter:"string",data:"string",autoLoad:"boolean",disablePullToRefresh:"boolean",disableInfiniteLoad:"boolean"},events:["onAfterRender"],binds:{}}}),define("$model/UI2/system/components/justep/list/list",["require","css!./css/list","jquery","$UI/system/lib/justep","../data/data","./list.config"],function(require){require("css!./css/list").load();var $=require("jquery"),justep=require("$UI/system/lib/justep"),Express=justep.Express,Bind=justep.Bind,Data=require("../data/data"),url=require.normalizeName("./list"),ComponentConfig=require("./list.config"),List=justep.BindComponent.extend({getConfig:function(){return ComponentConfig},constructor:function(e){this.filter="",this.pageIndex=Bind.observable(-1),this.limit=-1,this.data="",this.hasMore=!1,this.autoLoad=!0,this._canLoadData=!1,this.disablePullToRefresh=!1,this.disableInfiniteLoad=!1,this.callParent(e)},dispose:function(){this.callParent()},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="x-list");var t=e.xid||justep.UUID.createUUID(),n=$("<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(t?" xid='"+t+"' ":"")+" component='"+url+"' "+" >"+(e.template?e.template:"")+"</div>"),r=n.hasClass("x-list-template")?n:n.find(".x-list-template:first");if(e.data){var i="$model.foreach_"+t+"($element)",s="$model.foreach_afterRender_"+t+".bind($model,$element)";r.addClass("hide").attr("bind-foreach","{data:"+i+",afterRender:"+s+"}")}return n},getData:function(){try{return this.getModel().comp(this.data)}catch(e){return null}},doInit:function(e,t){this._bindEvent(),this._createForeachData();if(this.autoLoad){var n=this.getModel();justep.ModelBase.MODEL_STATUS_CONSTRUCT_DONE>n.getStatus()?n.on(justep.ModelBase.MODEL_CONSTRUCT_DONE_EVENT,this.refresh.bind(this,!1)):justep.Bind.utils.domNodeReady.addReadyCallback(this.domNode,this.refresh.bind(this,!1))}},_bindEvent:function(){var e=this.getModel();e.on("onPullDown",function(e){!this.disablePullToRefresh&&this._isSelfRefresh(e.source)&&(this.hasListener("onPullToRefresh")&&this.fireEvent("onPullToRefresh",{source:this}),this.refresh(!0))},this),e.on("onPullUp",function(e){if(!this.disableInfiniteLoad&&this._isSelfRefresh(e.source)){this.loadNextPage();if(this.hasListener("onInfiniteLoad")){var t={source:this,hasMore:this.hasMore};this.fireEvent("onInfiniteLoad",t),this.hasMore=t.hasMore}e.noMoreLoad=!this.hasMore}},this),this._getForeachNode().on("click",{comp:this},function(e){return e.data.comp._doRowClick(e),!0})},_isSelfRefresh:function(e){return this._getForeachNode().parents(".x-scroll")[0]==e.domNode},_doRowClick:function(e){var t=Bind.contextFor(e.target||e.srcElement);if(t){var n=t.$object;n instanceof Data.Row&&n.data.to(n)}},_createForeachData:function(){var e=this.getModel(),t=this;"function"!=typeof e["foreach_"+this.$domNode.attr("xid")]&&(e["foreach_"+this.$domNode.attr("xid")]=function(e){var n=justep.Component.getComponent(e);if(!n||!(n instanceof List))n=justep.Component.getComponent($(e).parents("[component='"+t.componentName+"']:first")[0]);return n._computedForeach()}),"function"!=typeof e["foreach_afterRender_"+this.$domNode.attr("xid")]&&(e["foreach_afterRender_"+this.$domNode.attr("xid")]=function(e){var n=justep.Component.getComponent(e);if(!n||!(n instanceof List))n=justep.Component.getComponent($(e).parents("[component='"+t.componentName+"']:first")[0]);return n._afterRenderForeach()})},_afterRenderForeach:function(){this._getForeachNode().trigger("afterRenderList"),this.fireEvent("onAfterRender",{source:this})},_computedForeach:function(){if(!this.__computed){this.__computed=!0;try{return this.bindingObjects=this.getForeachData(),this.bindingObjects}finally{this.__computed=!1}}},_getForeachNode:function(){return this.$domNode.hasClass("x-list-template")?this.$domNode:this.$domNode.find(".x-list-template:first")},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n)},getBindingObjects:function(){return this.bindingObjects?this.bindingObjects:[]},getForeachData:function(){if(this.pageIndex.get()==-1)return[];if(this.data){var data=this.getData(),ctx,ret,i,j,b;if(data instanceof Data){var datas=data.datas.get(),list_limit=-1==this.limit?data.limit:this.limit,size=datas.length,offset=-1==this.limit?-1==data.limit?size:data.getOffset():list_limit*this.pageIndex.get(),total=data.getTotal();this.hasMore=offset<size||size>0&&total>0&&offset-(-1==this.limit?0:list_limit)<total;if(data.limit!=list_limit||this.filter){this.filter&&"string"==typeof this.filter&&(this.filter=new Express(this.filter)),ret=[],ctx=Bind.contextFor(this.domNode);for(i=0,j=0;i<offset&&j<size;j++)b=!0,this.filter instanceof Express&&(ctx.$row=datas[j],b=Express.eval(this.filter,ctx.$object,ctx)),b&&(ret.push(datas[j]),i++);return delete ctx.$row,i<offset&&size<total&&this._canLoadData&&data.loaded&&data.loadNextPageData({append:!0,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,datas,size)}),ret}return offset<=size?datas:data.loaded&&size<total&&this._canLoadData?(data.loadNextPageData({append:!0,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,datas,size)}),datas):datas}ctx=Bind.contextFor(this.domNode);var dataExpr;with(this.getModel())with(ctx)dataExpr=eval("("+this.data+")");var temps;"function"==typeof dataExpr?temps=dataExpr.call(ctx.$model):temps=dataExpr;if(Bind.isObservable(temps)||Bind.isComputed(temps))temps=temps.get();if(-1!==this.limit&&$.isArray(temps)){this.filter&&"string"==typeof this.filter&&(this.filter=new Express(this.filter)),ret=[],ctx=Bind.contextFor(this.domNode);var len=temps.length,listOffset=this.limit*this.pageIndex.get();this.hasMore=len>listOffset;for(i=0,j=0;i<listOffset&&j<len;j++)b=!0,this.filter instanceof Express&&(ctx.$row=temps[j],b=Express.eval(this.filter,ctx.$object,ctx)),b&&(ret.push(temps[j]),i++);return delete ctx.$row,ret}return temps}return[]},loadNextPage:function(){if(this.hasMore)if(-1==this.limit)this.getData().loadNextPageData({append:!0});else{var e=this.pageIndex.get();this._canLoadData=!0;try{this.pageIndex.set(e+1)}finally{this._canLoadData=!1}}},refresh:function(e){if(this.data){this.pageIndex.set(-1);var t=this.getData(),n=function(){this._canLoadData=!0;try{this.pageIndex.set(1)}finally{this._canLoadData=!1}t instanceof Data&&t.first()}.bind(this);t instanceof Data&&(e||!t.autoLoad&&!t.isLoaded())?t.refreshData({async:!0,onSuccess:n}):n()}this._getForeachNode().removeClass("hide")}});return justep.Component.register(url,List),List}),define("$model/UI2/system/components/justep/tree/tree.config",["require"],function(e){return{properties:{limit:"number",filter:"string",data:"string",labelColumn:"string",rootLabel:"string",autoLoad:"boolean",disablePullToRefresh:"boolean",disableInfiniteLoad:"boolean"},events:["onAfterRender","onBeforeLoadChildren","onCustomLoadChildren"],binds:{}}}),define("$model/UI2/system/components/justep/tree/tree",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","../list/list","../data/data","./tree.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=t.Component,r=t.Bind,i=t.Express,s=e("../list/list"),o=e("../data/data"),u=e.normalizeName("./tree"),a=e("./tree.config"),f=s.extend({getConfig:function(){return a},constructor:function(e){this.labelColumn=null,this.rootLabel=t.Message.getMessage(t.Message.JUSTEP231085),this.contexts={},this.context=r.observable({pageIndex:-1,row:null,datas:null}),this.callParent(e)},dispose:function(){var e=this.getData(),t=this.getBar();e.off("onAfterRefresh",this._doDataRefresh),t.off("onClick",this._doBarClick),this.callParent()},clsContexts:function(){this.contexts={};var e=this.context.get();e.pageIndex=-1,e.row=null,e.datas=null},clear:function(){this.clsContexts(),this.getBar().clear();var e=this.getBar();e.push({label:this.rootLabel})},updateContext:function(e){var t=this.getData(),n=this.contexts[e?t.getRowID(e):undefined];n?this.context.set(n):(n={pageIndex:1,row:e,datas:e?e.rows:this.getData().datas},this.context.set(n));var r=this.getScroll();r&&r.refresh()},saveContext:function(){var e=this.context.get(),t=this.getData();this.contexts[e?t.getRowID(e.row):null]=e},doInit:function(e,t){this.callParent(e,t)},_getForeachNode:function(){return this.$domNode.find(".x-tree-template:first")},_bindEvent:function(){var e=this.getData();e.on("onAfterRefresh",this._doDataRefresh,this),e.on("onDataChange",this._doDataClear,this);var t=this;this.getModel().componentPromise(this.$domNode.find(".x-tree-head .breadcrumb")[0]).done(function(e){e.on("onClick",t._doBarClick,t),e.push({label:t.rootLabel})}),this._getForeachNode().on("click",".x-tree-link",{comp:this},function(e){return e.data.comp._doRowLinkClick(e)}).on("click",{comp:this},function(e){return e.data.comp._doRowClick(e),!0}),this.callParent()},_doRowLinkClick:function(e){this.saveContext();var t=r.contextFor(e.target||e.srcElement),n=t.$object,i=this.getData(),s={source:this,bindingContext:t,row:n,data:i,cancel:!1},o=!0;this.fireEvent("onBeforeLoadChildren",s);if(!s.cancel&&!i.isLeaf(n)){var u=!1,a=function(e,t){t&&t.rows&&t.rows.get().length>0&&(e.to(t.rows.get()[0]),this.updateContext(t),this.getBar().push({label:t.val(this.labelColumn),row:t}),o=!1)}.bind(this,i,n);i.isLoaded(n)?a():this.hasListener("onCustomLoadChildren")?(s={source:this,bindingContext:t,row:n,data:i,async:u,asyncCallBack:a},this.fireEvent("onCustomLoadChildren",s),s.async||a()):i.loadNextPageData({append:!1,parent:n,onSuccess:a})}return o},_doBarClick:function(e){this.saveContext();var t=e.source.popTo(e.data);t&&t.length>0&&this.getData().to(t[t.length-1].row),this.updateContext(e.data.row)},_doDataClear:function(e){e.selfChanged&&e.type=="clear"&&!e.parent&&this.clear()},_doDataRefresh:function(e){e.options.parent||this.refresh()},getBar:function(){return n.getComponent(this.$domNode.find(".x-tree-head .breadcrumb")[0])},getScroll:function(){return n.getComponent(this.$domNode.find(".x-scroll:first")[0])},getForeachData:function(){var e=this.context.get();if(e.pageIndex==-1)return[];if(e.datas){var t=this.getData();if(t instanceof o){var n=e.datas.get(),s=-1==this.limit?t.limit:this.limit,u=n.length,a=-1==this.limit?t.getOffset(e.row):s*e.pageIndex,f=t.getTotal(e.row);this.hasMore=a<u||u>0&&f>0&&a-(-1==this.limit?0:s)<f;if(t.limit!=s||this.filter){this.filter&&"string"==typeof this.filter&&(this.filter=new i(this.filter));var l=[],c=r.contextFor(this.domNode);for(var h=0,p=0;h<a&&p<u;p++){var d=!0;this.filter instanceof i&&(c.$row=n[p],d=i.eval(this.filter,c.$object,c)),d&&(l.push(n[p]),h++)}return delete c.$row,h<a&&u<f&&this._canLoadData&&t.loaded&&t.loadNextPageData({append:!0,parent:e.row,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,n,u)}),l}return a<=u?n:t.loaded&&u<f&&this._canLoadData?(t.loadNextPageData({append:!0,parent:e.row,onSuccess:function(e,t){if(e.length>t)return this.getForeachData()}.bind(this,n,u)}),n):n}}return[]},propertyChangedHandler:function(e,t,n){"rootLabel"==e&&(this._inited?this.getBar().setLabel(0,n):this.callParent(e,t,n))},loadNextPage:function(){if(this.hasMore){var e=this.context.get();if(-1==this.limit)this.getData().loadNextPageData({append:!0,parent:e.row});else{this._canLoadData=!0;try{e.pageIndex++,this.context.set(e)}finally{this._canLoadData=!1}}}},refresh:function(e){if(this.data){var t=this.context.get(),n=this.getData(),r=t.row;(e&&n instanceof o||!n.autoLoad&&!n.isLoaded())&&n.refreshData({parent:r}),this._canLoadData=!0;try{t={pageIndex:1,row:r,datas:r?r.rows:this.getData().datas},this.context.set(t)}finally{this._canLoadData=!1}n.first()}this._getForeachNode().removeClass("hide")}});return n.register(u,f),f}),define("$model/UI2/system/components/justep/messageDialog/messageDialog.config",["require"],function(e){return{properties:{type:"string",title:"string",message:"string",inputValue:"string",width:"string",height:"string"},events:["onClose","onOK","onCancel","onYes","onNo"],binds:{}}}),define("$model/UI2/system/components/justep/messageDialog/messageDialog",["require","$UI/system/components/justep/common/res","css!./css/messageDialog","jquery","$UI/system/lib/justep","./messageDialog.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/messageDialog").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("./messageDialog.config"),i=e.normalizeName("./messageDialog"),s=(new n.Message(n.Message.JUSTEP231079)).getMessage(),o=(new n.Message(n.Message.JUSTEP231080)).getMessage(),u=(new n.Message(n.Message.JUSTEP231081)).getMessage(),a=(new n.Message(n.Message.JUSTEP231082)).getMessage(),f=null;return f=n.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e),this.type=f.type.OK,this.title="",this.message="",this.inputValue=null,this.width="",this.height=""},dispose:function(){this._getButtonsNode().off("click",t.proxy(this._doClick,this)),this.callParent()},doInit:function(e,n){this._getButtonsNode().on("click",t.proxy(this._doClick,this))},buildTemplate:function(e){return e||(e={}),e.type||(e.type=f.type.OK),this.set(e),'<span component="'+i+'" type="'+e.type+'">'+'<div class="x-modal-overlay"></div>'+'<div class="x-modal">'+'<div class="x-modal-inner">'+'<div class="x-modal-title">'+e.title+"</div>"+'<div class="x-modal-text">'+e.message+"</div>"+'<input type="text" class="x-modal-prompt-input">'+"</div>"+'<div class="x-modal-buttons">'+'<a class="x-modal-button x-modal-button-bold OK" value="ok">'+s+"</a>"+'<a class="x-modal-button x-modal-button-bold Yes" value="yes">'+u+"</a>"+'<a class="x-modal-button x-modal-button-bold No" value="no">'+a+"</a>"+'<a class="x-modal-button x-modal-button-bold Cancel" value="cancel">'+o+"</a>"+"</div>"+"</div>"+"</span>"},propertyChangedHandler:function(e,t,n){switch(e){case"title":t!=n&&this._inited&&this._getTitleNode().text(n);break;case"message":if(t!=n&&this._inited){var r=n?(""+n).replace(/\n/g,"<br/>"):"";this._getTextNode().html(r)}break;case"inputValue":if(t!=n&&this._inited){var i=n!==null&&n!==undefined?n:"";this._getInputNode().val(i)}break;default:this.callParent(e,t,n)}},_getDialogNode:function(){return this.$domNode.find("div.x-modal")},_getOverlayNode:function(){return this.$domNode.find("div.x-modal-overlay")},_getTitleNode:function(){return this.$domNode.find("div.x-modal-title")},_getTextNode:function(){return this.$domNode.find("div.x-modal-text")},_getButtonsNode:function(){return this.$domNode.find("div.x-modal-buttons")},_getInputNode:function(){return this.$domNode.find("input.x-modal-prompt-input")},_doClick:function(e){this._getDialogNode().removeClass("x-modal-in").hide(),this._getOverlayNode().removeClass("x-modal-overlay-visible"),n.Util.enableTouchMove(document.body);var r={source:this,button:t(e.target).attr("value")};f.type.Prompt==this.type&&r.button=="ok"&&(r.input=this._getInputNode().val()),this.fireEvent("onClose",r),"function"==typeof this.callback&&this.callback(r);switch(r.button){case"ok":this.fireEvent("onOK",r);break;case"cancel":this.fireEvent("onCancel",r);break;case"yes":this.fireEvent("onYes",r);break;case"no":this.fireEvent("onNo",r)}},show:function(e){e=e||{},this.callback=null,"function"==typeof e.callback&&(this.callback=e.callback),this.set(e);var t=this._getDialogNode();this.height!==""&&t.height(this.height);var r={marginTop:-t.outerHeight()/2+"px"};this.width!==""&&(t.width(this.width),r.marginLeft=-t.outerWidth()/2+"px"),t.css(r),n.Util.disableTouchMove(document.body),this._getOverlayNode().addClass("x-modal-overlay-visible"),t.show().addClass("x-modal-in")}}),f.type={OK:"OK",OKCancel:"OKCancel",YesNo:"YesNo",YesNoCancel:"YesNoCancel",Prompt:"Prompt"},f.result={ok:"ok",cancel:"cancel",yes:"yes",no:"no"},n.Component.register(i,f),f}),define("$model/UI2/system/components/justep/extendType/commonExtendTypes.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/extendType/js/extendTypeBoolean",["require","$UI/system/components/justep/data/data"],function(e){var t=e("$UI/system/components/justep/data/data"),n=t.ExtendType.extend({constructor:function(e,t,n){this.callParent(e,t,n)}});return n}),define("$model/UI2/system/components/justep/extendType/js/extendTypeEmail",["require","$UI/system/components/justep/data/data"],function(e){var t=e("$UI/system/components/justep/data/data"),n=t.ExtendType.extend({constructor:function(e,t,n){this.callParent(e,t,n),e.addRule(t,{rule:"email",message:"不是email格式"})}});return n}),define("$model/UI2/system/components/justep/extendType/commonExtendTypes.reg",["require","./js/extendTypeBoolean","./js/extendTypeEmail","./js/extendTypeDateTime"],function(e){var t=[{name:"sys.boolean",dataType:"",editor:"$UI/system/components/justep/button/checkbox"},{name:"sys.email",dataType:"String,Text",editor:""},{name:"sys.datetime",dataType:"Date,Time,DateTime",editor:"$UI/system/components/justep/input/input"}],n={"sys.boolean":e("./js/extendTypeBoolean"),"sys.email":e("./js/extendTypeEmail"),"sys.datetime":e("./js/extendTypeDateTime")};for(var r=0,i=t.length;r<i;r++)t[r]["class"]=n[t[r].name];return t}),define("$model/UI2/system/components/justep/extendType/commonExtendTypes",["require","jquery","$UI/system/lib/justep","$UI/system/components/justep/data/data","./commonExtendTypes.config","./commonExtendTypes.reg"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("$UI/system/components/justep/data/data"),i=e.normalizeName("./commonExtendTypes"),s=e("./commonExtendTypes.config"),o=e("./commonExtendTypes.reg"),u=n.ViewComponent.extend({getConfig:function(){return s},getRegConfig:function(){return o},constructor:function(e){this.callParent(e)},init:function(e,n){this.callParent(e,n);var i=this.getModel(),s=this.getRegConfig();s&&t.isArray(s)&&t.each(s,function(e,t){r.registerExtendType(i,t)})},dispose:function(){var e=this.getModel(),n=this.getRegConfig();n&&t.isArray(n)&&t.each(n,function(t,n){r.unregisterExtendType(e,n.name)}),this.callParent()}});return n.Component.register(i,u),u}),define("$model/UI2/system/components/justep/output/output.config",["require"],function(e){return{properties:{dataType:"string",format:"string"},events:["onRender"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/output/output",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./output.config","$UI/system/components/justep/input/js/decimalFormat"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=t.Bind,r=e.normalizeName("./output"),i=e("./output.config"),s=e("$UI/system/components/justep/input/js/decimalFormat"),o=t.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.value="",this.format="",this.dataType="String"},dispose:function(){this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="x-output"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"'":"")+(e.xid?" xid='"+e.xid+"'":"")+" component='"+r+"'"+" ></div>"},doInit:function(e,t){if(n.isObservable(this.ref)&&this.ref.define){var r=this.ref.define.defCol.type;r!==this.dataType&&(this.dataType=r)}if(this.dataType=="DateTime"||this.dataType=="Date"||this.dataType=="Time")this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss"))},render:function(){this.callParent();if(n.isObservable(this.ref)&&this.ref.define){var e=this.ref.define.defCol.type;e!==this.dataType&&(this.dataType=e)}var r=this.value,i;r&&("DateTime"==this.dataType?(i=r instanceof Date?r:t.Date.fromString(r,t.Date.STANDART_FORMAT),r=t.Date.toString(i,this.format)):"Date"==this.dataType?(i=r instanceof Date?r:t.Date.fromString(r,t.Date.STANDART_FORMAT_SHOT),r=t.Date.toString(i,this.format)):"Time"==this.dataType?(i=r instanceof Date?r:t.Date.fromString(r,"hh:mm:ss"),r=t.Date.toString(i,this.format)):this.format&&("Integer"==this.dataType||"Long"==this.dataType||"Float"==this.dataType||"Double"==this.dataType||"Decimal"==this.dataType)&&(r=(new s(this.format)).format(r)));if(r===undefined||r===null)r="";var o={source:this,value:this.value,html:r};this.fireEvent("onRender",o),this.$domNode.html(o.html)},propertyChangedHandler:function(e,t,n){switch(e){case"format":this.format||("DateTime"==this.dataType?this.format="yyyy-MM-dd hh:mm:ss":"Date"==this.dataType?this.format="yyyy-MM-dd":"Time"==this.dataType&&(this.format="hh:mm:ss")),t!=n&&(this.needRender=this._inited);break;case"value":t!=n&&this._inited&&(this.fireEvent("onChange",{source:this,originalValue:t,value:n}),this.needRender=!0);break;default:this.callParent(e,t,n)}}});return t.Component.register(r,o),o}),define("$model/UI2/system/components/justep/panel/panel.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/panel/panel",["require","$UI/system/components/justep/common/res","css!./css/panel","$UI/system/lib/base/component","$UI/system/lib/base/object","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./panel.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/panel").load();var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/object"),r=e("$UI/system/lib/justep"),i=e("$UI/system/lib/base/string"),s=e("$UI/system/lib/base/viewComponent"),o=e("jquery"),u=e.normalizeName("./panel"),a=e("./panel.config"),f=s.extend({constructor:function(e){this.baseCls="x-panel",this.callParent(e)},getConfig:function(){return a},buildTemplate:function(e){return e.content=e.content||{},e.content.refresh=e.content.refresh!=undefined?e.content.refresh:!1,e.content.load=e.content.load!=undefined?e.content.load:!1,e.top=e.top||{},e.top.visible=e.top.visible!=undefined?e.top.visible:!0,e.top.height=e.top.height!=undefined?e.top.height:"48",e.bottom=e.bottom||{},e.bottom.visible=e.bottom.visible!=undefined?e.bottom.visible:!0,e.bottom.height=e.bottom.height!=undefined?e.bottom.height:"48",i.format("<div xid='{0}' class='{1}' component='{2}'><div class='x-panel-top {3}' style='{4}'>{5}</div><div class='x-panel-content'>{6}</div><div class='x-panel-bottom {7}' style='{8}'>{9}</div></div>",e.xid,this.baseCls,u,e.top.visible?"":"hide",styleHeight(e.top.height),e.top.body||"",e.content.body||"",e.bottom.visible?"":"hide",styleHeight(e.bottom.height),e.bottom.body||"")},init:function(e,t){this.callParent(e,t),this.$el=o(this.domNode),this.$top=o(">.x-panel-top",this.domNode),this.$content=o(">.x-panel-content",this.domNode),this.$bottom=o(">.x-panel-bottom",this.domNode),this.$top.length==0&&this.$content.css("top",0),this.$bottom.length==0&&this.$content.css("bottom",0);var n=this,r=this.getModel().componentPromise(this.$top[0]),i=this.getModel().componentPromise(this.$content[0]),s=this.getModel().componentPromise(this.$bottom[0]);return o.when(r,i,s).then(function(e,t,r){n.inited()},function(e){alert(e)}),{dependence:!0}},setHeight:function(e,t){t+="px",o(">.x-panel-"+e,this.$domNode).css("height",t),o(">.x-panel-content",this.$domNode).css(e,t)},getHeight:function(e){return o(">.x-panel-"+e,this.$domNode).css("height")},setVisible:function(e,t){t?o(">.x-panel-"+e,this.$domNode).removeClass("hide"):o(">.x-panel-"+e,this.$domNode).addClass("hide"),e=="top"?t?o(">.x-panel-content",this.$domNode).css("top",o(">.x-panel-top",this.$domNode).height()):o(">.x-panel-content",this.$domNode).css("top",0):t?o(">.x-panel-content",this.$domNode).css("bottom",o(">.x-panel-bottom",this.$domNode).height()):o(">.x-panel-content",this.$domNode).css("bottom",0)},getVisible:function(e){return!o(">.x-panel-"+e,this.$domNode).hasClass("hide")},showTop:function(){this.setVisible("top",!0)},hideTop:function(){this.setVisible("top",!1)},toggleTop:function(){var e=o(">.x-panel-top",this.$domNode).hasClass("hide");this.setVisible("top",e)},showBottom:function(){this.setVisible("bottom",!0)},hideBottom:function(){this.setVisible("bottom",!1)},toggleBottom:function(){var e=o(">.x-panel-bottom",this.$domNode).hasClass("hide");this.setVisible("bottom",e)},get:function(e){return this[e]},remove:function(e){o(".x-panel-"+e,this.$el).remove()}});return t.register(u,f),f}),define("$model/UI2/system/components/justep/panel/child.config",["require"],function(e){return{properties:{height:"number",visible:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/panel/child",["require","$UI/system/lib/base/component","$UI/system/lib/base/observable","$UI/system/lib/base/object","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./child.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/observable"),r=e("$UI/system/lib/base/object"),i=e("$UI/system/lib/justep"),s=e("$UI/system/lib/base/string"),o=e("$UI/system/lib/base/viewComponent"),u=e("jquery"),a=e.normalizeName("./child"),f=e("./child.config"),l=o.extend({constructor:function(e){this.height="48",this.visible=!0,this.callParent(e)},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.name=this._getName(),this.owner[this.name]=this,this.callParent(e,n)},getConfig:function(){return f},_getName:function(){var e=this.$domNode.attr("class");if(e.indexOf("x-panel-top")!=-1)return"top";if(e.indexOf("x-panel-bottom")!=-1)return"bottom";if(e.indexOf("x-panel-left")!=-1)return"left";if(e.indexOf("x-panel-right")!=-1)return"right";if(e.indexOf("x-panel-content")!=-1)return"content"},get:function(e){e="get"+s.camelize(e);if(this.owner[e])return this.owner[e](this.name)},set:function(e,t){this[e]=t;if(typeof e=="object"){var n=e;for(var r in n)n.hasOwnProperty(r)&&this.set(r,n[r])}else e="set"+s.camelize(e),this.owner[e]&&this.owner[e](this.name,t)},dispose:function(){this.owner.remove(this.name),this.owner=null},propertyChangedHandler:function(e,t,n){switch(e){case"height":this.set(e,n)}}});return t.register(a,l),l}),define("$model/UI2/system/components/justep/row/row",["require","css!./css/row","$UI/system/lib/base/component","$UI/system/lib/base/viewComponent"],function(e){e("css!./css/row").load();var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/viewComponent"),r=e.normalizeName("./row");return t.register(r,n),n}),define("$model/UI2/system/components/justep/scrollView/scrollView.config",["require"],function(e){return{properties:{hScroll:"boolean",vScroll:"boolean",hScrollbar:"boolean",vScrollbar:"boolean",fadeScrollbar:"boolean",hideScrollbar:"boolean",bounce:"boolean",lockDirection:"boolean",checkDOMChanges:"boolean",snap:"string",scrollbarClass:"string",pullDownLabel:"string",pullDownMoveLabel:"string",pullDownLoadingLabel:"string",pullUpLabel:"string",pullUpMoveLabel:"string",pullUpLoadingLabel:"string",noMoreCanLoadLabel:"string",autoPullUp:"boolean"},events:["onScrollMove","onScrollEnd","onPullDown","onPullUp"]}}),define("$model/UI2/system/components/justep/scrollView/scrollView",["require","$UI/system/lib/base/component","./lib/iscroll","jquery","$UI/system/lib/base/viewComponent","./scrollView.config","css!./css/scrollView"],function(e){var t=e("$UI/system/lib/base/component"),n=e("./lib/iscroll").iScroll,r=e("jquery"),i=e("$UI/system/lib/base/viewComponent"),s=e.normalizeName("./scrollView"),o=e("./scrollView.config");e("css!./css/scrollView").load();var u=i.extend({getConfig:function(){return o},set:function(e){var t=this;r.each(e,function(e,n){t.hasOwnProperty(e)||(t[e]=undefined)}),this.callParent(e)},buildTemplate:function(e){return e=e||{},this.set(e),r('<div class="x-scroll"><div class="x-scroll-content"></div></div>').attr(e).attr("component",s)},init:function(e,t){var n=this;this.pullDownLabel="下拉刷新",this.pullDownMoveLabel="松开刷新",this.pullDownLoadingLabel="加载中....",this.pullUpLabel="加载更多",this.pullUpMoveLabel="释放加载",this.pullUpLoadingLabel="加载中....",this.noMoreLoadLabel="已经到最后.",this.autoPullUp=!0,this.callParent(e,t),this.$rootEle=r(this.domNode).parent(),this.$rootEle.addClass("x-scroll-view"),this.$scrollEle=this.$rootEle.find(">.x-scroll"),this.getModel().on("onModelConstructDone",function(){__justep.cssReady(function(){n.render()})},this),this.getModel().on("onScrollRefresh",function(e){this.$rootEle.find(r(e.source.$rootEle)).length>0&&this.refresh()},this)},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n);if(e=="pullDownLabel"){if(this.$puEle&&this.$pdEle.hasClass("x-pull-down")){var r=this.$scrollEle.find(".x-pull-down>.x-pull-down-label");r.text(n)}}else if(e=="pullUpLabel"&&this.$puEle&&this.$puEle.hasClass("x-pull-up")){var i=this.$scrollEle.find(".x-pull-up>.x-pull-up-label");i.text(n)}},render:function(){var e=this,t=this.$rootEle.parent().outerHeight(!0),i=this.$rootEle.outerHeight(!0),s=this.$scrollEle.outerHeight(!0);i==s&&i>t&&this.$rootEle.css("height","100%"),this.$rootEle.css("position")!="absolute"?(e.$rootEle.css("position")!="absolute"&&e.$rootEle.css({position:"relative"}),this.$scrollEle.css({position:"relative"})):this.$scrollEle.css({width:"100%",position:"absolute"});var o=this.$domNode.data("config")||{};if(typeof MutationObserver=="function"){var u=this.$scrollEle.find(".x-scroll-content"),a=new MutationObserver(function(t){e.refresh()}),f=u.find("div,ul");for(var l=0;l<Math.min(f.length,3);l++)a.observe(f.get(l),{childList:!0});o.checkDOMChanges=!1}else o.checkDOMChanges=!0;var c={hideScrollbar:!0,onRefresh:function(){return e.fireEvent("onScrollRefresh",{source:e})},onScrollMove:function(){return e.fireEvent("onScrollMove",{source:e})},onScrollEnd:function(){return e.fireEvent("onScrollEnd",{source:e})}};o=r.extend(c,o),this.$scrollEle.find(">.x-pull-down").length>0&&(o.topOffset=50),this.scroller=new n(this.$rootEle.get(0),o),this.scroller.options.topOffset=0,this.getModel().on("reflow",function(e){(r(e).find(this.$rootEle).length>0||r(e).is(this.$rootEle))&&this.refresh()},this),this.$scrollEle.find(">.x-pull-down").length>0&&this.pullDown(function(){return this.fireEvent("onPullDown",{source:this}),this.getModel().fireEvent("onPullDown",{source:this}),!0}),this.$scrollEle.find(">.x-pull-up").length>0&&this.pullUp(function(e){this.noMoreLoad=!1;var t={source:this,noMoreLoad:!1};return this.fireEvent("onPullUp",t),this.getModel().fireEvent("onPullUp",t),t.noMoreLoad&&(this.noMoreLoad=!0),!0}),e.getModel().fireEvent("onScrollRefresh",{source:this}),e.refresh()},refresh:function(e){e=e||0;if(this.scroller){var t=this;if(t.getModel()){if(t.$pdEle&&t.$pdEle.length>0){var n=t.$pdEle.outerHeight(!0);if(n<30&&e<2){setTimeout(function(){t.refresh(e++)},1e3);return}}if(t.$pdEle&&t.$pdEle.length>0){var n=t.$pdEle.outerHeight(!0);t.scroller.options.topOffset=n,t.scroller.minScrollY=-n}t.$pdEle&&t.$pdEle.length>0&&setTimeout(function(){t.$pdEle.css("opacity","0.99")},200),t.$puEle&&t.$puEle.length>0&&setTimeout(function(){t.$puEle.css("opacity","0.99")},200),t.scroller.refresh(),t.getModel().fireEvent("onScrollRefresh",{source:t})}}},pullDown:function(e){this.$pdEle=this.$scrollEle.find(">.x-pull-down"),this.$pdiEle=this.$scrollEle.find(".x-pull-down>.x-pull-down-img"),this.$pdEle.length==0&&(this.$pdEle=r('<div class="x-pull-down"><span class="x-pull-down-label">'+this.pullDownLabel+"</span></div>"),this.$scrollEle.prepend(this.$pdEle),this.refresh());var t=this.$pdEle.outerHeight(!0);this.scroller.options.topOffset!==t&&(this.scroller.options.topOffset=t);var n=this,i=this.$pdEle.find(".x-pull-down-label");this._pdRefresh=function(){n.$pdEle.hasClass("x-loading")&&(n.$pdEle.removeClass("x-loading"),n.$pdEle.addClass("x-pull-down"),i.text(this.pullDownLabel)),n.$pdiEle.css({transform:"rotate(0deg) translate3d(0,0,0)"})},this.on("onScrollRefresh",this._pdRefresh),this._pdScrollMove=function(){if(n.scroller.y>-15&&n.scroller.y<5){var e=((n.scroller.y-5)/20+1)*-180;n.$pdiEle.css({transform:"rotate("+e+"deg) translate3d(0,0,0)"})}else n.scroller.y>5&&n.$pdiEle.css({transform:"rotate(-180deg) translate3d(0,0,0)"});n.scroller.y>5&&!n.$pdEle.hasClass("x-flip")?(n.$pdEle.addClass("x-flip"),n.$pdEle.removeClass("x-restore"),n.$pdEle.addClass("x-flip"),n.$pdEle.removeClass("x-restore"),i.text(n.pullDownMoveLabel),n.scroller.minScrollY=0):n.scroller.y<5&&n.$pdEle.hasClass("x-flip")&&(n.$pdEle.removeClass("x-flip"),n.$pdEle.addClass("x-restore"),i.text(n.pullDownLabel),n.scroller.minScrollY=-t)},this.on("onScrollMove",this._pdScrollMove),this._pdScrollEnd=function(t){if(n.$pdEle.hasClass("x-flip")){n.noMoreLoad=!1,n.$pdEle.removeClass("x-flip"),n.$pdEle.addClass("x-loading"),i.text(n.pullDownLoadingLabel);try{var s=e.call(this,t);r.type(s)==="object"?r.when(s).done(n.pullDownFinish()).fail(n.pullDownError()):r.type(s)==="boolean"&&(s?n.pullDownFinish(t):n.pullDownError(t))}catch(o){throw n.pullDownError(t),new Error(o)}}else n.$pdEle.hasClass("x-restore")&&(n.$pdEle.removeClass("x-restore"),n.$pdEle.addClass("x-pull-down"),this.refresh())},this.on("onScrollEnd",this._pdScrollEnd)},pullDownFinish:function(e){this.refresh()},pullDownError:function(e){this.refresh()},pullUp:function(e){this.$puEle=this.$scrollEle.find(">.x-pull-up"),this.$puEle.length==0&&(this.$puEle=r('<div class="x-pull-up"><span class="x-pull-up-label">'+this.pullUpLabel+"</span></div>"),this.$scrollEle.append($puEle),this.refresh());var t=this.$puEle.outerHeight(!0),n=this,i=this.$puEle.find(".x-pull-up-label");this._puRefresh=function(){n.$puEle.hasClass("x-loading")&&(n.$puEle.removeClass("x-loading"),n.$puEle.addClass("x-pull-up")),n.noMoreLoad?i.text(n.noMoreLoadLabel):i.text(n.pullUpLabel)},this.on("onScrollRefresh",this._puRefresh),this._puScrollMove=function(){n.scroller.y<0-n.scroller.options.topOffset&&n.scroller.y<n.scroller.maxScrollY-t&&!n.$puEle.hasClass("x-flip")?(n.$puEle.removeClass("x-restore"),n.$puEle.addClass("x-flip"),i.text(n.pullUpMoveLabel)):n.scroller.y>n.scroller.maxScrollY-t&&n.$puEle.hasClass("x-flip")&&(n.$puEle.removeClass("x-flip"),n.$puEle.addClass("x-restore"),i.text(n.pullUpLabel))},this.on("onScrollMove",this._puScrollMove),this._puScrollEnd=function(t){if(n.$puEle.hasClass("x-flip")){n.$puEle.removeClass("x-flip"),n.$puEle.addClass("x-loading"),i.text(n.pullUpLoadingLabel);var s=e.call(this,t);r.type(s)==="object"?r.when(s).done(n.pullUpFinish()).fail(n.pullUpError()):r.type(s)==="boolean"&&(s?n.pullUpFinish():n.pullUpError())}else if(this.autoPullUp===!0&&n.scroller.y===n.scroller.maxScrollY){var s=e.call(this,t);r.type(s)==="object"?r.when(s).done(n.pullUpFinish()).fail(n.pullUpError()):r.type(s)==="boolean"&&(s?n.pullUpFinish():n.pullUpError())}},this.on("onScrollEnd",this._puScrollEnd)},pullUpFinish:function(e){this.refresh()},pullUpError:function(e){this.refresh()}});return t.register(s,u),u}),define("$model/UI2/system/components/justep/select/radioGroup.config",["require"],function(e){return{properties:{disabled:"boolean",itemStyle:"string",itemClass:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/radioGroup",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","../button/radio","./radioGroup.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../button/radio"),i=e.normalizeName("./radioGroup"),s=e("./radioGroup.config"),o=n.BindComponent.extend({getConfig:function(){return s},constructor:function(e){this.itemStyle="",this.itemClass="",this._oldItemClass="",this.callParent(e)},dispose:function(){this.$domNode.off("click",t.proxy(this._doClick,this)),this.callParent()},val:function(e){if(arguments.length===0)return this.$domNode.find("input:checked").val();this.$domNode.find("input").each(function(){var n=t(this);n.prop("checked",e==n.val())})},_buildForeachTemplate:function(e){var t=new r;return t.buildTemplate({name:e.name,"bind-value":e["bind-itemsetValue"],"bind-label":e["bind-itemsetLabel"]})},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="x-radio-group");var r=t("<span class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+i+"' >"+"</span>");e["bind-itemset"]&&r.attr("data-bind","foreach:{data:"+e["bind-itemset"]+",afterRender:$model.comp($element)['_doUpdate'].bind($model.comp($element))}");var s=this._buildForeachTemplate(e),o="component:{name:'"+s.attr("component")+"'";e["bind-itemsetValue"]&&(o+=",value:"+e["bind-itemsetValue"]),e["bind-itemsetLabel"]&&(o+=",label:"+e["bind-itemsetLabel"]),o+="}",s.attr("data-bind",o);var u=e.name||n.UUID.createUUID();return s.attr("name",u),r.append(s),r},doInit:function(e,r){this.$domNode.on("click",t.proxy(this._doClick,this));var i=this.$domNode.attr("name");i||(i=n.UUID.createUUID()),this.$domNode.children("span[component*='/system/components/justep/button/']").attr("name",i)},_doUpdate:function(){this.updateValue(this.ref),this.ref&&(this.updateReadonly(this.ref),this.updateValidation(this.ref)),this._doUpdateCss()},_doUpdateCss:function(){var e=this.itemStyle,n=this.itemClass,r=this._oldItemClass;this.$domNode.children().each(function(){var i=t(this);i.attr({style:e}).removeClass(r).addClass(n)})},set:function(e){this.callParent(e),e&&e.hasOwnProperty("value")&&this.val(e.value)},get:function(e){return"value"==e?this.val():this.callParent(e)},disabledRender:function(){if(this.$domNode){var e=this.isDisabled();this.$domNode.children("span").each(function(){var t=n.Component.getComponent(this);t&&t.set({disabled:e})})}this.callParent()},propertyChangedHandler:function(e,t,n){if("itemClass"===e||"itemStyle"===e)this._doUpdateCss(),"itemClass"===e&&(this._oldItemClass=t);this.callParent(e,t,n)},_doClick:function(e){e.target.nodeName.toLowerCase()=="input"&&(this.fireEvent("onChange",{source:this,value:this.val()}),this.val2ref())}});return n.Component.register(i,o),o}),define("$model/UI2/system/components/justep/select/checkboxGroup.config",["require"],function(e){return{properties:{disabled:"boolean",itemStyle:"string",itemClass:"string"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/checkboxGroup",["require","jquery","$UI/system/lib/justep","../button/checkbox","./radioGroup","./checkboxGroup.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e("../button/checkbox"),i=e("./radioGroup"),s=e.normalizeName("./checkboxGroup"),o=e("./checkboxGroup.config"),u=i.extend({getConfig:function(){return o},val:function(e){if(arguments.length===0){var n=[];return this.$domNode.find("input:checked").each(function(){n.push(t(this).val())}),n.join(" ")}if(null===e||undefined===e)e="";var r=(""+e).split(" ");this.$domNode.find("input").each(function(){var e=t(this);e.prop("checked",-1<t.inArray(e.val(),r))})},_buildForeachTemplate:function(e){var t=new r;return t.buildTemplate({name:e.name,"bind-value":e["bind-itemsetValue"],"bind-label":e["bind-itemsetLabel"]})},buildTemplate:function(e){e||(e={}),this.set(e),e["class"]||(e["class"]="x-checkbox-group");var t="<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" data-bind='foreach:"+e.itemset+"' "+" component='"+s+"' >"+this._buildForeach(e)+"</div>";return delete e["bind-itemset"],delete e["bind-itemsetValue"],delete e["bind-itemsetLabel"],t}});return n.Component.register(s,u),u}),define("$model/UI2/system/components/justep/select/select.config",["require"],function(e){return{properties:{optionsAutoLoad:"boolean",disabled:"boolean"},events:["onChange"],binds:{"bind-labelRef":"labelRef","bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/select/select",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./select.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e.normalizeName("./select"),r=e("./select.config"),i="ontouchstart"in window,s=i?"touchstart":"mousedown",o=t.BindComponent.extend({getConfig:function(){return r},constructor:function(e){this.callParent(e),this.disabled=!1,this.options=null,this.optionsAutoLoad=!0,this.optionsCaption="",this.optionsText="",this.optionsValue=""},dispose:function(){this.$domNode.off("optionChange",$.proxy(this._doOptionChange,this)),this.$domNode.off("change",$.proxy(this._doChange,this)),this.$domNode.off(s,$.proxy(this._loadData,this)),this.callParent()},val:function(e){var t=this.$domNode.val();if(arguments.length===0)return t;this.$domNode.val(arguments[0])},buildTemplate:function(e){this._createOptionsRender(),e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),e["bind-optionsLabel"]&&(e["bind-optionsText"]="'"+e["bind-optionsLabel"]+"'",delete e["bind-optionsLabel"]);var t=["bind-optionsCaption","bind-optionsValue"];for(var r=0;r<t.length;r++)e[t[r]]&&(e[t[r]]="'"+e[t[r]]+"'");return e["bind-options"]&&(e["bind-optionsBeforeRender"]="$model.__justep__.selectOptionsBeforeRender.bind($model,$element)",e["bind-optionsAfterRender2"]="$model.__justep__.selectOptionsAfterRender.bind($model,$element)"),"<select class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+n+"' "+" ></select>"},doInit:function(e,t,n){this.$domNode.on("optionChange",$.proxy(this._doOptionChange,this)),this.$domNode.on("change",$.proxy(this._doChange,this)),this.$domNode.on(s,$.proxy(this._loadData,this)),this.labelRef=e?e.labelRef:null},doUpdate:function(e,t,n){this.labelRef=e?e.labelRef:null,n.has("options")&&(this.options=n.get("options")),this._addDefaultOption(),this.callParent(e,t)},_createOptionsRender:function(){var e=this.getModel();e.__justep__||(e.__justep__={}),e.__justep__.selectOptionsAfterRender||(e.__justep__.selectOptionsAfterRender=function(e){var n=t.Component.getComponent(e);n&&n._addDefaultOption()}),e.__justep__.selectOptionsBeforeRender||(e.__justep__.selectOptionsBeforeRender=function(e){var n=t.Component.getComponent(e);n&&n._optionsBeforeRender()})},_loadData:function(){if(this._load)return;if(!this.options)return;var e;this.optionsAutoLoad&&(e=this.options.owner,e&&!e.autoLoad&&!e.isLoaded()&&(this._load=e.refreshData())),this.ref&&this.updateValue(this.ref)},_optionsBeforeRender:function(){this.$domNode.children("[_default_option_='true']").remove()},_addDefaultOption:function(){if(!this.options)return;var e=this.options.owner;e&&(this.ref&&this.labelRef?this._addOption(this.ref.get(),this.labelRef.get()):this.ref&&this._addOption(this.ref.get()))},_addOption:function(e,t){if(!this._optionExistValue(e)){var n=document.createElement("option");$(n).attr("_default_option_","true"),n.value=e,n.text=null!==t&&undefined!==t?t:"",this.domNode.add(n,null)}},_optionExistValue:function(e){e=e===undefined||e===null?"":e;var t=this.domNode.options;for(var n=t.length-1;n>=0;n--)if(e==t[n].value||e+""==t[n].value)return!0},_getLabel:function(){var e=this.$domNode.prop("selectedIndex");return e>-1?this.$domNode.prop("options")[e].text:undefined},set:function(e){this.callParent(e),e&&e.hasOwnProperty("value")&&this.val(e.value)},get:function(e){return"value"==e?this.val():this.callParent(e)},_doChange:function(e){this.val2ref(),this._val2ref(this.labelRef,this._getLabel()),this.fireEvent("onChange",{source:this,value:this.val()})},_doOptionChange:function(e){this.updateValue(this.ref)}});return o.createEditor=function(e){if(!e)return;var t={};$.extend(t,e.getParam()),e.bindRef&&(t["bind-ref"]=e.bindRef);var n=["optionsLabel","optionsCaption","optionsValue"];for(var r=0;r<n.length;r++)t[n[r]]&&(t["bind-"+n[r]]=t[n[r]]);return t.options&&(t["bind-options"]="$model."+t.options),new o(t)},t.Component.register(n,o),o}),define("$model/UI2/system/components/justep/numberSelect/js/numberList",["require","$UI/system/resources/system.res","css!../css/numberList","jquery","$UI/system/lib/justep"],function(e){e("$UI/system/resources/system.res"),e("css!../css/numberList").load();var t=e("jquery"),n=e("$UI/system/lib/justep"),r=n.Object.extend({constructor:function(e,n,r,i,s,o,u,a){this.element=t(e||"body").append("<div/>").children().last().addClass((n||"")+" list-group x-numberlist").get(0),this.move=0,this.input=r,this.setParam(i,s,o,u,a)},dispose:function(){t(this.element).remove()},setParam:function(e,n,r,i,s){t(this.element).empty();var o=this;this.min=e,this.max=n,i=i||7,this.showItem=i,this.showCharSize=r||1,this.canShowAll=this.max-this.min+1<=i,this.canShowAll||this.createChild("-","list-group-item list-group-item-info sub",function(){return o.isFocus=!0,o.start(-1,!0),!1},function(){return o.isFocus=!1,o.stop(),t(o.input).focus(),!1}),this.canShowAll&&(this.showItem=this.max-this.min+1);var u=function(e){return o.isFocus=!0,!1},a=function(e){var n=t(e.target).text(),r=t(o.input).val(n);return o.input.readOnly||r.focus(),o.isFocus=!1,o.hide(),t(o.input).change(),s&&s(n),!1};for(var f=0;f<this.showItem;f++)this.createChild(" ","list-group-item",u,a);this.canShowAll||this.createChild("+","list-group-item list-group-item-info add",function(){return o.isFocus=!0,o.start(1,!0),!1},function(){return o.isFocus=!1,o.stop(),t(o.input).focus(),!1}),this.hide()},doHideEvent:function(e){var t=e.target||e.srcElement;this&&t.parentElement!=this.element&&this.hide()},show:function(){var e=this.input;this.current=parseInt(e.value||this.min),this.refresh();var n=t(e),r=t(this.element);r.css({top:-3e3,left:-3e3}).show();var i=n.offset(),s=i.top-r.outerHeight(!0),o=t(document).height()<i.top+n.outerHeight(!0)+r.outerHeight(!0)&&s>0;r.css({top:o?i.top-r.outerHeight(!0):i.top+n.outerHeight(!0),left:i.left}),this.bodyMDownFunc=this.doHideEvent.bind(this),t("body").on("mousedown touchstart",this.bodyMDownFunc)},hide:function(){t("body").off("mousedown touchstart",this.bodyMDownFunc),t(this.element).hide()},createChild:function(e,n,r,i){var s=t(this.element).append("<a href='#' class='"+n+"'/>").children().last().get(0);t(s).text(e),i?(t(s).bind("mousedown touchstart",r),t(s).bind("mouseup touchend",i)):t(s).bind("click",r)},refresh:function(){var e=t(this.element).children(),r,i,s;if(this.canShowAll){r=this.min;var o=function(e,t){this.element.scrollTop=e.outerHeight()*(t-3)};for(i=0;i<=this.max-this.min;i++){s=n.String.zeros(r++ +"",this.showCharSize),t(e.get(i)).text(s);if(r==this.current&&i>3){var u=t(e.get(i)),a=i;window.setTimeout(o.bind(this,u,a),10)}}}else{var f=parseInt(this.showItem/2),l=this.current;l>=this.max-f?l=this.max-f:l<=this.min+f&&(l=this.min+f),r=l-f-1;for(i=1;i<this.showItem+1;i++)s=n.String.zeros(r+i+"",this.showCharSize),t(e.get(i)).text(s)}},start:function(e){this.move=e,this.run()},stop:function(){this.move=0},run:function(){if(this.move>0&&this.current+3<this.max||this.move<0&&this.current-3>this.min)this.current+=this.move,this.refresh(),setTimeout(this.run.bind(this),60)}});return r}),define("$model/UI2/system/components/justep/numberSelect/numberSelect.config",["require"],function(e){return{properties:{min:"number",max:"number",showItemSize:"number",showCharSize:"number"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/numberSelect/numberSelect",["require","$UI/system/components/justep/common/res","$UI/system/lib/justep","./js/numberList","./numberSelect.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("$UI/system/lib/justep"),n=e("./js/numberList"),r=e.normalizeName("./numberSelect"),i=e("./numberSelect.config"),s=t.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.min=0,this.max=100,this.showItemSize=null,this.showCharSize=null,this.value="",this.callParent(e)},dispose:function(){this.list&&(this.list.dispose(),this.list=null),this.callParent()},val:function(e){if(arguments.length===0)return this.value;this.set({value:e})},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control x-numberSelect"),"<input class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+" component='"+r+"' "+" ></input>"},doInit:function(e,n){t.Browser.isMobile&&this.$domNode.prop("readonly",!0),this._bindEvent()},_bindEvent:function(){var e=this;this.$domNode.on("click",function(t){e.showList(),e.domNode.select()}).on("keypress",function(t){e.hideList();if(t.keyCode<48||t.keyCode>57)return!1}).on("paste",function(e){return!1}).on("change",function(t){e.doChange()})},showList:function(){this.getList().show()},hideList:function(){this.getList().hide()},getList:function(){return this.list||(this.list=new n(null,null,this.domNode,this.min,this.max,this.showCharSize,this.showItemSize)),this.list},render:function(){this.callParent(),this.$domNode.val(this.value)},doChange:function(e){var t=parseInt(this.$domNode.val());t<this.min&&(t=this.min),t>this.max&&(t=this.max),this.set({value:this.$domNode.val()})},propertyChangedHandler:function(e,t,n){switch(e){case"min":case"max":case"showItemSize":case"showCharSize":this.list&&this.list.setParam(this.min,this.max,this.showCharSize,this.showItemSize);break;case"value":t!=n&&this._inited&&(this.fireEvent("onChange",{source:this,originalValue:t,value:n}),this.val2ref()),this.needRender=this._inited;break;default:this.callParent(e,t,n)}}});return t.Component.register(r,s),s}),define("$model/UI2/system/components/justep/textarea/textarea.config",["require"],function(e){return{properties:{placeHolder:"string",disabled:"boolean"},events:["onChange"],binds:{"bind-ref":"ref"}}}),define("$model/UI2/system/components/justep/textarea/textarea",["require","$UI/system/components/justep/common/res","jquery","$UI/system/lib/justep","./textarea.config"],function(e){e("$UI/system/components/justep/common/res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./textarea"),i=e("./textarea.config"),s=n.BindComponent.extend({getConfig:function(){return i},constructor:function(e){this.callParent(e),this.placeHolder=""},dispose:function(){this.removeHandlers(),this.callParent()},buildTemplate:function(e){return e||(e={}),this.set(e),e["class"]||(e["class"]="form-control"),"<textarea class='"+e["class"]+"' "+(e.style?" style='"+e.style+"'":"")+(e.xid?" xid='"+e.xid+"'":"")+" component='"+r+"'"+" ></textarea>"},doInit:function(e,t){this.addHandlers()},set:function(e){this.callParent(e),e&&e.hasOwnProperty("value")&&this.val(e.value)},get:function(e){return"value"==e?this.val():this.callParent(e)},val:function(e){var t=this.$domNode.val();if(arguments.length===0)return t;var n=e;if(n===undefined||n===null)n="";if(n!=t){var r=this.$domNode;this._inited&&this.fireEvent("onChange",{source:this,value:e}),r.val(n),this.val2ref()}},addHandlers:function(){this.$domNode.on("change",t.proxy(this.doChange,this))},removeHandlers:function(){this.$domNode.off("change",t.proxy(this.doChange,this))},doChange:function(e){this.fireEvent("onChange",{source:this,value:this.$domNode.val()}),this.val2ref()},clear:function(){this.val(null)}});return n.Component.register(r,s),s}),define("$model/UI2/system/components/justep/titleBar/titleBar.config",["require"],function(e){return{properties:{title:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/titleBar/titleBar",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","$UI/system/lib/base/object","$UI/system/lib/justep","./titleBar.config","css!./css/titleBar"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e("$UI/system/lib/base/object"),s=e("$UI/system/lib/justep"),o=e.normalizeName("./titleBar"),u=e("./titleBar.config");e("css!./css/titleBar").load();var a=r.extend({getUrl:function(){return o},constructor:function(e){this.title="",this.callParent(e)},buildTemplate:function(e){return e.right.reverse=e.right.reverse===!0||e.right.reverse===undefined?!0:!1,n.format("<div class='x-titlebar' xid='{0}' componet='{1}'><div class='x-titlebar-left {2}'>{3}</div><div class='x-titlebar-title' style='display:{4}'>{5}</div><div class='x-titlebar-right {6}'>{7}</div></div>",e.xid,o,e.left.reverse?"reverse":"",e.left.body,e.title?"block":"none",e.title||"",e.right.reverse?"reverse":"",e.right.body)},getConfig:function(){return u},init:function(){this.callParent(),this.$left=$(">.x-titlebar-left",this.domNode),this.$right=$(">.x-titlebar-right",this.domNode),this.$title=$(">.x-titlebar-title",this.domNode),this.left=new f({owner:this,name:"left"}),this.right=new f({owner:this,name:"right"})},setTitle:function(e){e?$(">.x-titlebar-title",this.domNode).show():(e="",$(">.x-titlebar-title",this.domNode).hide()),$(">.x-titlebar-title",this.domNode).html(e)},setReverse:function(e,t){typeof t=="string"&&(t=t=="true"),t?$(">.x-titlebar-"+e,this.domNode).addClass("reverse"):$(">.x-titlebar-"+e,this.domNode).removeClass("reverse")},propertyChangedHandler:function(e,t,n){switch(e){case"title":this.setTitle(n);break;default:this.callParent(e,t,n)}}}),f=i.extend({constructor:function(e){s.Util.apply(this,e)},get:function(e){e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.name)},set:function(e,t){if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else e="set"+n.camelize(e),this.owner[e]&&this.owner[e](this.name,t)}});return t.register(o,a),a}),define("$model/UI2/system/components/justep/windowDialog/js/receiveMapping",["require"],function(e){var t=function(e){var t=e.confirmDelete;try{e.confirmDelete=!1,e.deleteAllData()}finally{e.confirmDelete=t}},n=function(e,t,n,i,s){var o=t.from,u=t.to;if(!o||o===""||!u||u==="")return;var a=r(n[i],o);"function"==typeof e.setValue?e.setValue(u,a,s):e[u]=a},r=function(e,t){if(!e)return;return"function"==typeof e.val?e.val(t):e[t]},i=function(e,t,n){var i=[],s=e.locfrom;for(var o=0,u=s.length;o<u;o++)i.push(r(n[t],s[o]));return i},s=function(e){var t=e.__mapping_def__;if(!t){var n=e.$domNode;t={mappings:[],locfrom:[],locto:[]},t.dataID=n.find("result").attr("concept"),t.operation=n.find("result").attr("operation"),n.find("mapping").each(function(){var e=$(this),n=e.attr("locator")==="true";n&&(t.locfrom.push(e.attr("from")),t.locto.push(e.attr("to")));var r={};r.from=e.attr("from"),r.to=e.attr("to"),t.mappings.push(r)}),e.__mapping_def__=t}return t},o={receiveByMapping:function(e,r){if(!e||!r)return;$.isArray(r)||(r=[r]);var o=s(e),u=e.getModel(),a,f,l,c=o.mappings;if(!o.dataID||o.dataID===""||!o.operation||o.operation==="")return;var h=u.comp(o.dataID);if(!h)return;var p=[];if(o.operation==="new"){for(a=0;a<r.length;a++){l={};for(f=0;f<c.length;f++)n(l,c[f],r,a);p.push(l)}p.length>0&&h.newData({defaultValues:p})}else if(o.operation=="edit"){for(a=0;a<r.length;a++){var d=h.find(o.locto,i(o,a,r),!1,!1,!1);if(d&&d.length>0)for(var v=0;v<d.length;v++)for(f=0;f<c.length;f++)n(h,c[f],r,a,d[v]);else{l={};for(f=0;f<c.length;f++)n(l,c[f],r,a);p.push(l)}}p.length>0&&h.newData({defaultValues:p})}else if(o.operation=="clear"){t(h);for(a=0;a<r.length;a++){l={};for(f=0;f<c.length;f++)n(l,c[f],r,a);p.push(l)}p.length>0&&h.newData({defaultValues:p})}else{if(o.operation!="modify")return;for(a=0;a<r.length;a++)for(f=0;f<c.length;f++)n(h,c[f],r,a)}}};return o}),define("$model/UI2/system/components/justep/windowDialog/windowDialog.config",["require"],function(e){return{properties:{src:"string",process:"string",activity:"string",showTitle:"boolean",forceRefreshOnOpen:"boolean",title:"string",status:"string",width:"string",height:"string",top:"string",left:"string",routable:"boolean",resizable:"boolean"},events:["onLoad","onOpen","onClose","onReceive","onLoadError"],binds:{}}}),define("$model/UI2/system/components/justep/windowDialog/windowDialog",["require","$UI/system/resources/system.res","jquery","$UI/system/lib/justep","../dialog/dialog","../windowContainer/windowContainer","$UI/system/lib/route/routeUtil","./js/receiveMapping","./windowDialog.config"],function(e){e("$UI/system/resources/system.res");var t=e("jquery"),n=e("$UI/system/lib/justep"),r=n.ModelBase,i=e("../dialog/dialog"),s=e("../windowContainer/windowContainer"),o=e("$UI/system/lib/route/routeUtil"),u=e("./js/receiveMapping"),a=e.normalizeName("./windowDialog"),f=e("./windowDialog.config"),l=i.extend({getConfig:function(){return f},constructor:function(e){this.src="",this.process="",this.activity="",this.forceRefreshOnOpen=!1,this._compose=null,this._composeOK=t.Deferred(),this.callParent(e)},dispose:function(){this.getModel().off(r.MESSAGE_EVENT,this.doReceiver,this),this.callParent()},doInit:function(e,t){this.callParent(e,t);var i=this.$domNode.attr("xid");i||(i=n.UUID.createUUID(),this.$domNode.attr("xid",i));var o={src:this.src,process:this.process,activity:this.activity};o.xid="_compose_"+i+"_",this._compose=new s(o),this._compose.on(s.BEFORE_LOAD_EVENT,function(){this._composeOK.resolve()},this),this._compose.on(s.LOAD_EVENT,function(){this._loaded=!0,this.fireEvent(s.LOAD_EVENT,{source:this}),this.initRouter()},this),this._compose.on(s.LOAD_ERROR_EVENT,function(e){var t={source:this,cancel:!1};this.fireEvent(s.LOAD_ERROR_EVENT,t);if(!t.cancel){var r=this,i=null;e.err&&e.err.toString().indexOf("JUSTEP230109")!=-1?i=(new n.Message(n.Message.JUSTEP230109)).getMessage():i=(new n.Message(n.Message.JUSTEP230111)).getMessage(),n.Util.confirm(i,function(){r.close()},function(){r.close()},"ok"),e.cancel=!0}},this),this.getModel().on(r.MESSAGE_EVENT,this.doReceive,this)},initRouter:function(){if(!this.routable)return;this._compose.off("onRouteStatePublish"),this._compose.on("onRouteStatePublish",function(e){this.addRouteInnerItem("",e.hashbang,e.isReplace)},this)},doRoute:function(e,t,n){if(!this.routable)return;if(e===""){var r,i,s=this;if(n=="enter")if(o.containeInnerState(t)){var u=o.getParamValue(t);i=o.getInnerStateValue(t);try{r=JSON.parse(u)}catch(a){}this.open(r),this._composeOK&&this._composeOK.done(function(){var e=s._compose.getInnerModel();e.postMessage({type:"routeState",newUrl:i})})}else{try{r=JSON.parse(t)}catch(a){}this.open(r)}else n=="leave"?this.close():n=="update"&&(i=o.getInnerStateValue(t),this._composeOK&&this._composeOK.done(function(){var e=s._compose.getInnerModel();e.postMessage({type:"routeState",newUrl:i})}))}},addRouteItem:function(e,t){if(!this.routable)return;var n=this.getModel().$routeState,r=this.$domNode.attr("xid");if(e=="open")try{n.addState(r,"",JSON.stringify(t)),n.publishState()}catch(i){}else e=="close"&&(n.removeState(r,"",""),n.publishState())},addRouteInnerItem:function(e,t,n){if(!this.routable)return;var r=this.getModel().$routeState,i=this.$domNode.attr("xid");this.opened&&(r.addInnerState(i,"",t),r.publishState())},propertyChangedHandler:function(e,t,n){switch(e){case"src":case"process":case"activity":t!=n&&this._inited&&this._refresh();break;default:this.callParent(e,t,n)}},doReceive:function(e){var t=e.message;t&&t.target==this&&(t.sender=t.source,t.source=this,delete t.target,this.fireEvent("onReceive",t),u.receiveByMapping(this,t.data))},render:function(){this.callParent()},_refresh:function(){this._compose&&(this._composeOK=t.Deferred(),this._compose.setSrc(this.src),this._compose.setProcess(this.process),this._compose.setActivity(this.activity),this._compose.refresh())},_setDialogParam:function(e){},_open:function(e){e&&this.set(e);if(!n.Bind.isBound(this._compose.domNode)){var t=this._getBodyNode()[0];this._compose.setCSS({height:"100%",position:"relative"}),n.Component.addComponent(t,this._compose)}else(this.forceRefreshOnOpen||!this._loaded)&&this._refresh();if(this._composeOK){var r=this;this._composeOK.done(function(){r._setDialogParam(e);var t=r._compose.getInnerModel();t.postMessage({source:r,type:"WindowDialog",data:e?e.data:undefined}),t.fireEvent("onResize",{source:r._compose})})}},open:function(e){if(this._viewLoaded)this.callParent(e);else{var t=this,n=arguments.callee,r=n.$owner.superclass,i=n.$name,o=r[i],u=arguments,a=function(){o.apply(t,u),t._viewLoaded=!0,t._compose.off(s.VIEW_LOAD_EVENT,a)};this._compose.on(s.VIEW_LOAD_EVENT,a)}this._open(e)}});return n.Component.addOperations(l,{open:{label:"",argsDef:[{name:"option",displayName:n.Message.getMessage(n.Message.JUSTEP231098)}],method:function(e){return this.owner.open(e.option)}},close:{label:"",method:function(e){return this.owner.close()}}}),n.Component.register(a,l),l}),define("$model/UI2/system/components/justep/windowReceiver/windowReceiver.config",["require"],function(e){return{properties:{},events:["onReceive"],binds:{}}}),define("$model/UI2/system/components/justep/windowReceiver/windowReceiver",["require","jquery","$UI/system/lib/justep","$UI/system/lib/base/url","./windowReceiver.config"],function(e){var t=e("jquery"),n=e("$UI/system/lib/justep"),r=n.ModelBase,i=e("$UI/system/lib/base/url"),s=e.normalizeName("./windowReceiver"),o=e("./windowReceiver.config"),u=n.BindComponent.extend({getConfig:function(){return o},constructor:function(e){this.callParent(e)},dispose:function(){this.getModel().off(r.MESSAGE_EVENT,this._doReceive,this),this.callParent()},buildTemplate:function(e){return e||(e={}),'<span component="'+s+'" '+(e.xid?' xid="'+e.xid+'" ':"")+">"+"</span>"},doInit:function(e,n){this.getModel().on(r.MESSAGE_EVENT,this._doReceive,this);var s=(new i(location.href)).getParam("$opener");if(s&&opener){this.winOpener=opener.justep.windowOpener_openers[s];var o=this;t(window).on("message",function(e){var t=JSON.parse(e.originalEvent.data);t.type=="WindowOpener"&&o.doReceive({message:t})}),t(window).unload(function(e){o.winOpener&&o.winOpener.dispatchCloseEvent&&o.winOpener.dispatchCloseEvent()}),this.winOpener&&this.winOpener.sendToWindow&&this.winOpener.sendToWindow()}},_doReceive:function(e){if(e.message){var r=e.message.type;t.inArray(r,["WindowDialog"])>-1&&(this._receiveData=e.message.data,this.target=e.message.source)}var i=this.getModel();n.ModelBase.MODEL_STATUS_LOAD>i.getStatus()?i.on(n.ModelBase.LOAD_EVENT,this.doReceive.bind(this,e)):this.doReceive(e)},getReceiveData:function(){return this._receiveData},doReceive:function(e){var n=e.message;n&&t.inArray(n.type,["WindowDialog"])>-1?(this.target=n.source,n.source=this,n.sender=this.target,this.fireEvent("onReceive",n)):n&&t.inArray(n.type,["WindowOpener"])>-1&&opener&&this.winOpener&&(n.source=this,n.sender=opener,this.fireEvent("onReceive",n))},sendData:function(e){this.target?this.target.getModel().postMessage({source:this,target:this.target,data:e}):opener&&this.winOpener&&this.winOpener.ensure(e,!0)},windowEnsure:function(e){this.target?(this.target.getModel().postMessage({source:this,target:this.target,data:e}),this.target.close()):opener&&this.winOpener&&this.winOpener.ensure(e)},windowCancel:function(){this.target?this.target.close():opener&&this.winOpener&&this.winOpener.cancel()}});return n.Component.addOperations(u,{windowCancel:{label:"",icon:"icon-chevron-left",method:function(e){return this.owner.windowCancel()}},windowEnsure:{label:"",argsDef:[{name:"data",displayName:"返回的数据"}],method:function(e){return this.owner.windowEnsure(e.data)}},sendData:{label:"",argsDef:[{name:"data",displayName:"返回的数据"}],method:function(e){return this.owner.sendData(e.data)}}}),n.Component.register(s,u),u}),define("$model/UI2/system/components/justep/menu/menu.config",["require"],function(e){return{properties:{},events:[],binds:{}}}),define("$model/UI2/system/components/justep/menu/menu",["require","$UI/system/components/justep/common/res","css!./css/menu","$UI/system/lib/base/component","$UI/system/lib/base/viewComponent","jquery","$UI/system/components/justep/button/button","./menu.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/menu").load();var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/viewComponent"),r=e("jquery"),i=e.normalizeName("./menu"),s=e("$UI/system/components/justep/button/button"),o=e("./menu.config"),u=n.extend({baseCls:"x-menu",constructor:function(e){this.callParent(e)},getConfig:function(){return o},buildTemplate:function(e){},init:function(e,t){this.callParent(e,t),this.$el=r(this.domNode)},addItem:function(e){e=e||{};var t=r('<li class="x-menu-item"></li>')[0];return justep.Component.addNode(this.domNode,t),justep.Util.apply(e,{parentNode:t,"class":"btn btn-link"}),new s(e)},addDivider:function(){r('<li class="x-menu-divider divider"></li>').appendTo(this.$el)}});return t.register(i,u),u}),define("$model/UI2/system/components/justep/popOver/popOver.config",["require"],function(e){return{properties:{position:"string",anchor:"string",direction:"string",opacity:"number",dismissible:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/popOver/popOver",["require","$UI/system/components/justep/common/res","css!./css/popOver","$UI/system/lib/base/component","$UI/system/lib/base/viewComponent","./popOver.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/popOver").load();var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/viewComponent"),r=e.normalizeName("./popOver"),i=e("./popOver.config"),s=n.extend({baseCls:"x-popOver",overlayCls:"x-popOver-overlay",contentCls:"x-popOver-content",constructor:function(){this.position="center",this.anchor=null,this.direction="right-bottom",this.opacity=.5,this.dismissible=!0,this.callParent()},getConfig:function(){return i},buildTemplate:function(e){return null},init:function(e,t){this.$el=$(this.domNode),this.$overlay=$(">."+this.overlayCls,this.$el),this.$content=$(">."+this.contentCls,this.$el),this.callParent(e,t);var n=this;this.$overlay.click(function(){if(n.dismissible)return n.hide(),!1}),$(window).resize(function(){n.$el.is(":visible")&&n.pos()})},show:function(){this.$el.show(),this.pos()},hide:function(){this.$el.hide()},pos:function(){this.$content.css({margin:"auto",left:"auto",right:"auto",top:"auto",bottom:"auto"});var e;try{e=this.getModel().comp(this.anchor).domNode}catch(t){e=this.anchor}e=$(e);if(e.length>0){var n=this.direction||"right-bottom",r=e.offset(),i=e.outerHeight(),s=e.outerWidth(),o=$(window).height(),u=$(window).width();switch(n){case"left-top":this.$content.css({bottom:o-r.top,left:r.left});break;case"left-bottom":this.$content.css({top:r.top+i,left:r.left});break;case"right-top":this.$content.css({bottom:o-r.top,right:u-r.left-s});break;case"right-bottom":this.$content.css({top:r.top+i,right:u-r.left-s})}return}var a=30;switch(this.position){case"center":this.$content.css({"margin-left":-this.$content.width()/2,"margin-top":-this.$content.height()/2,top:"50%",left:"50%",right:"auto",bottom:"auto"});break;case"bottom":this.$content.css({"margin-left":-this.$content.width()/2,top:"auto",left:"50%",right:"auto",bottom:a});break;case"left":this.$content.css({"margin-top":-this.$content.height()/2,"margin-left":0,top:"50%",left:a,right:"auto",bottom:"auto"});break;case"right":this.$content.css({"margin-top":-this.$content.height()/2,"margin-left":0,top:"50%",left:"auto",right:a,bottom:"auto"});break;default:this.$content.css({"margin-left":-this.$content.width()/2,top:a,left:"50%",right:"auto",bottom:"auto"})}},propertyChangedHandler:function(e,t,n){switch(e){case"opacity":n=parseFloat(n),isNaN(n)||n>=0&&n<=1&&(this.opacity=n,this.$overlay.css("opacity",n));break;case"dismissible":typeof n=="string"&&(n=n=="true"),this.dismissible=n;break;default:this.callParent(e,t,n)}}});return t.addOperations(s,{show:{label:"显示",icon:null,method:function(e){return this.owner.show()}},hide:{label:"隐藏",icon:null,method:function(e){return this.owner.hide()}}}),t.register(r,s),s}),define("$model/UI2/system/components/justep/popMenu/popMenu.config",["require"],function(e){return{properties:{position:"string",anchor:"string",direction:"string",opacity:"number",dismissible:"boolean",autoHidable:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/popMenu/popMenu",["require","$UI/system/components/justep/common/res","css!./css/popMenu","$UI/system/lib/base/component","../popOver/popOver","./popMenu.config"],function(e){e("$UI/system/components/justep/common/res"),e("css!./css/popMenu").load();var t=e("$UI/system/lib/base/component"),n=e("../popOver/popOver"),r=e.normalizeName("./popMenu"),i=e("./popMenu.config"),s=n.extend({baseCls:"x-popMenu",overlayCls:"x-popMenu-overlay",contentCls:"x-popMenu-content",autoHidable:!0,constructor:function(){this.callParent()},getConfig:function(){return i},buildTemplate:function(e){return null},init:function(e,t){this.callParent(e,t);var n=this;this.$content.click(function(){n.autoHidable&&n.hide()})},propertyChangedHandler:function(e,t,n){switch(e){default:}this.callParent(e,t,n)}});return t.register(r,s),s}),define("$model/UI2/system/components/justep/wing/child.config",["require"],function(e){return{properties:{width:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/wing/child",["require","$UI/system/lib/base/component","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","./child.config"],function(e){var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/base/string"),r=e("$UI/system/lib/base/viewComponent"),i=e.normalizeName("./child"),s=e("./child.config"),o=r.extend({constructor:function(e){this.callParent(e)},init:function(e,n){this.owner=t.getComponent(this.$domNode.parent().get(0)),this.name=this._getName(),this.owner[this.name]=this,this.callParent(e,n)},getConfig:function(){return s},_getName:function(){var e=this.$domNode.attr("class");if(e.indexOf("x-wing-left")!=-1)return"left";if(e.indexOf("x-wing-right")!=-1)return"right";if(e.indexOf("x-wing-content")!=-1)return"content"},get:function(e){e="get"+n.camelize(e);if(this.owner[e])return this.owner[e](this.name)},set:function(e,t){this[e]=t;if(typeof e=="object"){var r=e;for(var i in r)r.hasOwnProperty(i)&&this.set(i,r[i])}else e="set"+n.camelize(e),this.owner[e]&&this.owner[e](this.name,t)},onAfterSelect:function(){this.owner.show(this.name)},dispose:function(){this.owner.remove(this.name),this.owner=null}});return t.register(i,o),o}),define("$model/UI2/system/components/justep/wing/wing.config",["require"],function(e){return{properties:{routable:"boolean",animate:"boolean",display:"string",dismissible:"boolean",swipeClose:"boolean"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/wing/wing",["require","$UI/system/lib/jquery/transition","$UI/system/lib/base/component","$UI/system/lib/justep","$UI/system/lib/base/string","$UI/system/lib/base/viewComponent","jquery","./wing.config","$UI/system/components/justep/windowContainer/windowContainer","$UI/system/lib/jquery/transition","css!./css/wing"],function(e){e("$UI/system/lib/jquery/transition");var t=e("$UI/system/lib/base/component"),n=e("$UI/system/lib/justep"),r=e("$UI/system/lib/base/string"),i=e("$UI/system/lib/base/viewComponent"),s=e("jquery"),o=e.normalizeName("./wing"),u=e("./wing.config"),a=e("$UI/system/components/justep/windowContainer/windowContainer");e("$UI/system/lib/jquery/transition"),e("css!./css/wing").load();var f="300",l=i.extend({constructor:function(e){this.baseCls="x-wing",this.animate=!0,this.display="overlay",this.onlyOne=this.display!="overlay",this.dismissible=!1,this.swipeClose=!0,this.leftOpened=!1,this.rightOpened=!1,this.routable=!1,this.leftWidth=f,this.rightWidth=f,this.callParent(e)},getConfig:function(){return u},buildTemplate:function(e){e.content=e.content||{},e.left=e.left||{},e.left.size=e.left.size!==undefined?e.left.size:f,e.right=e.right||{},e.right.size=e.right.size!==undefined?e.right.size:f,e.routable&&(this.routable=e.routable),e.animate&&(this.animate=e.animate),e.display&&(this.display=e.display),e.dismissible&&(this.dismissible=e.dismissible),e.swipeClose&&(this.swipeClose=e.swipeClose);var t=e.style||"";return r.format("<div xid='{0}' class='{1}' component='{2}' style='{3}'><div class='x-wing-left' width='{4}'></div><div class='x-wing-content'></div><div class='x-wing-right' width='{5}'></div></div>",e.xid,this.baseCls,o,t,e.left.size,e.right.size)},init:function(e,t){this.callParent(e,t),this.$el=s(this.domNode),s(this.domNode).hasClass("x-wing-xs")&&(f="200",this.leftWidth=f,this.rightWidth=f),this.$left=s(">.x-wing-left",this.domNode),this.$content=s(">.x-wing-content",this.domNode),this.$right=s(">.x-wing-right",this.domNode);var r=this;return this.getModel().componentPromise(this.$content[0]).done(function(e){r.inited()}).fail(function(e){alert(e)}),this.animate&&(this.supportTouchSwip(),this.supportTouchSwipHide()),this.$backdrop=this.display!=="compress"&&!n.Browser.IE?s(">.x-wing-content>.x-wing-backdrop",this.domNode):s(">.x-wing-content>.x-wing-backdrop-none"),this.$backdrop.on("click",function(){if(r.leftOpened||r.rightOpened)r.hideRight(),r.hideLeft()}),{dependence:!0}},addRouteItem:function(e,t){if(!this.routable)return;var n=s(this.domNode).attr("xid"),r=this.getModel().$routeState;e==="show"?t=="content"?(r.removeState(n,"left",""),r.removeState(n,"right","")):r.addState(n,t,""):e==="hide"&&r.removeState(n,t)},publishRouteItem:function(){var e=this.getModel().$routeState;e.publishState()},doRoute:function(e,t,n){if(!this.routable)return;n=="enter"?e==="left"?this.showLeft():e==="right"&&this.showRight():n=="leave"&&(e==="left"?this.hideLeft():e==="right"&&this.hideRight())},supportTouchSwip:function(){var e=this.$content.width(),t=!1,n=!1,r=!1,i={},o,u,a,l,c,h=this,p,d=!1,v=s("html").hasClass("androidBrowser");this.$content.on("touchstart",function(e){if(t||h.rightOpened||h.leftOpened)return;e instanceof s.Event&&(e=e.originalEvent),r=!0,n=!1,t=!0,d=!1,o=undefined,i.x=e.type==="touchstart"?e.targetTouches[0].pageX:e.pageX,i.y=e.type==="touchstart"?e.targetTouches[0].pageY:e.pageY,a=(new Date).getTime(),/Android /.test(window.navigator.appVersion)&&!/Chrome\/\d/.test(window.navigator.appVersion)&&(h.$left.hide(),h.$right.hide(),h.$content.hide(),h.$left.css("display",""),h.$content.css("display",""),h.$right.css("display",""))}),this.$content.on("touchmove",function(u){u instanceof s.Event&&(u=u.originalEvent);if(u.target&&"INPUT"==u.target.tagName&&u.target.getAttribute("type")=="range")return;if(u.hasStopedPropagation===!0)return;if(!t||h.rightOpened||h.leftOpened||o)return;var a=u.type==="touchmove"?u.targetTouches[0].pageX:u.pageX,f=u.type==="touchmove"?u.targetTouches[0].pageY:u.pageY;l=Math.abs(a-i.x),c=Math.abs(f-i.y);if(r&&l>c){r=!1,n=!0,a-i.x>0?p="right":p="left",o=!1,p==="right"?d=i.x-h.$content.offset().left<e:p==="left"&&(d=h.$content.width()-i.x<e);if(!d){n=!1,o=!0;return}u.preventDefault(),u.hasStopedPropagation=!0}else if(r){r=!1,n=!1,o=!0;return}if(!d||!!o)return;u.preventDefault(),u.hasStopedPropagation=!0;var v=0;p==="right"?v=l/h.leftWidth:p==="left"&&(v=l/h.rightWidth);switch(h.display){case"overlay":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),l>h.leftWidth?h.$left.transform("translate3d(0,0,0)"):h.$left.transform("translate3d("+(h.leftWidth*-1+l)+"px,0,0)")):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),l>h.rightWidth?h.$right.transform("translate3d(0,0,0)"):h.$right.transform("translate3d("+(h.rightWidth-l)+"px,0,0)"));break;case"reveal":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),l>h.leftWidth?h.$content.transform("translate3d("+h.leftWidth+"px,0,0)"):h.$content.transform("translate3d("+l+"px,0,0)")):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),l>h.rightWidth?h.$content.transform("translate3d("+h.rightWidth*-1+"px,0,0)"):h.$content.transform("translate3d("+l*-1+"px,0,0)"));break;case"push":p=="right"&&h.$left.length>0?l>h.leftWidth?(h.$content.transform("translate3d("+h.leftWidth+"px,0,0)"),h.$left.transform("translate3d(0,0,0)")):(h.$content.transform("translate3d("+l+"px,0,0)"),h.$left.transform("translate3d("+(h.leftWidth*-1+l)+"px,0,0)")):p=="left"&&h.$right.length>0&&(l>h.rightWidth?(h.$content.transform("translate3d("+h.rightWidth*-1+"px,0,0)"),h.$right.transform("translate3d(0,0,0)")):(h.$content.transform("translate3d("+l*-1+"px,0,0)"),h.$right.transform("translate3d("+(h.rightWidth-l)+"px,0,0)")))}(p=="right"&&h.$left.length>0||p=="left"&&h.$right.length>0)&&h.$backdrop.show()}),this.$content.on("touchcancel touchend",function(e){if(!t||!n){d=!1,t=!1,n=!1;return}t=!1,n=!1;if(l===0){h.$left.removeClass("active"),h.$right.removeClass("active"),h.$content.transform(""),h.addRouteItem("show","content"),h.publishRouteItem();return}var r=(new Date).getTime()-a;if((r<300&&l>30||r>=300&&l>f/2)&&d){switch(h.display){case"overlay":p=="right"&&h.$left.length>0?(h.leftOpened=!0,h.addRouteItem("show","left"),h.publishRouteItem()):p=="left"&&h.$right.length>0&&(h.rightOpened=!0,h.addRouteItem("show","right"),h.publishRouteItem());break;case"reveal":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),h.$content.addClass("on-right"),h.leftOpened=!0,h.addRouteItem("show","left"),h.publishRouteItem()):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),h.$content.addClass("on-left"),h.rightOpened=!0,h.addRouteItem("show","right"),h.publishRouteItem());break;case"push":p=="right"&&h.$left.length>0?(h.$left.addClass("active"),h.$content.addClass("on-right"),h.leftOpened=!0,h.addRouteItem("show","left"),h.publishRouteItem()):p=="left"&&h.$right.length>0&&(h.$right.addClass("active"),h.$content.addClass("on-left"),h.rightOpened=!0,h.addRouteItem("show","right"),h.publishRouteItem())}h.$content.transitionEnd(function(){h.$content.transition(0),h.$left.transition(0),h.$right.transition(0)});var i=l/r,s=(f-l)/i;if(l<30||s<100&&l>30)s=200;h.$content.transition(s),h.$left.transition(s),h.$right.transition(s),h.$content.transform(""),h.$left.transform(""),h.$right.transform(""),(p=="right"&&h.$left.length>0||p=="left"&&h.$right.length>0)&&h.$backdrop.show()}else h.$backdrop.hide(),h.$left.removeClass("active"),h.$right.removeClass("active"),h.$content.transform(""),h.$left.transform(""),h.$right.transform(""),h.addRouteItem("show","content"),h.publishRouteItem()})},supportTouchSwipHide:function(){var e=this.$el.width(),t=!1,n=!1,r=!1,i={},o,u,a,l,c,h=this,p;this.$el.on("touchstart",function(e){if(t||!h.rightOpened&&!h.leftOpened)return;e instanceof s.Event&&(e=e.originalEvent),r=!0,n=!1,t=!0,o=undefined,i.x=e.type==="touchstart"?e.targetTouches[0].pageX:e.pageX,i.y=e.type==="touchstart"?e.targetTouches[0].pageY:e.pageY,a=(new Date).getTime()}),this.$el.on("touchmove",function(e){e instanceof s.Event&&(e=e.originalEvent);if(e.hasStopedPropagation===!0)return;if(!t||o||!h.rightOpened&&!h.leftOpened)return;var u=e.type==="touchmove"?e.targetTouches[0].pageX:e.pageX,a=e.type==="touchmove"?e.targetTouches[0].pageY:e.pageY;l=Math.abs(u-i.x),c=Math.abs(a-i.y);if(r&&l>c)r=!1,n=!0,u-i.x>0?p="right":p="left",o=!1,e.preventDefault(),e.hasStopedPropagation=!0;else if(r){r=!1,n=!1,o=!0;return}if(!!o)return;e.preventDefault(),e.hasStopedPropagation=!0;var f=0;p==="right"?f=l/h.leftWidth:p==="left"&&(f=l/h.rightWidth);switch(h.display){case"overlay":p=="right"&&h.rightOpened?l>h.rightWidth?h.$right.transform("translate3d("+h.rightWidth+"px,0,0)"):h.$right.transform("translate3d("+l+"px,0,0)"):p=="left"&&h.leftOpened&&(l>h.leftWidth?h.$left.transform("translate3d("+h.leftWidth*-1+"px,0,0)"):h.$left.transform("translate3d("+l*-1+"px,0,0)"));break;case"reveal":p=="right"&&h.rightOpened?l>h.rightWidth?h.$content.transform("translate3d(0,0,0)"):h.$content.transform("translate3d("+(h.rightWidth*-1+l)+"px,0,0)"):p=="left"&&h.$right.length>0&&(l>h.leftWidth?h.$content.transform("translate3d(0,0,0)"):h.$content.transform("translate3d("+(h.rightWidth-l)+"px,0,0)"));break;case"push":p=="right"&&h.rightOpened?l>h.rightWidth?(h.$content.transform("translate3d(0,0,0)"),h.$right.transform("translate3d("+h.rightWidth+"px,0,0)")):(h.$content.transform("translate3d("+(h.rightWidth*-1+l)+"px,0,0)"),h.$right.transform("translate3d("+l+"px,0,0)")):p=="left"&&h.leftOpened&&(l>h.leftWidth?(h.$content.transform("translate3d(0,0,0)"),h.$left.transform("translate3d("+h.leftWidth*-1+"px,0,0)")):(h.$content.transform("translate3d("+(h.leftWidth-l)+"px,0,0)"),h.$left.transform("translate3d("+l*-1+"px,0,0)")))}}),this.$el.on("touchcancel touchend",function(e){if(!t||!n){t=!1,n=!1;return}t=!1,n=!1;if(l===0)return;var r=(new Date).getTime()-a;r<300&&l>30||r>=300&&l>f/2?(p=="right"&&h.rightOpened?(h.$right.removeClass("active"),h.$content.removeClass("on-left"),h.rightOpened=!1,h.addRouteItem("show","right"),h.publishRouteItem()):p=="left"&&h.leftOpened&&(h.$left.removeClass("active"),h.$content.removeClass("on-right"),h.leftOpened=!1,h.addRouteItem("show","left"),h.publishRouteItem()),h.$backdrop.fadeOut(),h.$content.transform(""),h.$left.transform(""),h.$right.transform("")):(h.$content.transform(""),h.$left.transform(""),h.$right.transform(""))})},setSize:function(e,t){s(">.x-wing-"+e,this.$domNode).css("width",t)},getSize:function(e){return s(">.x-wing-"+e,this.$domNode).css("width")},showLeft:function(e){if(this.leftOpened)return;var t=s.support.transition&&!n.Browser.IE;if(this.onlyOne&&this.rightOpened)this.hideRight(this.showLeft);else switch(this.display){case"overlay":var r=this;this.$left.addClass("opening"),this.$backdrop.fadeIn();var i=function(){r.$left.addClass("active"),r.$left.removeClass("opening"),r.leftOpened=!0,r.addRouteItem("show","left"),r.publishRouteItem(),e&&e.call(r)};i();break;case"reveal":var r=this;this.$content.addClass("to-right"),this.$left.addClass("active"),this.$backdrop.fadeIn(),this.$content.animationEnd(function(){r.$content.addClass("on-right"),r.$content.removeClass("to-right"),r.leftOpened=!0,r.addRouteItem("show","left"),r.publishRouteItem(),e&&e.call(r)});break;case"push":var r=this;this.$left.addClass("opening"),this.$left.addClass("active"),this.$content.addClass("to-right"),this.$backdrop.fadeIn(),this.$left.animationEnd(function(){r.$content.addClass("on-right"),r.$content.removeClass("to-right"),r.$left.removeClass("opening"),r.leftOpened=!0,r.addRouteItem("show","left"),r.publishRouteItem(),e&&e.call(r)});break;case"compress":var r=this;this.$left.addClass("opening"),this.$left.addClass("active"),this.$content.addClass("compress-to-right"),this.$backdrop.fadeIn(),this.$left.animationEnd(function(){r.$content.addClass("compress-on-right"),r.$content.removeClass("compress-to-right"),r.$left.removeClass("opening"),r.leftOpened=!0,r.addRouteItem("show","left"),r.publishRouteItem(),e&&e.call(r)})}},hideLeft:function(e){if(!this.leftOpened){e&&e.call(this);return}var t=s.support.transition&&!n.Browser.IE;switch(this.display){case"overlay":var r=this;this.$left.addClass("closing"),this.$backdrop.fadeOut();var i=function(){r.$left.removeClass("closing"),r.$left.removeClass("active"),r._androidBugFix(),r.leftOpened=!1,r.addRouteItem("hide","left"),r.publishRouteItem(),e&&e.call(r)};t?this.$left.animationEnd(i):i();break;case"reveal":var r=this;this.$content.addClass("from-right-to-center"),this.$content.removeClass("on-right"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){r.$left.removeClass("active"),r.$content.removeClass("from-right-to-center"),r._androidBugFix(),r.leftOpened=!1,r.addRouteItem("hide","left"),r.publishRouteItem(),e&&e.call(r)});break;case"push":var r=this;this.$content.addClass("from-right-to-center"),this.$content.removeClass("on-right"),this.$left.addClass("closing"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){r.$left.removeClass("closing"),r.$left.removeClass("active"),r.$content.removeClass("from-right-to-center"),r._androidBugFix(),r.leftOpened=!1,r.addRouteItem("hide","left"),r.publishRouteItem(),e&&e.call(r)});break;case"compress":var r=this;this.$content.addClass("uncompress-from-left"),this.$content.removeClass("compress-on-right"),this.$left.addClass("closing"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){r.$left.removeClass("closing"),r.$left.removeClass("active"),r.$content.removeClass("uncompress-from-left"),r._androidBugFix(),r.leftOpened=!1,r.addRouteItem("hide","left"),r.publishRouteItem(),e&&e.call(r)})}},_androidBugFix:function(){/Android /.test(window.navigator.appVersion)&&(this.$el.get(0).style.overflow="auto",this.$el.offset(),this.$el.get(0).style.overflow="hidden")},toggleLeft:function(){this.leftOpened?this.hideLeft():this.showLeft()},showRight:function(e){if(this.rightOpened)return;var t=s.support.transition&&!n.Browser.IE;if(this.onlyOne&&this.leftOpened)this.hideLeft(this.showRight);else{var r=this;switch(this.display){case"overlay":var r=this;this.$right.addClass("opening"),this.$backdrop.fadeIn();var i=function(){r.$right.addClass("active"),r.$right.removeClass("opening"),r.rightOpened=!0,r.addRouteItem("show","right"),r.publishRouteItem(),e&&e.call(r)};t?this.$right.animationEnd(i):i();break;case"reveal":var r=this;this.$content.addClass("to-left"),this.$right.addClass("active"),this.$backdrop.fadeIn(),this.$content.animationEnd(function(){r.$content.removeClass("to-left"),r.$content.addClass("on-left"),r.rightOpened=!0,r.addRouteItem("show","right"),r.publishRouteItem(),e&&e.call(r)});break;case"push":var r=this;this.$right.addClass("opening"),this.$right.addClass("active"),this.$content.addClass("to-left"),this.$backdrop.fadeIn(),this.$right.animationEnd(function(){r.$content.removeClass("to-left"),r.$content.addClass("on-left"),r.$right.removeClass("opening"),r.rightOpened=!0,r.addRouteItem("show","right"),r.publishRouteItem(),e&&e.call(r)})}}},hideRight:function(e){if(!this.rightOpened){e&&e.call(this);return}var t=s.support.transition&&!n.Browser.IE,r=this;this.rightOpened=!1;switch(this.display){case"overlay":var r=this;this.$right.addClass("closing"),this.$backdrop.fadeOut();var i=function(){r.$right.removeClass("closing"),r.$right.removeClass("active"),r._androidBugFix(),r.addRouteItem("hide","right"),r.publishRouteItem(),e&&e.call(r)};t?this.$right.animationEnd(i):i();break;case"reveal":var r=this;this.$content.addClass("from-left-to-center"),this.$content.removeClass("on-left"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){r.$right.removeClass("active"),r.$content.removeClass("from-left-to-center"),r._androidBugFix(),r.addRouteItem("hide","right"),r.publishRouteItem(),e&&e.call(r)});break;case"push":var r=this;this.$right.addClass("closing"),this.$content.addClass("from-left-to-center"),this.$content.removeClass("on-left"),this.$backdrop.fadeOut(),this.$content.animationEnd(function(){r.$content.removeClass("from-left-to-center"),r.$right.removeClass("closing"),r.$right.removeClass("active"),r._androidBugFix(),r.addRouteItem("hide","right"),r.publishRouteItem(),e&&e.call(r)})}},toggleRight:function(){s(">.x-wing-right",this.$domNode).toggleClass("hide")},get:function(e){return this[e]},remove:function(e){s(".x-wing-"+e,this.$el).remove()},show:function(e){switch(e){case"content":this.leftOpened&&this.hideLeft(),this.rightOpened&&this.hideRight();break;case"left":this.leftOpened||this.showLeft();break;case"right":this.rightOpened||this.showRight()}},hide:function(e){switch(e){case"left":this.leftOpened&&this.hideLeft();break;case"right":this.rightOpened&&this.hideRight()}},setDisplay:function(e){this.display=e,s(this.domNode).attr("display",e),this.onlyOne=this.display!="overlay",this.display=="reveal"},setDismissible:function(e){return;var t},propertyChangedHandler:function(e,t,n){switch(e){case"display":this.setDisplay(n);break;case"dismissible":this.setDismissible(n);break;default:this.callParent(e,t,n)}},loadLeftContent:function(e){this.leftCompose=new a({parentNode:this.$left.get(0),src:e})},removeLeftContent:function(){n.Component.removeComponent(this.leftCompose)}});return n.Component.addOperations(l,{toggleLeft:{label:"",method:function(e){return this.owner.toggleLeft()}},toggleRight:{label:"",method:function(e){return this.owner.toggleRight()}}}),t.register(o,l),l}),define("$model/UI2/system/components/justep/barcode/barcodeImage",["require","$UI/system/lib/justep","$UI/system/lib/base/url","css!./css/barcodeImage"],function(e){var t=e("$UI/system/lib/justep"),n=e.normalizeName("$UI/system/components/justep/barcode/barcodeImage"),r=e("$UI/system/lib/base/url");e("css!./css/barcodeImage").load();var i=t.BindComponent.extend({constructor:function(e){this.callParent(e),this.value="",this.type="code93",this.barcodeConfig="{mw:0.6}",this.stretch=!0},buildTemplate:function(e){return e||(e={}),this.set(e),"string"==typeof e["bind-ref"]&&(e["bind-ref"]=e["bind-ref"].replace(/'/g,"&apos;")),e["class"]||(e["class"]="barcodeImage"),"<div class='"+e["class"]+"' "+(e.style?" style='"+e.style+"' ":"")+(e.xid?" xid='"+e.xid+"' ":"")+(e.type?" type='"+e.type+"' ":"")+(e.stretch?" stretch='"+e.stretch+"' ":"")+(e.barcodeConfig?" barcodeConfig='"+e.barcodeConfig+"' ":"")+(e["bind-ref"]?" __componentAttrs='ref:"+e["bind-ref"]+"'":"")+" component='"+n+"' "+" >"+"<img id='img"+e.xid+"' src='about:blank' style='vertical-align:middle;'/> "+"</div>"},onRefresh:function(){if(!this.value||this.value===""){this.clear();return}var t=this.$domNode.attr("type")?this.$domNode.attr("type"):"{}",n=this.$domNode.attr("barcodeConfig")?this.$domNode.attr("barcodeConfig"):"{}",i=new r(e.toUrl("$UI/system/components/justep/barcode/server/genBarcode.j"));i.setParam("type",t),i.setParam("code",this.value),i.setParam("config",n),this.setImgSrc(i.toString()),this.fireEvent("onRefresh",{source:this,url:i.toString()})},getContext:function(){return this.getModel().getContext()},setImgSrc:function(e){var t=this._getImgNode();this.stretch=this.$domNode.attr("stretch")=="false"?!1:this.stretch,this.stretch?(t.css({height:"100%",width:"100%"}),t.attr("src",e)):t.attr("src",e),t.show()},_getImgNode:function(){return this.$domNode.children("img")},clear:function(){this._getImgNode().attr("src","about:blank").hide()},propertyChangedHandler:function(e,t,n){this.callParent(e,t,n),this.needRender=!0},render:function(){this.callParent(),this.onRefresh()}});return t.Component.register(n,i),i}),define("$model/UI2/system/components/justep/uploader/uploader",[function(){return navigator.userAgent.indexOf("JustepApp")!=-1&&!1?"./uploader-ios":typeof FormData=="function"?"./uploader-html5":"./uploader-html4"}(),"require","res!./uploader-ios.js","res!./uploader-html5.js","res!./uploader-html4.js"],function(e,t){return t("res!./uploader-ios.js"),t("res!./uploader-html5.js"),t("res!./uploader-html4.js"),e}),define("$model/UI2/system/components/justep/uploader/uploader-html5",["require","$UI/system/lib/base/object","$UI/system/lib/base/observable","jquery"],function(e){var t=e("$UI/system/lib/base/object"),n=e("$UI/system/lib/base/observable"),r=e("jquery"),i=t.extend({mixins:n,constructor:function(e,t){var i={name:"userfile",data:{},multiple:!1,autoUpload:!0,states:!0,actionUrl:"",requestHeader:{},signRequestEnabled:!1,signHeader:"",defaultSuccessCodes:[200,201]},s=this;r.extend(this,r.extend(i,t)),s.callParent(),n.prototype.constructor.call(s),this.$rootElement=r(e),s.buildTarget(),s.buildLoadingElement(),this.inputElement.addEventListener("change",function(){s.onChanged.apply(s,arguments)}),s.enable=!0,s.changeState("browse")}});return i.prototype.setEnable=function(e){e==0?(this.enable=!1,r(this.formElement()).css("visibility","hidden")):e==1&&(this.enable=!0,r(this.formElement()).css("visibility","visible"))},i.prototype.addData=function(e){r.extend(this.data,e)},i.prototype.buildTarget=function(){this.$rootElement.css("position")!="absolute"&&this.$rootElement.css({position:"relative"});var e=this.multiple?'multiple="multiple"':"",t='<form style="position:absolute;top:-3px;right:-3px;bottom:-3px;left:-3px;"><input type="file" '+e+' name="userfile" tabindex="-1" style="cursor: pointer;opacity:0;position: relative;z-index:999;width:100%;height:100%;overflow:hidden;"></form>',n=r(t).appendTo(this.$rootElement),i=this;n.on("click",function(e){var t={cancel:!1,source:i};i.fireEvent("onFileSelect",t),t.cancel&&e.preventDefault()}),this.inputElement=n.find("input").get(0),this.formElement=n.get(0)},i.prototype.dispose=function(){this.$loadingElement&&this.$loadingElement.remove(),this.inputElement&&(r(this.formElement).remove(),r(this.inputElement).remove()),this.$rootElement&&this.$rootElement.off(".uploader")},i.prototype.buildLoadingElement=function(){var e='<span style="display:none"></span>';this.$loadingElement=r(e).appendTo(this.$rootElement)},i.prototype.submit=function(){var e=this;if(e.currentState=="ready"){var t=this.inputElement.files;r.each(t,function(t,n){n.data={};var r={source:e,file:n,cancel:!1};e.fireEvent("onStart",r);if(r.cancel===!0){e.changeState("browse");return}e.doUpload(r.file)})}},i.prototype.onChanged=function(e){var t=this;if(e.target.files.length>0){var n={file:e.target.files[0],cancel:!1};t.fireEvent("onFileSelected",n),n.cancel==1?t.changeState("browse"):t.changeState("ready")}else t.changeState("browse")},i.prototype.changeState=function(e){var t=this;t.currentState=e;switch(e){case"browse":t.$loadingElement.hide(),t.reset();break;case"ready":t.$loadingElement.hide(),t.autoUpload==1&&(r(t.inputElement).hide(),r(t.formElement).hide(),t.submit());break;case"loading":t.$loadingElement.show()}},i.prototype.parseResponse=function(e){if(e.responseXML)return e.responseXML;try{return JSON.parse(e.response)}catch(t){return e.response}},i.prototype.doUpload=function(e){var t=this;t.changeState("uploading");var n=new XMLHttpRequest;n.upload&&n.upload.addEventListener&&(n.upload.onprogress=function(e){if(e.lengthComputable){var n=e.loaded/e.total*100;t.fireEvent("onProgress",{percentComplete:n.toFixed(0)+"%"})}},n.onreadystatechange=function(n){if(this.readyState===4){if(Array.prototype.indexOf.call(t.defaultSuccessCodes,parseInt(this.status))!=-1){var r=t.parseResponse(this);t.fireEvent("onSuccess",{response:r,originalevent:n,data:e.data},t.fileName)}else t.fireEvent("onError",{status:this.status,originalevent:n,data:e.data});t.changeState("browse")}},n.upload.onerror=function(n){t.fireEvent("onError",{status:this.status,statusText:this.statusText,originalevent:n,data:e.data})}),n.open("POST",t.actionUrl),r.each(t.requestHeader,function(e,t){n.setRequestHeader(e,t)}),t.signRequestEnabled==1?t.signRequest(n,function(n){n.send(t.getForm(e))}):n.send(t.getForm(e))},i.prototype.getForm=function(e){var t=new FormData;return this.fileName=e.name,t.append(this.name,e),r.each(this.data,function(e,n){t.append(e,n)}),e.data&&r.each(e.data,function(e,n){t.append(e,n)}),t},i.prototype.reset=function(){var e=this;r(e.formElement).show(),r(e.inputElement).show(),e.formElement.reset()},i.prototype.signRequest=function(e,t){var n=this,r=n.getSignHeader();n.signProvider(function(n){e.setRequestHeader(r,n),t(e)},function(e){n.fireEvent("onSignProviderError",{msg:"Request signing is failed! "+e})})},i.prototype.signProvider=function(e,t){e("default-token")},i}),define("$model/UI2/system/components/justep/loadingBar/loadingBar",["require","jquery","$UI/system/lib/base/object","css!./loadingBar"],function(e){var t=e("jquery"),n=e("$UI/system/lib/base/object");e("css!./loadingBar").load();var r=n.extend({constructor:function(){var e=this;t("<div id='x-default-loadingbar' loadingnum = '0' class='waiting'><dt/><dd/></div>").appendTo("body"),t("<div id='x-default-overlay' class='x-default-overlay'></div>").appendTo("body"),this.$loadingBarNode=t("#x-default-loadingbar"),this.$loadingOverlayNode=t("#x-default-overlay"),this.$loadingOverlayNode.on("click",function(){setTimeout(function(){e.$loadingOverlayNode.removeClass("x-default-overlay-open")},100)}),t(document).ajaxStart(function(){e.start()}),t(document).ajaxStop(function(){e.stop()}),t(document).ajaxError(function(){e.stop()})},start:function(){var e=this,t=parseInt(e.$loadingBarNode.attr("loadingnum"));e.$loadingBarNode.attr("loadingnum",t+1),e.$loadingOverlayNode.addClass("x-default-overlay-open"),e.$loadingBarNode.fadeIn(200,function(){t===0&&e.$loadingBarNode.width(40+Math.random()*30+"%")})},stop:function(){var e=this;e.$loadingOverlayNode.removeClass("x-default-overlay-open"),setTimeout(function(){var t=parseInt(e.$loadingBarNode.attr("loadingnum"));e.$loadingBarNode.attr("loadingnum",t-1),t<=1&&e.$loadingBarNode.width("101%").fadeOut(1e3,function(){e.$loadingBarNode.width("1%")})},1e3)}});return new r}),define("$model/UI2/system/components/justep/printHtml/printHtml.config",["require"],function(e){return{properties:{target:"string"},events:[],binds:{}}}),define("$model/UI2/system/components/justep/printHtml/printHtml",["require","$UI/system/lib/route/router","$UI/system/lib/justep","./printHtml.config"],function(e){var t=e("$UI/system/lib/route/router"),n=e("$UI/system/lib/justep"),r=e.normalizeName("./printHtml"),i=e("./printHtml.config"),s=function(e){e.onmouseover&&(e.onmouseover=null),e.onmouseout&&(e.onmouseout=null),e.onclick&&(e.onclick=null)},o=function(e){var n="location=yes,statusbar=no,directories=no,menubar=no,resizable=yes,scrollbars=yes,titlebar=no,toolbar=no,dependent=no";e&&(e.width&&(n+=",width="+e.width),e.height&&(n+=",height="+e.height),e.screenX&&(n+=",screenX="+e.screenX),e.screenY&&(n+=",screenY="+e.screenY)),t.revertVls();var r=window.open("","_blank",n);return r.doc=r.document,r},u=function(e){$(e).find("div.x-richTextarea").each(function(){var e=$(this).css({height:"auto"});e.find("div.edui-toolbar").hide(),e.find("div.edui-body-container").css({height:"auto"})}),$(e).find("table").each(function(){s(this)}),$(e).find("div").each(function(){s(this)}),$(e).find("span").each(function(){s(this)}),$(e).find("div.x-grid").each(function(){a(this)})},a=function(e){$(e.parentNode).css({height:"auto"}),$("div.x-grid-bdiv",e).css({height:"auto"}).children("div").css({height:"auto"})},f=function(e,t){"string"==typeof t&&(t=[t]);var n="";$(e.getRootNode()).find("style").each(function(){n+=l(this)});for(var r=0;r<t.length;r++){var i=$(e.getElementByXid(t[r])),s=i.find("input");for(var o=0;o<s.length;o++){var a=s[o];a.value!==null&&a.value!==""&&a.setAttribute("value",a.value),(a.type=="radio"||a.type=="checkbox")&&a.checked&&a.setAttribute("checked","true")}var f=i.find("textarea");for(o=0;o<f.length;o++){var c=$(f[o]),h=c.val();h!==null&&h!==""&&c.html(h)}n+=$("<div></div>").append(i.clone()).html()}var p=document.createElement("div");return $(p).html(n),u(p),n=$(p).html(),$(p).empty().remove(),n},l=function(e){var t=$("<div></div>").append($(e).clone());return t.html()},c=function(e){var t="<head><title>"+e.popTitle+"</title>";return $(document).find("meta").each(function(){t+=l(this)}),$(document).find("link").filter(function(){return $(this).attr("rel").toLowerCase()=="stylesheet"}).each(function(){t+='<link type="text/css" rel="stylesheet" href="'+$(this).attr("href")+'" >'}),t+="</head>",t},h=function(){return $("html",document).attr("class")},p=function(e){return n.Browser.IE&&e?"<OBJECT id=wb height=0 width=0 classid='CLSID:8856F961-340A-11D0-A96B-00C04FD705A2' name=wb></OBJECT>":""},d=function(e,r,i,s){if(!r){n.System.showMessage((new n.Message(n.Message.JUSTEP231072,r)).getMessage());return}var u={closeWin:!0,popTitle:""},a={};$.extend(a,u,s);var l,d=new o(a);l=d.doc,l.open(),l.write("<!DOCTYPE html> <html class='"+h()+"'>"+c(a)+"<body "+(n.Browser.IE&&i?"onload='try{wb.execWB(7,1);}catch(e){alert(\"ActiveX未能正常加载\");}'":"")+">"+p(i)+f(e,r)+(a.appendHtml||"")+"</body>"+"</html>"),l.close(),window.setTimeout(function(){if(!n.Browser.IE||!i)d.focus(),d.print();a.closeWin&&window.setTimeout(function(){d.close()},1),t.ignoreVls()},500)},v=n.ViewComponent.extend({constructor:function(){this.callParent(),this.target=null},getConfig:function(){return i},buildTemplate:function(e){return null},init:function(e,t){this.callParent(e,t)},print:function(e,t){d(this.getModel(),e||this.target,!1,t)},preview:function(e,t){d(this.getModel(),e||this.target,!0,t)}});return n.Component.addOperations(v,{print:{label:n.Message.getMessage(n.Message.JUSTEP231103),icon:null,method:function(e){return this.owner.print()}},preview:{label:n.Message.getMessage(n.Message.JUSTEP231104),icon:null,method:function(e){return this.owner.preview()}}}),n.Component.register(r,v),v});