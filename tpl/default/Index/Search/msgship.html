<extend name="Public:base" />
<block name='title'>查询系统</block>
<block name='navhover3'>dropbtnhover</block>
<block name="center">
    <link rel="stylesheet" href="__INDEX_CSS__/search.css">
    <script src="__INDEX_JS__/jquery.raty.js"></script>
    <script src="__INDEX_JS__/echarts.js"></script>
    <div class="biaotis">
            船舶基本信息
    </div>
    <div class='divmsg_111' style="height: 460px">
		<div style="display: inline-block;margin-top: 110px;">
			<img src="{:($data['img'] == '') ? '__INDEX_IMAGE__/no_photo_big.png' : $data['img']}" class='img'>
			<div class="xuanfu" style="margin-top: 110px;">
				<img src="__INDEX_IMAGE__/erima.png" class='erweima'>
				<p class='pp'>扫描二维码，将船舶推荐给更多人!</p>
			</div>
		</div>
		<div class="ziliao">
			<p class='title' style="font-size: 29px;">{$data['shipname']}</p>
            <hr>
			<p class='title' style="font-size: 20px;">总体评价</p>
			<div style="height:400px;width:600px;">
<!--				<div style="">-->
<!--                    <span style="font-size: 17px;font-weight: bolder;float: left">合作评价：</span><div id="starts1" class="starts"></div>-->
<!--&lt;!&ndash;                    style="height: 300px;width: 300px"&ndash;&gt;-->
<!--	            </div>-->
<!--                <br/>-->
                <div style="height: 400px;width: 600px;">
                    <div style="height: 400px;width: 600px;" id="starts2"></div>
                </div>
			</div>
		</div>
    </div>
    <div class='dadiv'>
       <div class="xinx_3">
            <p class="pp1">类型</p>
            <p class="pp2">{$data['type']}</p>
        </div>
        <div class="xinx_3">
            <p class="pp1">吨位</p>
            <p class="pp2">{$data['weight']}</p>
        </div>
        <div class="xinx_3">
            <p class="pp1">舱数</p>
            <p class="pp2">{$data['cabinnum']}</p>
        </div>
        <div class="xinx_3">
            <p class="pp1">船舶识别号</p>
            <p class="pp2">{$data['shibie_num']}</p>
        </div>
        <div class="xinx_3">
            <p class="pp1">所有者</p>
            <p class="pp2"><a href="{:U('Search/chuanmsg',array('firmid'=>$data['firmid']))}" style="color: #0e83dc">{$data['firmname']}</a></p>
        </div>
        <div class="xinx_3">
            <p class="pp1">制造单位</p>
            <p class="pp2">{$data['make']}</p>
        </div>
        <div class="biaotis">
            历史汇总数据
        </div>
        <div class="xinx_3">
            <p class="pp1">总作业次数</p>
            <p class="pp2">{$data['num']}</p>
            <a href="{:U('Search/result',array('shipid'=>$data['id']))}" style="padding: 5px 10px;background-color: #80aae6;color: #ffffff;font-size: 14px;float: right;margin-right: 10px;border-radius: 5px;">查看历史作业</a>
        </div>
        <div class="xinx_3">
            <p class="pp1">总作业吨位</p>
            <p class="pp2">{$data['weights']}</p>
        </div>
        <div class="xinx_3">
            <p class="pp1">停泊码头数</p>
            <p class="pp2">{$data['mooring_num']}</p>
        </div>
    </div>

    <div id="container" style="height: 400px;">

    </div>
    <div style="height: 50px;"></div>
    <script>
    	// $("#starts1").raty({
    	// 	readOnly: true,
    	// 	number : 5,
    	// 	path : "__INDEX_IMAGE__",
    	// 	starOn : "star-on.png",
    	// 	starOff : "star-off.png",
    	// 	starHalf    : "star-half.png",
    	// 	precision: true,
    	// 	score:{:$data['grade']/$data['grade_num']},
    	// });

        // var dom3 = document.getElementById("starts1")
        // console.log(dom3);
        // var myChart3 = echarts.init(dom3);
        // console.log(myChart3);
        //
        // option3 = {
        //     title: {
        //         //show:false,
        //         x: "center",
        //         bottom: 50,
        //         //text:'AAA',
        //         subtext: '评价级别'
        //     },
        //     grid: [{
        //         show: false,
        //         backgroundColor: 'rgba(0,0,0,0)',
        //         borderWidth: 0,
        //         y: "bottom"
        //     }],
        //     series: [{
        //         type: "gauge",
        //         startAngle: 180,
        //         endAngle: 0,
        //         min: 0,
        //         max: 100,
        //         radius: "80%",
        //         //splitNumber: 3,
        //         center: ["50%", "65%"],
        //         axisLine: {
        //             show: true,
        //             lineStyle: {
        //                 width: 100,
        //                 shadowBlur: 10,
        //                 color: [
        //                     [0, 'transparent'],
        //                     [0.333333, '#0cb275'],
        //                     [0.343333, 'transparent'],
        //                     [0.666666, '#f09426'],
        //                     [0.676666, 'transparent'],
        //                     [1, '#e4101f']
        //                 ]
        //             }
        //         },
        //         axisTick: {
        //             show: false
        //         },
        //         axisLabel: {
        //             show: false
        //         },
        //         splitLine: {
        //             show: false
        //         },
        //         pointer: {
        //             width: "3%",
        //             length: '90%',
        //             color: "black"
        //         },
        //         itemStyle: {
        //             normal: {
        //                 color: "rgba(255, 255, 255, 0.8)",
        //                 shadowBlur: 20
        //             }
        //         },
        //         title: {
        //             show: false
        //         },
        //         detail: {
        //             show: false
        //         },
        //         data: [{
        //             value:{:$data['grade']/($data['grade_num']<1?1:$data['grade_num'])/5*100}
        // }]
        // }]
        // };
        // myChart3.on();

        // myChart3.setOption(option3, true);
        //
        // $("#starts2").raty({
        //     readOnly: true,
        //     number : 3,
        //     path : "__INDEX_IMAGE__",
        //     starOn : "star-on.png",
        //     starOff : "star-off.png",
        //     starHalf    : "star-half.png",
        //     precision: true,
        //     score:<?php echo $data['measure_standard']/($data['measure_num']<1?1:$data['measure_num']);?>,
        // });
        //
        // $("#starts3").raty({
        //     readOnly: true,
        //     number : 3,
        //     path : "__INDEX_IMAGE__",
        //     starOn : "star-on.png",
        //     starOff : "star-off.png",
        //     starHalf    : "star-half.png",
        //     precision: true,
        //     score:<?php echo $data['security']/($data['security_num']<1?1:$data['security_num']);?>,
        // });
        var dom1 = document.getElementById("starts2")
        console.log(dom1);
        var myChart1 = echarts.init(dom1);
        console.log(myChart1);

        option1 = {
            title: [{
                //show:false,
                x: "12%",
                bottom: 180,
                triggerEvent:true,
                //text:'AAA',
                text: '计量规范评价：{$data["measure_title"]}'
             },{
                //show:false,
                x: "55%",
                bottom: 180,
                triggerEvent:true,
                //text:'AAA',
                text: '安全规范评价：{$data["security_title"]}'
            },{
                //show:false,
                x: "12%",
                bottom: 0,
                triggerEvent:true,
                //text:'AAA',
                text: '基础评价：{$data["grade_title"]}'
            },{
                //show:false,
                x: "55%",
                bottom: 0,
                triggerEvent:true,
                //text:'AAA',
                text: '舱容反馈：{$data["accuracy_title"]}'
            }],
            grid: [{
                show: false,
                backgroundColor: 'rgba(0,0,0,0)',
                borderWidth: 0,
                y: "bottom"
            },{
                show: false,
                backgroundColor: 'rgba(0,0,0,0)',
                borderWidth: 0,
                y: "bottom"
            },{
                show: false,
                backgroundColor: 'rgba(0,0,0,0)',
                borderWidth: 0,
                y: "bottom"
            },{
                show: false,
                backgroundColor: 'rgba(0,0,0,0)',
                borderWidth: 0,
                y: "bottom"
            }],
            series: [{
                // x: "12%",
                type: "gauge",
                startAngle: 180,
                endAngle: 0,
                min: 0,
                max: 100,
                radius: "50%",
                //splitNumber: 3,
                center: ["29%", "45%"],
                axisLine: {
                    show: true,
                    lineStyle: {
                        width: 100,
                        shadowBlur: 10,
                        color: [
                            [0, 'transparent'],
                            [0.333333, '#e4101f'],
                            [0.343333, 'transparent'],
                            [0.666666, '#f09426'],
                            [0.676666, 'transparent'],
                            [1, '#0cb275']
                        ]
                    }
                },
                axisTick: {
                    show: false
                },
                axisLabel: {
                    show: false
                },
                splitLine: {
                    show: false
                },
                pointer: {
                    width: "3%",
                    length: '90%',
                    color: "black"
                },
                itemStyle: {
                    normal: {
                        color: "rgba(255, 255, 255, 0.8)",
                        shadowBlur: 20
                    }
                },
                title: {
                    show: false
                },
                detail: {
                    show:false
                },
                data: [{
                    value:{:$data['measure_standard']/($data['measure_num']<1?1:$data['measure_num'])/3*100}
                }]
            },
            {
            // x: "55%",
            type: "gauge",
                startAngle: 180,
            endAngle: 0,
            min: 0,
            max: 100,
            radius: "50%",
            //splitNumber: 3,
            center: ["72%", "45%"],
            axisLine: {
            show: true,
                lineStyle: {
                width: 100,
                    shadowBlur: 10,
                    color: [
                    [0, 'transparent'],
                    [0.333333, '#e4101f'],
                    [0.343333, 'transparent'],
                    [0.666666, '#f09426'],
                    [0.676666, 'transparent'],
                    [1, '#0cb275']
                ]
            }
        },
            axisTick: {
                show: false
            },
            axisLabel: {
                show: false
            },
            splitLine: {
                show: false
            },
            pointer: {
                width: "3%",
                    length: '90%',
                    color: "black"
            },
            itemStyle: {
                normal: {
                    color: "rgba(255, 255, 255, 0.8)",
                        shadowBlur: 20
                }
            },
            title: {
                show: false
            },
            detail: {
                show:false
            },
            data: [{
                value:{:$data['measure_standard']/($data['measure_num']<1?1:$data['measure_num'])/3*100}
        }]
        },{
            // x: "55%",
            type: "gauge",
                startAngle: 180,
                endAngle: 0,
                min: 0,
                max: 100,
                radius: "50%",
                //splitNumber: 3,
                center: ["29%", "90%"],
                axisLine: {
                show: true,
                    lineStyle: {
                    width: 100,
                        shadowBlur: 10,
                        color: [
                        [0, 'transparent'],
                        [0.2, '#e4101f'],
                        [0.21, 'transparent'],
                        [0.4, '#E98E2C'],
                        [0.41, 'transparent'],
                        [0.6, '#DDBD4D'],
                        [0.61, 'transparent'],
                        [0.8, '#0cb275'],
                        [0.81, 'transparent'],
                        [1, '#9CD6CE']
                    ]
                }
            },
            axisTick: {
                show: false
            },
            axisLabel: {
                show: false
            },
            splitLine: {
                show: false
            },
            pointer: {
                width: "3%",
                    length: '90%',
                    color: "black"
            },
            itemStyle: {
                normal: {
                    color: "rgba(255, 255, 255, 0.8)",
                        shadowBlur: 20
                }
            },
            title: {
                show: false
            },
            detail: {
                show:false
            },
            data: [{
                value:{:$data['grade']/($data['grade_num']<1?1:$data['grade_num'])/3*100}
        }]
        },
        {
            // x: "55%",
            type: "gauge",
                startAngle: 180,
            endAngle: 0,
            min: 0,
            max: 100,
            radius: "50%",
            //splitNumber: 3,
            center: ["72%", "90%"],
            axisLine: {
            show: true,
                lineStyle: {
                width: 100,
                    shadowBlur: 10,
                    color: [
                    [0, 'transparent'],
                    [0.5, '#e4101f'],
                    [0.51, 'transparent'],
                    [1, '#9CD6CE']
                ]
            }
        },
            axisTick: {
                show: false
            },
            axisLabel: {
                show: false
            },
            splitLine: {
                show: false
            },
            pointer: {
                width: "3%",
                    length: '90%',
                    color: "black"
            },
            itemStyle: {
                normal: {
                    color: "rgba(255, 255, 255, 0.8)",
                        shadowBlur: 20
                }
            },
            title: {
                show: false
            },
            detail: {
                show:false
            },
            data: [{
                value:{:$data['table_accuracy'] = $data['accuracy_sum'] / ($data['accuracy_num'] > 0 ? $data['accuracy_num'] : 1)/3*100}
        }]
        }
            ]
        };
        myChart1.on();

        myChart1.setOption(option1, true);

        myChart1.on('click', function (params) {
            layer.open({
                type: 2,
                title: '查看船舶评价',
                shadeClose: true,
                shade: false,
                maxmin: true, //开启最大化最小化按钮
                area: ['893px', '600px'],
                content: '{:U("Search/get_ship_evaluation",array("shipid"=>$data["id"]))}'
            });
        });


        // var dom2 = document.getElementById("starts3")
        // console.log(dom2);
        // var myChart2 = echarts.init(dom2);
        // console.log(myChart2);
        //
        // option2 = {
        //     title: {
        //         //show:false,
        //         x: "center",
        //         bottom: 50,
        //         //text:'AAA',
        //         text: '安全规范评价：{$data["security_title"]}'
        //     },
        //     grid: [{
        //         show: false,
        //         backgroundColor: 'rgba(0,0,0,0)',
        //         borderWidth: 0,
        //         y: "bottom"
        //     }],
        //     series: [{
        //         type: "gauge",
        //         startAngle: 180,
        //         endAngle: 0,
        //         min: 0,
        //         max: 100,
        //         radius: "80%",
        //         //splitNumber: 3,
        //         center: ["50%", "65%"],
        //         axisLine: {
        //             show: true,
        //             lineStyle: {
        //                 width: 100,
        //                 shadowBlur: 10,
        //                 color: [
        //                     [0, 'transparent'],
        //                     [0.333333, '#e4101f'],
        //                     [0.343333, 'transparent'],
        //                     [0.666666, '#f09426'],
        //                     [0.676666, 'transparent'],
        //                     [1, '#0cb275']
        //                 ]
        //             }
        //         },
        //         axisTick: {
        //             show: false
        //         },
        //         axisLabel: {
        //             show: false
        //         },
        //         splitLine: {
        //             show: false
        //         },
        //         pointer: {
        //             width: "3%",
        //             length: '90%',
        //             color: "black"
        //         },
        //         itemStyle: {
        //             normal: {
        //                 color: "rgba(255, 255, 255, 0.8)",
        //                 shadowBlur: 20
        //             }
        //         },
        //         title: {
        //             show: false
        //         },
        //         detail: {
        //             show:false
        //         },
        //         data: [{
        //             value: {:$data['security']/($data['security_num']<1?1:$data['security_num'])/3*100}
        //         }]
        //     }]
        // };
        // myChart2.on();
        //
        // myChart2.setOption(option2, true);



        var dom = document.getElementById("container");
        var myChart = echarts.init(dom);
        option = null;

        var xAxisData = [
        <?php
            $aaa = '';
            foreach ($voyage as $k=>$s)
            {
                $aaa .= "'".$s."',";
            }
            echo substr($aaa,0,-1);
            ?>
        ];
        var data1 = [<?php
            $aaa = '';
            foreach ($cha as $k=>$s)
            {
                $aaa .= "'".$s."',";
            }
            echo substr($aaa,0,-1);
            ?>];

        var itemStyle = {
            normal: {
            },
            emphasis: {
                barBorderWidth: 1,
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowOffsetY: 0,
                shadowColor: 'rgba(0,0,0,0.5)'
            }
        };

        option = {
            title : {
                text: '作业差量柱状图',
                subtext: '',
                x:'center',
                top:10,
            },
            backgroundColor: '#fff',
            legend: {
                data: ['bar'],
                align: 'left',
                left: 900,
                top:10,
            },
            tooltip: {},
            xAxis: {
                data: xAxisData,
                name: '',
                silent: false,
                axisLine: {onZero: true},
                splitLine: {show: false},
                splitArea: {show: false}
            },
            yAxis: {
                inverse: false,
                splitArea: {show: false}
            },
            grid: {
                left: 100
            },
            series: [
                {
                    name: 'bar',
                    type: 'bar',
                    stack: 'one',
                    itemStyle: itemStyle,
                    data: data1
                }
            ]
        };

        myChart.on();

        if (option && typeof option === "object") {
            myChart.setOption(option, true);
        }
    </script>
</block>